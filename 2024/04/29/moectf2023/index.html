

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="TMagWarO">
  <meta name="keywords" content="">
  
    <meta name="description" content="wp是去年写的，记录了当时做出来的题，打算把去年题复现一遍，先把去年的wp修修发出来，其他的题慢慢再更新把 Classical cryptoezrot密文： 1&gt;@64E7LC@Ecf0:D0;FDE020D:&gt;!&#x3D;60&#x3D;6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&amp;#125;%0N  Flag： 1moectf&amp;#123;rot47_is_just_a_">
<meta property="og:type" content="article">
<meta property="og:title" content="moectf2023">
<meta property="og:url" content="http://tmagwaro.github.io/2024/04/29/moectf2023/index.html">
<meta property="og:site_name" content="TMagWarO">
<meta property="og:description" content="wp是去年写的，记录了当时做出来的题，打算把去年题复现一遍，先把去年的wp修修发出来，其他的题慢慢再更新把 Classical cryptoezrot密文： 1&gt;@64E7LC@Ecf0:D0;FDE020D:&gt;!&#x3D;60&#x3D;6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&amp;#125;%0N  Flag： 1moectf&amp;#123;rot47_is_just_a_">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image002.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image004.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image006.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image008.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image010.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image012.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image014.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image016.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image018.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image020.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image022.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image024.jpg">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image026.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image028.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image030.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image032.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image034.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image036.png">
<meta property="article:published_time" content="2024-04-29T02:50:24.000Z">
<meta property="article:modified_time" content="2024-04-29T03:24:46.665Z">
<meta property="article:author" content="TMagWarO">
<meta property="article:tag" content="Crypto Misc">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://tmagwaro.github.io/2024/04/29/moectf2023/clip_image002.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>moectf2023 - TMagWarO</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"tmagwaro.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"9zKUxWzO3llfnXbD1wQfmb7M-gzGzoHsz","app_key":"rZfSX0UXAOdFxxfd3x5lGb6l","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>TMagWarO</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="moectf2023"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-04-29 10:50" pubdate>
          2024年4月29日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          22 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">moectf2023</h1>
            
            
              <div class="markdown-body">
                
                <p>wp是去年写的，记录了当时做出来的题，打算把去年题复现一遍，先把去年的wp修修发出来，其他的题慢慢再更新把</p>
<h1 id="Classical-crypto"><a href="#Classical-crypto" class="headerlink" title="Classical crypto"></a><strong>Classical crypto</strong></h1><h3 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a><strong>ezrot</strong></h3><p>密文：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&gt;<span class="hljs-variable">@64E</span>7LC<span class="hljs-variable">@Ecf0</span><span class="hljs-symbol">:D0</span>;<span class="hljs-variable constant_">FDE020D</span><span class="hljs-symbol">:&gt;</span>!=<span class="hljs-number">60</span>=6<span class="hljs-symbol">EE6C0DF3DE:</span><span class="hljs-variable constant_">EFE</span><span class="hljs-symbol">:</span>@<span class="hljs-string">?0</span>4<span class="hljs-symbol">:</span>!96C0tsAJdEA6d;F&#125;%0N<br></code></pre></td></tr></table></figure>

<p>Flag：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;rot47_is_just_<span class="hljs-built_in">a_simPle</span>_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;<br></code></pre></td></tr></table></figure>

<p>根据题目描述，应当是rot密码，出现@！等符号，所以是rot47，用cyberchef解得flag</p>
<img src="/2024/04/29/moectf2023/clip_image002.png" srcset="/img/loading.gif" lazyload class title="img">

<h3 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a><strong>可可的新围墙</strong></h3><p>密文：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>jocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBro_lcsOp&#125;e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure>

<p>Flag：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;F<span class="hljs-number">3</span><span class="hljs-symbol">nc3</span>_ciph<span class="hljs-number">3</span>r_shiFTs_<span class="hljs-number">3</span>ach_l<span class="hljs-number">3</span>TT<span class="hljs-number">3</span>r_By_a_Giv<span class="hljs-number">3</span><span class="hljs-symbol">n_nuMB3</span>r_oF_plac<span class="hljs-number">3</span>s_Ojpj&#125;<br></code></pre></td></tr></table></figure>

<p>​     根据密文特征（“{}”位置）猜测是栅栏密码，枚举未得到flag，再仔细观察，发现密文中m和e只出现过1次，即加密方式类似如下：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>j<br>ocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBro_lcsOp&#125;<br>e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">mt<span class="hljs-number">3</span>_hsTal<span class="hljs-number">3</span>yG<span class="hljs-symbol">nM_p3</span>jocfF<span class="hljs-symbol">n3</span>cp<span class="hljs-number">3</span>_hFs<span class="hljs-number">3</span>c_<span class="hljs-number">3</span>TrB__i<span class="hljs-number">3</span>_uBr<br>o_lcsOp&#125;<br>e&#123;ciri_hT_av<span class="hljs-symbol">n3</span>Fa_j<br></code></pre></td></tr></table></figure>

<p>猜测是w型栅栏，用脚本解得flag</p>
<img src="/2024/04/29/moectf2023/clip_image004.png" srcset="/img/loading.gif" lazyload class title="img">

<h3 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a><strong>皇帝的新密码</strong></h3><p>密文：</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">tvljam</span><span class="hljs-template-variable">&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></code></pre></td></tr></table></figure>

<p>Flag：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;CaEsaE_CIphEr_Is_<span class="hljs-built_in">a_vErY</span>_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;<br></code></pre></td></tr></table></figure>

<p>​     密文显示flag形式的字符串，且开头tvljam与moectf偏移量均为7，猜测是凯撒密码，解得</p>
<img src="/2024/04/29/moectf2023/clip_image006.png" srcset="/img/loading.gif" lazyload class title="img">

<h3 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a><strong>不是“皇帝的新密码”</strong></h3><p>密文：</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">scsfct</span><span class="hljs-template-variable">&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;</span><br></code></pre></td></tr></table></figure>

<p>md5 of flag (utf-8) </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">ea23f80270bdd96b5fcd213cae68eea5<br></code></pre></td></tr></table></figure>

<p>flag：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;vIgENErE_CIphEr_Is_<span class="hljs-built_in">a_lIttlE</span>_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz&#125;<br></code></pre></td></tr></table></figure>

<p>​     根据密文，开头字母与moectf偏移量并不呈规律变化，不是凯撒密码，根据古典密码的特征，最有可能的是Vigenere，但我们并不会知道密钥，用moectf做密钥解密得</p>
<img src="/2024/04/29/moectf2023/clip_image008.png" srcset="/img/loading.gif" lazyload class title="img">

<p>发现密钥为goodjo，解得</p>
<img src="/2024/04/29/moectf2023/clip_image010.png" srcset="/img/loading.gif" lazyload class title="img">

<p>提交flag并不正确，再仔细观察信息，发现提示flag的md5值，将刚刚得到的flag计算md5</p>
<img src="/2024/04/29/moectf2023/clip_image012.png" srcset="/img/loading.gif" lazyload class title="img">

<p>发现刚刚得到的并不是flag，说明密钥不对，仔细观察，密钥出现good单词，剩下的jo极有可能是job，因此猜测密钥是goodjob，再进行·解密</p>
<img src="/2024/04/29/moectf2023/clip_image014.png" srcset="/img/loading.gif" lazyload class title="img">

<p>并计算md5</p>
<img src="/2024/04/29/moectf2023/clip_image016.png" srcset="/img/loading.gif" lazyload class title="img">

<p>发现值与题所给md5相同，得到正确flag</p>
<p>猫言喵语:</p>
<p>密文;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">喵喵？ 喵喵喵喵喵喵喵喵喵喵喵喵 喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？ 喵喵喵喵喵？ 喵喵喵喵喵？喵喵？ 喵喵喵喵喵？ 喵喵喵喵喵喵 喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？喵喵喵 喵喵喵喵喵？ 喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？ 喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵？喵喵喵 喵喵喵喵喵？ 喵喵喵喵喵？喵喵喵喵喵喵 喵喵喵喵喵？喵喵喵喵喵喵 喵喵喵 喵喵？喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵？喵喵喵 喵喵？喵喵？喵喵？ 喵喵喵喵喵喵喵喵？ 喵喵？喵喵？喵喵喵喵喵喵 喵喵喵喵喵喵 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵？喵喵喵喵喵喵喵喵喵 喵喵？喵喵喵喵喵？喵喵？ 喵喵喵喵喵喵喵喵？喵喵？喵喵喵喵喵？ 喵喵喵喵喵？喵喵喵 喵喵？喵喵喵喵喵喵喵喵？<br></code></pre></td></tr></table></figure>

<p>Flag:</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;THE_KAWAII_CAT_BUT_BE_CALLED_GOUZI_BY_RX&#125;</span><br></code></pre></td></tr></table></figure>

<p>​     最开始猜测是兽语解密，但尝试了一番，并没有得到flag，同时注意到题目hint：morse code，告诉我们是摩斯密码，故将文本尝试转换成morse code，解得</p>
<img src="/2024/04/29/moectf2023/clip_image018.png" srcset="/img/loading.gif" lazyload class title="img">

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h1><h3 id="Crypto-入门指北"><a href="#Crypto-入门指北" class="headerlink" title="Crypto 入门指北"></a><strong>Crypto</strong> <strong>入门指北</strong></h3><p>​    运行脚本得flag</p>
<p>flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;weLCome_To_moeCTf_CRypTo_And_enjoy_THis_gAme!_THis_is_yoUR_fLAg!&#125;<br></code></pre></td></tr></table></figure>

<h3 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a><strong>baby_e</strong></h3><p>​     e很小，可以采用低加密指数攻击</p>
<img src="/2024/04/29/moectf2023/clip_image020.png" srcset="/img/loading.gif" lazyload class title="img">

<p>编写脚本得</p>
<p>Flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;SMaLL_3xPon3nt_Mak3_rSa_w3ak!_!lP0iYlJf!M3rux9G9Vf!JoxiMl903lllA&#125;<br></code></pre></td></tr></table></figure>

<h3 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a><strong>bad_E</strong></h3><p>非预期脚本：(当时初学Crypto，不知道从那个师傅哪里看到了nthroot_mod这个有限域开方函数，发现还挺好用，一路套脚本😀)</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> sympy.ntheory.residue_ntheory import nthroot_mod<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>e = 65537<br><span class="hljs-attribute">p</span>=6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571<br><span class="hljs-attribute">q</span>=11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819<br><span class="hljs-attribute">c</span>=63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-built_in">print</span>(long_to_bytes(nthroot_mod(c,e,p))<br></code></pre></td></tr></table></figure>

<p>预期解：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs routeros">e = 65537<br><span class="hljs-attribute">p</span>=6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571<br><span class="hljs-attribute">q</span>=11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819<br><span class="hljs-attribute">c</span>=63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><span class="hljs-built_in">print</span>(gcd(e,p-1))   #e|(p-1), gcd(e,q-1)=1<br><span class="hljs-attribute">d</span>=invert(e,(q-1))<br><span class="hljs-attribute">m</span>=powmod(c,d,q)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<p>Flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;N0w_Y0U_hAve_kN0w_h0w_rsA_w0rks!_f!lP0iYlJf!M3ru&#125;<br></code></pre></td></tr></table></figure>

<h3 id="xorrrrrrrrr"><a href="#xorrrrrrrrr" class="headerlink" title="xorrrrrrrrr"></a><strong>xorrrrrrrrr</strong></h3><p>​     先拿moectf{去和密文xor，根据密文翻译出来的明文猜测明文后面的单词，再与该段密文xor得到部分flag，重复操作，最终得到完整flag</p>
<p>Flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;W0W_y0U_HaVe_mastered_tHe_x0r_0Peart0r!_0iYlJf!M3rux9G9Vf!JoxiMl&#125;<br></code></pre></td></tr></table></figure>

<p><strong>factor_signin</strong></p>
<p>​    观察代码可知flag为rsa加密，前半部分的n1&#x3D;p * q，后半部分n2&#x3D;p1 * p2 * p3…p32,编写脚本得到两段flag，组合起来</p>
<p>脚本: </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">from</span> gmpy2 import *<br><br><br><span class="hljs-attribute">p</span>=<span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br><br><span class="hljs-attribute">q</span>=<span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br><br><span class="hljs-attribute">c1</span>=<span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-attribute">e</span>=<span class="hljs-number">65537</span><br><br><span class="hljs-attribute">d1</span>=invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-attribute">m1</span>=powmod(c1,d1,p*q)<br><span class="hljs-attribute">print</span>(long_to_bytes(m1))<br><span class="hljs-attribute">a</span>=[<span class="hljs-number">9949603102225364603</span>,<span class="hljs-number">10049235158029375571</span>,<span class="hljs-number">10547615587767500213</span>,<span class="hljs-number">10596280721192026229</span>,<span class="hljs-number">10864078180916418691</span>,<span class="hljs-number">11092420583960163379</span>,<span class="hljs-number">11853704782834170959</span>,<span class="hljs-number">12034779627328165471</span>,<span class="hljs-number">12404642343676224637</span>,<span class="hljs-number">12448177342966243757</span>,<span class="hljs-number">13062839684118954553</span>,<span class="hljs-number">13645878578452317313</span>,<span class="hljs-number">14397830993057803133</span>,<span class="hljs-number">14619040595108594017</span>,<span class="hljs-number">14678737767649343977</span>,<span class="hljs-number">14745811312384518031</span>,<span class="hljs-number">14813953870710226847</span>,<span class="hljs-number">15175734709842430433</span>,<span class="hljs-number">15211380502610462057</span>,<span class="hljs-number">15332916111580607077</span>,<span class="hljs-number">15751974537676958401</span>,<span class="hljs-number">16123604149048919099</span>,<span class="hljs-number">16408421615173973083</span>,<span class="hljs-number">16870346804576162551</span>,<span class="hljs-number">17093292308638969889</span>,<span class="hljs-number">17265001711647542137</span>,<span class="hljs-number">17289161209347211817</span>,<span class="hljs-number">17543713628803023199</span>,<span class="hljs-number">17673334943789572513</span>,<span class="hljs-number">18106525049998616747</span>,<span class="hljs-number">18345408081492711641</span>,<span class="hljs-number">18390046459144888243</span>]<br><span class="hljs-attribute">c2</span>=<span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br><span class="hljs-attribute">n2</span>=<span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><span class="hljs-attribute">phi</span>=<span class="hljs-number">1</span><br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">32</span>):<br>    <span class="hljs-attribute">phi</span> *= a[i]-<span class="hljs-number">1</span><br><span class="hljs-attribute">d2</span>=invert(e,phi)<br><span class="hljs-attribute">m2</span>=powmod(c2,d2,n2)<br><span class="hljs-attribute">print</span>(long_to_bytes(m2))<br></code></pre></td></tr></table></figure>

<p>flag： </p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;fACtord<span class="hljs-number">6</span>_A<span class="hljs-symbol">nd_YAfu_Are_6</span>oth_good_utils_to_fACtorize_<span class="hljs-symbol">num6</span>ers_ff<span class="hljs-number">90</span>S&#125;<br></code></pre></td></tr></table></figure>



<h3 id="feistel"><a href="#feistel" class="headerlink" title="feistel"></a><strong>feistel</strong></h3><p>​    将密文明文互换，再用加密脚本加密既可解密出flag</p>
<img src="/2024/04/29/moectf2023/clip_image022.png" srcset="/img/loading.gif" lazyload class title="img">



<h3 id="n-n"><a href="#n-n" class="headerlink" title="n&amp;n"></a><strong>n&amp;n</strong></h3><p>​    观察代码，得到e1，e2，c1，c2，n，故采用共模攻击</p>
<p>编写脚本得到flag</p>
<p>脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br>e1 = 0x114514<br>e2 = 19198101<br><span class="hljs-attribute">c1</span>=5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925<br>c2= 4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360<br><span class="hljs-attribute">n</span>=13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531<br><span class="hljs-attribute">s</span>=gcdext(e1,e2)<br><span class="hljs-attribute">s1</span>=s[1]<br><span class="hljs-attribute">s2</span>=s[2]<br><span class="hljs-attribute">m</span>=powmod(c1,s1,n)<br><span class="hljs-attribute">a</span>=powmod(c2,s2,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m<span class="hljs-number">*a</span>%n))<br></code></pre></td></tr></table></figure>

<p>flag:</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;dO_nOt_u53_5AM3_MOdulu5_tO_3ncrYPt_dIFF3r3nt_dAtA!_JY63x33iiA0Ji&#125;</span><br></code></pre></td></tr></table></figure>



<h3 id="p-q"><a href="#p-q" class="headerlink" title="|p-q|"></a><strong>|p-q|</strong></h3><p>N分解得到p，q，编写rsa解题脚本，得flag</p>
<p>flag：</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;it_iS_vUlnErablE_iF_p_iS_aboUt_thE_SaME_SiZE_aS_Q_MVoAYArrlG3uco&#125;</span><br></code></pre></td></tr></table></figure>



<h3 id="ez-chain"><a href="#ez-chain" class="headerlink" title="ez_chain"></a><strong>ez_chain</strong></h3><p>​    运用到辗转相除法、cbc加密，但是不知道key，通过构造相同位数的flag，发现flag内容怎么修改，最后的余数都不会变，猜测最后那一部分和moect{有关，修改查看，发现最后一个余数改变，确定猜测，该余数即为blocks[0]，同时已知密文、iv，异或求得key。</p>
<p>代码:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">a</span>=[<span class="hljs-number">8490961288</span>, <span class="hljs-number">122685644196</span>, <span class="hljs-number">349851982069</span>, <span class="hljs-number">319462619019</span>, <span class="hljs-number">74697733110</span>,<br>   <span class="hljs-attribute">43107579733</span>, <span class="hljs-number">465430019828</span>, <span class="hljs-number">178715374673</span>, <span class="hljs-number">425695308534</span>, <span class="hljs-number">164022852989</span>,<br>   <span class="hljs-attribute">435966065649</span>, <span class="hljs-number">222907886694</span>, <span class="hljs-number">420391941825</span>, <span class="hljs-number">173833246025</span>, <span class="hljs-number">329708930734</span>]<br><span class="hljs-attribute">iv</span> = <span class="hljs-number">3735927943</span><br><span class="hljs-attribute">base</span> = bytes_to_long(b<span class="hljs-string">&quot;koito&quot;</span>)<br><span class="hljs-attribute">key</span>=<span class="hljs-number">5329712293</span>^a[<span class="hljs-number">0</span>]^iv<br><span class="hljs-attribute">b</span>=[iv]<br><span class="hljs-attribute">for</span> i in range(len(a)-<span class="hljs-number">1</span>):<br>    <span class="hljs-attribute">b</span>.append(a[len(a)-<span class="hljs-number">2</span>-i]^a[len(a)-<span class="hljs-number">1</span>-i]^key)<br><span class="hljs-attribute">b</span>.append(a[<span class="hljs-number">0</span>]^b[<span class="hljs-number">0</span>]^key)<br><span class="hljs-attribute">a1</span>=list(reversed(b[<span class="hljs-number">1</span>:]))<br><span class="hljs-attribute">m</span>=a1[<span class="hljs-number">0</span>]<br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">1</span>,len(a1)):<br>    <span class="hljs-attribute">m</span> = base*m+a1[i]<br><span class="hljs-attribute">flag</span> = long_to_bytes(m)<br><span class="hljs-attribute">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h3 id="minipack"><a href="#minipack" class="headerlink" title="minipack"></a><strong>minipack</strong></h3><p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> key=[]<br> <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;E:\\key.txt&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> fs:<br>   key1 = fs.read().split(<span class="hljs-string">&quot;,&quot;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;[&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;]&#x27;</span>)<br> key1[<span class="hljs-number">0</span>]=key1[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]<br> key1[-<span class="hljs-number">1</span>]=key1[-<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>]<br> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key1:<br>   key.append(<span class="hljs-built_in">int</span>(i))<br> key = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">reversed</span>(key))<br> <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;E:\\ciphertext.txt&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> fs:<br>   cip = <span class="hljs-built_in">int</span>(fs.read())<br> m = <span class="hljs-string">&#x27;&#x27;</span><br> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>   <span class="hljs-keyword">if</span> cip - key[i] &gt;= <span class="hljs-number">0</span>:<br>     cip = cip - key[i]<br>     m += <span class="hljs-string">&#x27;1&#x27;</span><br>   <span class="hljs-keyword">else</span>:<br>     m += <span class="hljs-string">&#x27;0&#x27;</span><br> <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m[::-<span class="hljs-number">1</span>],<span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure>

<h3 id="giant-e"><a href="#giant-e" class="headerlink" title="giant_e"></a><strong>giant_e</strong></h3><p>​    rsa解题，e特别大，采用winerer攻击</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,numerator,denumerator</span>):<br>        self.numberlist = [] <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = [] <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList (numerator, denumerator)<br>        self.GenerateFractionList ()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span> (self, numerator, denumerator):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append (quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span> (self) :<br>        self.fractionlist.append ([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span> (self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (i) :<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i-j-<span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br><br>e = <span class="hljs-number">0x609778981bfbb26bb93398cb6d96984616a6ab08ade090c1c0d4fedb00f44f0552a1555efec5cc66e7960b61e94e80e7483b9f906a6c8155a91cdc3e4917fa5347c58a2bc85bb160fcf7fe98e3645cfea8458ea209e565e4eb72ee7cbb232331a862d8a84d91a0ff6d74aa3c779b2b129c3d8148b090c4193234764f2e5d9b2170a9b4859501d07c0601cdd18616a0ab2cf713a7c785fd06f27d68dff24446d884644e08f31bd37ecf48750e4324f959a8d37c5bef25e1580851646d57b3d4f525bc04c7ddafdf146539a84703df2161a0da7a368675f473065d2cb661907d990ba4a8451b15e054bfc4dd73e134f3bf7d8fa4716125d8e21f946d16b7b0fc43</span><br>n=<span class="hljs-number">0xbaa70ba4c29eb1e6bb3458827540fce84d40e1c966db73c0a39e4f9f40e975c42e02971dab385be27bd2b0687e2476894845cc46e55d9747a5be5ca9d925931ca82b0489e39724ea814800eb3c0ea40d89ebe7fe377f8d3f431a68d209e7a149851c06a4e67db7c99fcfd9ec19496f29d59bb186feb44a36fe344f11d047b9435a1c47fa2f8ed72f59403ebb0e439738fd550a7684247ab7da64311690f461e6dce03bf2fcd55345948a3b537087f07cd680d7461d326690bf21e39dff30268cb33f86eeceff412cd63a38f7110805d337dcad25e6f7e3728b53ca722b695b0d9db37361b5b63213af50dd69ee8b3cf2085f845d7932c08b27bf638e98497239</span><br>c=<span class="hljs-number">0x45a9ce4297c8afee693d3cce2525d3399c5251061ddd2462513a57f0fd69bdc74b71b519d3a2c23209d74fcfbcb6b196b5943838c2441cb34496c96e0f9fc9f0f80a2f6d5b49f220cb3e78e36a4a66595aa2dbe3ff6e814d84f07cb5442e2d5d08d08aa9ccde0294b39bfde79a6c6dcd2329e9820744c4deb34a039da7933ddf00b0a0469afb89cba87490a39783a9b2f8f0274f646ca242e78a326dda886c213bc8d03ac1a9150de4ba08c5936c3fe924c8646652ef85aa7ac0103485f472413427a0e9d9a4d416b99e24861ca8499500c693d7a07360158ffffa543480758cafff2a09a9f6628f92767764fa026d48a9dd899838505ae16e38910697f9de14</span><br>a = ContinuedFraction(e,n)<br><span class="hljs-keyword">for</span> k,d <span class="hljs-keyword">in</span> a.fractionlist:<br>    s = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(s.decode())<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure>

<p>flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;too_larGe_exponent_is_not_a_iDea_too!_Bung92WPIBung92WPIBung9?WP&#125;<br></code></pre></td></tr></table></figure>



<h3 id="rsa-signin"><a href="#rsa-signin" class="headerlink" title="rsa_signin"></a><strong>rsa_signin</strong></h3><p>​    出现多组c，n，可以考虑低加密指数广播攻击，但e&#x3D;65337，比较大，不使用中国剩余定理，考虑在n_list找最大公因数，编写脚本得flag</p>
<p>脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">65537</span><br>n1 =<br>…<br>n11 =<br>c1 =<br>…<br>c11 =<br>c = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]<br>n = [n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n)):<br>        <span class="hljs-keyword">if</span> (i != j):<br>            <span class="hljs-keyword">if</span> (gmpy2.gcd(n[i], n[j]) != <span class="hljs-number">1</span>):  <span class="hljs-comment"># 对不同的n进行 欧几里得算法，以求出最大公约数(p)</span><br>                <span class="hljs-built_in">print</span>(i, j)  <span class="hljs-comment"># 输出对应的n的序号</span><br>                p = gmpy2.gcd(n[i], n[j])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p = &quot;</span>, p)<br>                q = n[i] // p<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q = &quot;</span>, q)<br>                d = gmpy2.invert(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d = &quot;</span>, d)<br>                m = <span class="hljs-built_in">pow</span>(c[i], d, n[i])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m = &quot;</span>, m)<br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br></code></pre></td></tr></table></figure>

<p>flag:</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">moectf&#123;<span class="hljs-symbol">it_is_re@</span><span class="hljs-symbol">lly_@</span><span class="hljs-symbol">_signin_level_cryPto_ch@</span><span class="hljs-symbol">ll@</span>nge_ng92WPIBung92WPIBun&#125;<br></code></pre></td></tr></table></figure>



<h3 id="factorize-me"><a href="#factorize-me" class="headerlink" title="factorize_me!"></a><strong>factorize_me!</strong></h3><p>​    无法直接分解n，观察代码，发现n是由prime2累乘得到，而prime2可以由prime得到，而prime累乘数已经告知，尝试分解，得到al数组，编写脚本</p>
<p>脚本：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs routeros">al=[6811480804433459752827714558479851837166061762294131563310130325846430072816177165149613687307165209577130630311477665591141650399740741396784593477667511,<br>6991223361118904775931217829045348785013077549030883418924453538830605687999480005714979700653172534877541317997174968789510984315425270755055110913347281,<br>7592439908930473591169395506464664967460880934907692099467559610659035874008829133810341129161864445676397227262130671224157308868678442281617413952593477,<br>7661276973316857207751367277881032536449069939447322837508906694964933673171693624171780997296797446643574508184011878230465391879808258241752897792891323,<br>8752762682421281693932454897190422008900505775990831144558827755415243453970083322530846132571648469860763497724505255094464743633789884168771246977571539,<br>9987009117206906203158749743824168660291275882852229158070368815160479543708376165641735042845357978292384303332559592302507789120810447986634662721490507,<br>10022455487144667211701100343824680124338467215246658405697280466931561838565228778624923751405642974058833143888323468902504576610147119708725877528011439,<br>11627877395179828773706504422918933052041685770731872812302758181943244472706231518350716590168708806854971155512042158777017234038219076771501368374236727,<br>12876877424944854147075816504195994138450356002779004886384584287813869165469217718717854027672044903401715370348223932937626725119320180795716270261309139]<br><span class="hljs-attribute">n</span>=899081756851564072995842371038848265712822308942406479625157544735473115850983700580364485532298999127834142923262920189902691972009898741820291331257478170998867183390650298055916005944577877856728843264502218692432679062445730259562784479410120575777748292393321588239071577384218317338474855507210816917917699500763270490789679076190405915250953860114858086078092945282693720016414837231157788381144668395364877545151382171251673050910143023561541226464220441<br>e = 65537<br>c = 841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140<br><br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-keyword">from</span> Crypto.Util.number import getPrime<br><span class="hljs-keyword">from</span> math import prod<br><span class="hljs-keyword">from</span> sympy import nextprime<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(9):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(9):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(9):<br>            <span class="hljs-attribute">q</span>=nextprime(al[i])<br>            <span class="hljs-attribute">w</span>=nextprime(al[j])<br>            <span class="hljs-attribute">r</span>=nextprime(al[k])<br>            <span class="hljs-attribute">z</span>=q*w*r<br>            <span class="hljs-keyword">if</span>(<span class="hljs-attribute">n</span>==z):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r=&quot;</span>,r)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;w=&quot;</span>,w)<br>                phi=(q-1)*(w-1)*(r-1)<br>                <span class="hljs-attribute">d</span>=invert(e,phi)<br>                <span class="hljs-attribute">m</span>=powmod(c,d,n)<br>                <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<p>​       </p>
<p>flag：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;you_KNow_how_to_faCtorize_N_right?_9?WPIBung6?WPIBung6?WPIBund6?&#125;<br></code></pre></td></tr></table></figure>



<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h1><h3 id="Misc-入门指北"><a href="#Misc-入门指北" class="headerlink" title="Misc 入门指北"></a><strong>Misc</strong> <strong>入门指北</strong></h3><p>​    Base64解密</p>
<p>flag：moectf{h@v3_fun_@t_m15c_!}</p>
<h3 id="打不开的图片1"><a href="#打不开的图片1" class="headerlink" title="打不开的图片1"></a><strong>打不开的图片1</strong></h3><p>用010editor打开，发现是jpg格式文件，修复文件头，可以打开，有exif信息，16进制转换得flag</p>
<p>Flag：moectf{XDU_i5_v3ry_6e@u2ifu1}</p>
<h3 id="打不开的图片2"><a href="#打不开的图片2" class="headerlink" title="打不开的图片2"></a><strong>打不开的图片2</strong></h3><p>​    用010editor打开，发现ihdr，查看文件尾，为png文件尾，修复文件头，成功打开图片得到flag</p>
<img src="/2024/04/29/moectf2023/clip_image024.jpg" srcset="/img/loading.gif" lazyload class title="img">

<h3 id="狗子-1-普通的猫"><a href="#狗子-1-普通的猫" class="headerlink" title="狗子(1) 普通的猫"></a><strong>狗子(1) 普通的猫</strong></h3><p>​    用010editor打开,文件尾部找到flag</p>
<p>Flag: </p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;eeeez_f1ag_as_<span class="hljs-built_in">A_G1ft</span>!&#125;<br></code></pre></td></tr></table></figure>

<h3 id="building-near-lake"><a href="#building-near-lake" class="headerlink" title="building_near_lake"></a><strong>building_near_lake</strong></h3><p>​    下载图片可以查询到拍摄信息，照相机制造商为Xiaomi，型号为22122RK93C，搜素发现是红米k60，搜索发布会时间，得到20221227，百度识图发现拍摄地点是厦门大学翔安德望图书馆，地图查询经纬度，得到flag</p>
<img src="/2024/04/29/moectf2023/clip_image026.png" srcset="/img/loading.gif" lazyload class title="img">

<h3 id="烫烫烫"><a href="#烫烫烫" class="headerlink" title="烫烫烫"></a><strong>烫烫烫</strong></h3><p>​    转储utf-7，正常显示，</p>
<img src="/2024/04/29/moectf2023/clip_image028.png" srcset="/img/loading.gif" lazyload class title="img">

<p>计算key——b34edc782d68fda34dc2332967273b0f0900a0ebd0dcec48467851bc6117bad1，进行aes计算，得flag</p>
<p>Flag：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">moectf&#123;<span class="hljs-symbol">codep@</span><span class="hljs-symbol">ge_pl@</span><span class="hljs-symbol">ys_@</span><span class="hljs-symbol">n_iMport@</span><span class="hljs-symbol">nt_role_in_intern@</span><span class="hljs-symbol">tion@</span><span class="hljs-symbol">liz@</span>tion_g92WPIB&#125;<br></code></pre></td></tr></table></figure>

<h3 id="狗子-2-照片"><a href="#狗子-2-照片" class="headerlink" title="狗子(2) 照片"></a><strong>狗子(2) 照片</strong></h3><p>​    用zsteg跑lsb，得flag</p>
<p>Flag：moectf{D0ggy_H1dd3n_1n_Pho7o_With_LSB!}</p>
<h3 id="base乐队"><a href="#base乐队" class="headerlink" title="base乐队"></a><strong>base乐队</strong></h3><p>​    依次用base32、base58、base32解密得到</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">bYeNQXYZXbXZQfW31FGzzD0m0FHQ9RR85FFQYMB9M</span><span class="hljs-operator">=</span>lmo2ku11z0uiz<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure>

<p>发现中间有&#x3D;，目前已知出现&#x3D;均是在字符串尾部，猜测通过某种加密将&#x3D;放在了中间，尝试暴力栅栏，得到flag</p>
<p>flag：moectf{Th4_6@nd_1nc1ud45_F3nc4_@nd_b@s3}</p>
<h3 id="奇怪的压缩包"><a href="#奇怪的压缩包" class="headerlink" title="奇怪的压缩包"></a><strong>奇怪的压缩包</strong></h3><p>​    压缩包打开，发现有个文件夹为ppt，根据题目描述，改后缀，成功得到ppt文件，通过改字体颜色、遮挡、批注、解压ppt文档隐藏</p>
<p>Flag：moectf{2ip123456_?_ n0_i4_pp4x!}</p>
<h3 id="机位查询"><a href="#机位查询" class="headerlink" title="机位查询"></a><strong>机位查询</strong></h3><p>   三张图片的地点均在广西南宁，分别是南宁站、中山路美食街、华润大厦，查卫星地图可分析得到前两张图片拍摄地点为嘉士摩根国际、百盛步行街广场，最后一张始终分析不出拍摄的地点，仔细查看，发现有exif信息，有gps定位，查询，找到汇金宛，</p>
<img src="/2024/04/29/moectf2023/clip_image030.png" srcset="/img/loading.gif" lazyload class title="img">

<p>Flag：moectf{jiashi_baisheng_huijin}</p>
<h3 id="狗子-3-寝室"><a href="#狗子-3-寝室" class="headerlink" title="狗子(3) 寝室"></a><strong>狗子(3) 寝室</strong></h3><p>​     编写压缩包解压脚本或工具解压，得到flag.txt</p>
<p>Flag: moectf{Ca7_s133p1ng_und3r_zip_5hell5}</p>
<h3 id="尊嘟假嘟？"><a href="#尊嘟假嘟？" class="headerlink" title="尊嘟假嘟？"></a><strong>尊嘟假嘟？</strong></h3><p>​     根据hint1涉及到base58，尝试base58解密</p>
<img src="/2024/04/29/moectf2023/clip_image032.png" srcset="/img/loading.gif" lazyload class title="img">

<p>一堆乱码，而hint2提示为bl*****sh加密，想到blowfish，将key和iv求出，带入解密，得到一个可疑字符串</p>
<img src="/2024/04/29/moectf2023/clip_image034.png" srcset="/img/loading.gif" lazyload class title="img">

<p>再进行base64解密，得到flag</p>
<img src="/2024/04/29/moectf2023/clip_image036.png" srcset="/img/loading.gif" lazyload class title="img">


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF-WriteUp/" class="category-chain-item">CTF WriteUp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Crypto-Misc/" class="print-no-link">#Crypto Misc</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>moectf2023</div>
      <div>http://tmagwaro.github.io/2024/04/29/moectf2023/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>TMagWarO</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年4月29日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/04/08/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF%E5%8F%96%E8%AF%81wp/" title="第四届长安杯取证复现">
                        <span class="hidden-mobile">第四届长安杯取证复现</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
